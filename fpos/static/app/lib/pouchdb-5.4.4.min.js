!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(c,f,h){function j(l,e){if(!f[l]){if(!c[l]){var m="function"==typeof require&&require;if(!e&&m){return m(l,!0)}if(g){return g(l,!0)}var k=new Error("Cannot find module '"+l+"'");throw k.code="MODULE_NOT_FOUND",k}var i=f[l]={exports:{}};c[l][0].call(i.exports,function(n){var o=c[l][1][n];return j(o?o:n)},i,i.exports,a,c,f,h)}return f[l].exports}for(var g="function"==typeof require&&require,d=0;d<h.length;d++){j(h[d])}return j}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function g(e){return"number"==typeof e}function h(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!g(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,m,q,e,n,o;if(this._events||(this._events={}),"error"===p&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(m=this._events[p],c(m)){return !1}if(k(m)){switch(arguments.length){case 1:m.call(this);break;case 2:m.call(this,arguments[1]);break;case 3:m.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1),m.apply(this,e)}}else{if(h(m)){for(e=Array.prototype.slice.call(arguments,1),o=m.slice(),q=o.length,n=0;q>n;n++){o[n].apply(this,e)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?h(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,h(this._events[m])&&!this._events[m].warned&&(e=c(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(n,i){function e(){this.removeListener(n,e),m||(m=!0,i.apply(this,arguments))}if(!k(i)){throw TypeError("listener must be a function")}var m=!1;return e.listener=i,this.on(n,e),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(h(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(z,c,v){function A(){x&&m&&(x=!1,m.length?j=m.concat(j):q=-1,j.length&&p())}function p(){if(!x){var f=d(A);x=!0;for(var e=j.length;e;){for(m=j,j=[];++q<e;){m&&m[q].run()}q=-1,e=j.length}m=null,x=!1,k(f)}}function w(f,e){this.fun=f,this.array=e}function g(){}var d,k,y=c.exports={};!function(){try{d=setTimeout}catch(e){d=function(){throw new Error("setTimeout is not defined")}}try{k=clearTimeout}catch(e){k=function(){throw new Error("clearTimeout is not defined")}}}();var m,j=[],x=!1,q=-1;y.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}j.push(new w(f,e)),1!==j.length||x||d(p,0)},w.prototype.run=function(){this.fun.apply(null,this.array)},y.title="browser",y.browser=!0,y.env={},y.argv=[],y.version="",y.versions={},y.on=g,y.addListener=g,y.once=g,y.off=g,y.removeListener=g,y.removeAllListeners=g,y.emit=g,y.binding=function(e){throw new Error("process.binding is not supported")},y.cwd=function(){return"/"},y.chdir=function(e){throw new Error("process.chdir is not supported")},y.umask=function(){return 0}},{}],3:[function(c,f,d){(function(c1,aL){function eK(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function dy(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function eC(i){if("function"==typeof i.slice){return i.slice(0)}var g=new ArrayBuffer(i.byteLength),j=new Uint8Array(g),h=new Uint8Array(i);return j.set(h),g}function ch(i){if(i instanceof ArrayBuffer){return eC(i)}var h=i.size,g=i.type;return"function"==typeof i.slice?i.slice(0,h,g):i.webkitSlice(0,h,g)}function e0(i){var h=Object.getPrototypeOf(i);if(null===h){return !0}var g=h.constructor;return"function"==typeof g&&g instanceof g&&fC.call(g)==dO}function dC(k){var i,h,j;if(!k||"object"!=typeof k){return k}if(Array.isArray(k)){for(i=[],h=0,j=k.length;j>h;h++){i[h]=dC(k[h])}return i}if(k instanceof Date){return k.toISOString()}if(dy(k)){return ch(k)}if(!e0(k)){return k}i={};for(h in k){if(Object.prototype.hasOwnProperty.call(k,h)){var g=dC(k[h]);"undefined"!=typeof g&&(i[h]=g)}}return i}function eE(h){var g=!1;return by(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function eX(g){return by(function(j){j=dC(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){c1.nextTick(function(){i(n,m)})});var h=new cz(function(o,n){var q;try{var p=eE(function(r,s){r?n(r):o(s)});j.push(p),q=g.apply(l,j),q&&"function"==typeof q.then&&o(q)}catch(m){n(m)}});return k&&h.then(function(m){k(null,m)},k),h})}function fD(i,h){function g(k,o,m){if(aK.enabled){for(var j=[k._db_name,o],l=0;l<m.length-1;l++){j.push(m[l])}aK.apply(null,j);var n=m[m.length-1];m[m.length-1]=function(r,p){var q=[k._db_name,o];q=q.concat(r?["error",r]:["success",p]),aK.apply(null,q),n(r,p)}}}return eX(by(function(j){if(this._closed){return cz.reject(new Error("database is closed"))}if(this._destroyed){return cz.reject(new Error("database is destroyed"))}var k=this;return g(k,i,j),this.taskqueue.isReady?h.apply(this,j):new cz(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[i].apply(k,j))})})}))}function f5(l,j){for(var i={},k=0,h=j.length;h>k;k++){var g=j[k];g in l&&(i[g]=l[g])}return i}function dg(g){return g}function dY(g){return[{ok:g}]}function eB(g,k,u){function i(){var w=[];v.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),u(null,{results:w})}function m(){++l===p&&i()}function q(y,x,w){v[y]={id:x,docs:w},m()}function o(){if(!(r>=s.length)){var x=Math.min(r+cY,s.length),w=s.slice(r,x);h(w,r),r+=w.length}}function h(x,w){x.forEach(function(D,B){var z=w+B,A=j[D],C=f5(A[0],["atts_since","attachments"]);C.open_revs=A.map(function(E){return E.rev}),C.open_revs=C.open_revs.filter(dg);var y=dg;0===C.open_revs.length&&(delete C.open_revs,y=dY),["revs","attachments","binary","ajax"].forEach(function(E){E in k&&(C[E]=k[E])}),g.get(D,C,function(G,E){var F;F=G?[{error:G}]:y(E),q(z,D,F),o()})})}var n=k.docs,j={};n.forEach(function(w){w.id in j?j[w.id].push(w):j[w.id]=[w]});var p=Object.keys(j).length,l=0,v=new Array(p),s=Object.keys(j),r=0;o()}function ap(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function dd(){return fO}function ed(g){ap()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):dd()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function e4(){aZ.EventEmitter.call(this),this._listeners={},ed(this)}function bJ(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function f3(k,i){var h=600000;k=parseInt(k,10)||0,i=parseInt(i,10),i!==i||k>=i?i=(k||1)<<1:i+=1,i>h&&(k=h>>1,i=h);var j=Math.random(),g=i-k;return ~~(g*j+k)}function eO(h){var g=0;return h||(g=2000),f3(h,g)}function bS(h,g){bJ("info","The above "+h+" is totally normal. "+g)}function d2(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function av(i,g,j){function h(k){for(var l in i){"function"!=typeof i[l]&&(this[l]=i[l])}void 0!==j&&(this.name=j),void 0!==k&&(this.reason=k)}return h.prototype=d2.prototype,new h(g)}function dX(l){var j,i,k,h,g;return i=l.error===!0&&"string"==typeof l.name?l.name:l.error,g=l.reason,k=dV("name",i,g),l.missing||"missing"===g||"deleted"===g||"not_found"===i?k=bb:"doc_validation"===i?(k=eZ,h=g):"bad_request"===i&&k.message!==g&&(k=eP),k||(k=dV("status",l.status,g)||eW),j=av(k,g,i),h&&(j.message=h),l.id&&(j.id=l.id),l.status&&(j.status=l.status),l.missing&&(j.missing=l.missing),j}function bH(k,i,h){try{return !k(i,h)}catch(j){var g="Filter function threw: "+j.toString();return av(eP,g)}}function aD(i){var h={},g=i.filter&&"function"==typeof i.filter;return h.query=i.query_params,function(k){k.doc||(k.doc={});var l=g&&bH(i.filter,k.doc,h);if("object"==typeof l){return l}if(l){return !1}if(i.include_docs){if(!i.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function eh(i){for(var g=[],j=0,h=i.length;h>j;j++){g=g.concat(i[j])}return g}function cU(h){var g;if(h?"string"!=typeof h?g=av(cL):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=av(dw)):g=av(eH),g){throw g}}function d8(h,g){return"listenerCount" in h?h.listenerCount(g):aZ.EventEmitter.listenerCount(h,g)}function aU(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function e3(h){var g=aU(h);return g?g.join("/"):null}function bc(i){for(var l=fI.exec(i),g={},m=14;m--;){var j=kd[m],k=l[m]||"",h=-1!==["user","password"].indexOf(j);g[j]=h?decodeURIComponent(k):k}return g[d1]={},g[kd[12]].replace(f7,function(p,n,o){n&&(g[d1][n]=o)}),g}function j8(i,h,g){return new cz(function(j,k){i.get(h,function(n,l){if(n){if(404!==n.status){return k(n)}l={}}var o=l._rev,m=g(l);return m?(m._id=h,m._rev=o,void j(cP(i,m,g))):j({updated:!1,rev:o})})})}function cP(i,h,g){return i.put(h).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return j8(i,h._id,g)})}function ds(g){return 0|Math.random()*g}function eM(i,g){g=g||df.length;var j="",h=-1;if(i){for(;++h<i;){j+=df[ds(g)]}return j}for(;++h<36;){switch(h){case 8:case 13:case 18:case 23:j+="-";break;case 19:j+=df[3&ds(16)|8];break;default:j+=df[ds(16)]}}return j}function dH(r){for(var s,i,g,h,k=r.rev_tree.slice();h=k.pop();){var p=h.ids,l=p[2],q=h.pos;if(l.length){for(var o=0,m=l.length;m>o;o++){k.push({pos:q+1,ids:l[o]})}}else{var j=!!p[1].deleted,n=p[0];s&&!(g!==j?g:i!==q?q>i:n>s)||(s=n,i=q,g=j)}}return i+"-"+s}function fM(i,k){for(var g,m=i.slice();g=m.pop();){for(var o=g.pos,h=g.ids,j=h[2],l=k(0===j.length,o,h[0],g.ctx,h[1]),p=0,n=j.length;n>p;p++){m.push({pos:o+1,ids:j[p],ctx:l})}}}function bP(h,g){return h.pos-g.pos}function jY(i){var g=[];fM(i,function(o,l,n,k,m){o&&g.push({rev:l+"-"+n,pos:l,opts:m})}),g.sort(bP).reverse();for(var j=0,h=g.length;h>j;j++){delete g[j].pos}return g}function dZ(i){for(var l=dH(i),g=jY(i.rev_tree),m=[],j=0,k=g.length;k>j;j++){var h=g[j];h.rev===l||h.opts.deleted||m.push(h.rev)}return m}function cd(h){var g=[];return fM(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function d3(r){for(var s,i=[],g=r.slice();s=g.pop();){var h=s.pos,k=s.ids,p=k[0],l=k[1],q=k[2],o=0===q.length,m=s.history?s.history.slice():[];m.push({id:p,opts:l}),o&&i.push({pos:h+1-m.length,ids:m});for(var j=0,n=q.length;n>j;j++){g.push({pos:h+1,ids:q[j],history:m})}}return i.reverse()}function dh(h,g){return h.pos-g.pos}function af(l,j,i){for(var k,h=0,g=l.length;g>h;){k=h+g>>>1,i(l[k],j)<0?h=k+1:g=k}return h}function fB(i,g,j){var h=af(i,g,j);i.splice(h,0,g)}function bi(g,h){for(var m,i,k=h,l=g.length;l>k;k++){var j=g[k],n=[j.id,j.opts,[]];i?(i[2].push(n),i=n):m=i=n}return m}function ek(h,g){return h[0]<g[0]?-1:1}function eY(i,k){for(var g=[{tree1:i,tree2:k}],m=!1;g.length>0;){var o=g.pop(),h=o.tree1,j=o.tree2;(h[1].status||j[1].status)&&(h[1].status="available"===h[1].status||"available"===j[1].status?"available":"missing");for(var l=0;l<j[2].length;l++){if(h[2][0]){for(var p=!1,n=0;n<h[2].length;n++){h[2][n][0]===j[2][l][0]&&(g.push({tree1:h[2][n],tree2:j[2][l]}),p=!0)}p||(m="new_branch",fB(h[2],j[2][l],ek))}else{m="new_leaf",h[2][0]=j[2][l]}}}return{conflicts:m,tree:i}}function bK(x,u,v){var q,k=[],m=!1,r=!1;if(!x.length){return{tree:[u],conflicts:"new_leaf"}}for(var w=0,j=x.length;j>w;w++){var s=x[w];if(s.pos===u.pos&&s.ids[0]===u.ids[0]){q=eY(s.ids,u.ids),k.push({pos:s.pos,ids:q.tree}),m=m||q.conflicts,r=!0}else{if(v!==!0){var p=s.pos<u.pos?s:u,z=s.pos<u.pos?u:s,o=z.pos-p.pos,n=[],i=[];for(i.push({ids:p.ids,diff:o,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],A=0,y=g.length;y>A;A++){i.push({ids:g[A],diff:h.diff-1,parent:h.ids,parentIdx:A})}}else{h.ids[0]===z.ids[0]&&n.push(h)}}var l=n[0];l?(q=eY(l.ids,z.ids),l.parent[2][l.parentIdx]=q.tree,k.push({pos:p.pos,ids:p.ids}),m=m||q.conflicts,r=!0):k.push(s)}else{k.push(s)}}}return r||k.push(u),k.sort(dh),{tree:k,conflicts:m||"internal_node"}}function aA(r,s){for(var i,g=d3(r),h={},k=0,p=g.length;p>k;k++){for(var l=g[k],q=l.ids,o=Math.max(0,q.length-s),m={pos:l.pos+o,ids:bi(q,o)},j=0;o>j;j++){var n=l.pos+j+"-"+q[j].id;h[n]=!0}i=i?bK(i,m,!0).tree:[m]}return fM(i,function(u,w,v){delete h[w+"-"+v]}),{tree:i,revs:Object.keys(h)}}function a8(k,i,h){var j=bK(k,i),g=aA(j.tree,h);return{tree:g.tree,stemmedRevs:g.revs,conflicts:j.conflicts}}function aT(i,k){for(var g,m=i.slice(),o=k.split("-"),h=parseInt(o[0],10),j=o[1];g=m.pop();){if(g.pos===h&&g.ids[0]===j){return !0}for(var l=g.ids[2],p=0,n=l.length;n>p;p++){m.push({pos:g.pos+1,ids:l[p]})}}return !1}function e5(g){return g.ids}function aP(k,i){i||(i=dH(k));for(var h,j=i.substring(i.indexOf("-")+1),g=k.rev_tree.map(e5);h=g.pop();){if(h[0]===j){return !!h[1].deleted}g=g.concat(h[2])}}function du(g){return/^_local/.test(g)}function c4(g){return aC("return "+g+";",{})}function bI(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function aI(i,h){try{i.emit("change",h)}catch(g){bJ("error",'Error in .on("change", function):',g)}}function fH(i,l,g){function m(){j.cancel()}aZ.EventEmitter.call(this);var j=this;this.db=i,l=l?dC(l):{};var k=l.complete=eE(function(o,n){o?d8(j,"error")>0&&j.emit("error",o):j.emit("complete",n),j.removeAllListeners(),i.removeListener("destroyed",m)});g&&(j.on("complete",function(n){g(null,n)}),j.on("error",g)),i.once("destroyed",m),l.onChange=function(n){l.isCancelled||(aI(j,n),j.startSeq&&j.startSeq<=n.seq&&(j.startSeq=!1))};var h=new cz(function(o,n){l.complete=function(p,q){p?n(p):o(q)}});j.once("cancel",function(){i.removeListener("destroyed",m),l.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){k(null,n)},k),i.taskqueue.isReady?j.doChanges(l):i.taskqueue.addTask(function(){j.isCancelled?j.emit("cancel"):j.doChanges(l)})}function bC(k,i,h){var j=[{rev:k._rev}];"all_docs"===h.style&&(j=jY(i.rev_tree).map(function(l){return{rev:l.rev}}));var g={id:i.id,changes:j,doc:k};return aP(i,k._rev)&&(g.deleted=!0),h.conflicts&&(g.doc._conflicts=dZ(i),g.doc._conflicts.length||delete g.doc._conflicts),g}function cm(h,g){return g>h?-1:h>g?1:0}function e1(i,h){for(var g=0;g<i.length;g++){if(h(i[g],g)===!0){return i[g]}}}function e8(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function dT(l){for(var j=0;j<l.length;j++){var i=l[j];if(i._deleted){delete i._attachments}else{if(i._attachments){for(var k=Object.keys(i._attachments),h=0;h<k.length;h++){var g=k[h];i._attachments[g]=f5(i._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function eb(k,i){var h=cm(k._id,i._id);if(0!==h){return h}var j=k._revisions?k._revisions.start:0,g=i._revisions?i._revisions.start:0;return cm(j,g)}function cI(i){var h={},g=[];return fM(i,function(j,n,k,m){var l=n+"-"+k;return j&&(h[l]=0),void 0!==m&&g.push({from:m,to:l}),l}),g.reverse(),g.forEach(function(j){void 0===h[j.from]?h[j.from]=1+h[j.to]:h[j.from]=Math.min(h[j.from],1+h[j.to])}),h}function j4(k,i,h){var j="limit" in i?i.keys.slice(i.skip,i.limit+i.skip):i.skip>0?i.keys.slice(i.skip):i.keys;if(i.descending&&j.reverse(),!j.length){return k._allDocs({limit:0},h)}var g={offset:i.skip};return cz.all(j.map(function(m){var l=d0.extend({key:m,deleted:"ok"},i);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new cz(function(o,n){k._allDocs(l,function(q,p){return q?n(q):(g.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return g.rows=l,g})}function f8(i){var g=i._compactionQueue[0],h=g.opts,j=g.callback;i.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(h.last_seq=k.last_seq),i._compact(h,function(l,m){l?j(l):j(null,m),c1.nextTick(function(){i._compactionQueue.shift(),i._compactionQueue.length&&f8(i)})})})}function bd(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function aQ(){aZ.EventEmitter.call(this)}function dk(){this.isReady=!1,this.failed=!1,this.queue=[]}function dv(g){g&&aL.debug&&bJ("error",g)}function e(i,l){function g(){k.emit("destroyed",j)}function m(){i.removeListener("destroyed",g),i.emit("destroyed",i)}var j=l.originalName,k=i.constructor,h=k._destructionListeners;i.once("destroyed",g),h.has(j)||h.set(j,[]),h.get(j).push(m)}function dj(i,l,g){if(!(this instanceof dj)){return new dj(i,l,g)}var m=this;if("function"!=typeof l&&"undefined"!=typeof l||(g=l,l={}),i&&"object"==typeof i&&(l=i,i=void 0),"undefined"==typeof g){g=dv}else{var j=g;g=function(){return bJ("warn","Using a callback for new PouchDB()is deprecated."),j.apply(null,arguments)}}i=i||l.name,l=dC(l),delete l.name,this.__opts=l;var k=g;m.auto_compaction=l.auto_compaction,m.prefix=dj.prefix,aQ.call(m),m.taskqueue=new dk;var h=new cz(function(q,o){g=function(r,s){return r?o(r):(delete s.then,void q(s))},l=dC(l);var n,p;return function(){try{if("string"!=typeof i){throw p=new Error("Missing/invalid DB name"),p.code=400,p}var r=(l.prefix||"")+i;if(n=dj.parseAdapter(r,l),l.originalName=i,l.name=n.name,l.adapter=l.adapter||n.adapter,m._adapter=l.adapter,b2("pouchdb:adapter")("Picked adapter: "+l.adapter),m._db_name=i,!dj.adapters[l.adapter]){throw p=new Error("Adapter is missing"),p.code=404,p}if(!dj.adapters[l.adapter].valid()){throw p=new Error("Invalid Adapter"),p.code=404,p}}catch(s){m.taskqueue.fail(s)}}(),p?o(p):(m.adapter=l.adapter,m.replicate={},m.replicate.from=function(r,u,s){return m.constructor.replicate(r,m,u,s)},m.replicate.to=function(r,u,s){return m.constructor.replicate(m,r,u,s)},m.sync=function(r,u,s){return m.constructor.sync(m,r,u,s)},m.replicate.sync=m.sync,void dj.adapters[l.adapter].call(m,l,function(r){return r?(m.taskqueue.fail(r),void g(r)):(e(m,l),m.emit("created",m),dj.emit("created",l.originalName),m.taskqueue.ready(m),void g(null,m))}))});h.then(function(n){k(null,n)},k),m.then=h.then.bind(h),m["catch"]=h["catch"].bind(h)}function bq(h){Object.keys(aZ.EventEmitter.prototype).forEach(function(i){"function"==typeof aZ.EventEmitter.prototype[i]&&(h[i]=cM[i].bind(cM))});var g=h._destructionListeners=new bm.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function eG(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function eA(i){if(!/^\d+\-./.test(i)){return av(c2)}var g=i.indexOf("-"),j=i.substring(0,g),h=i.substring(g+1);return{prefix:parseInt(j,10),id:h}}function c9(i,l){for(var g=i.start-i.ids.length+1,m=i.ids,j=[m[0],l,[]],k=1,h=m.length;h>k;k++){j=[m[k],{status:"missing"},[j]]}return[{pos:g,ids:j}]}function bR(i,k){var g,m,o,h={status:"available"};if(i._deleted&&(h.deleted=!0),k){if(i._id||(i._id=eM()),m=eM(32,16).toLowerCase(),i._rev){if(o=eA(i._rev),o.error){return o}i._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[m,h,[]]]]}],g=o.prefix+1}else{i._rev_tree=[{pos:1,ids:[m,h,[]]}],g=1}}else{if(i._revisions&&(i._rev_tree=c9(i._revisions,h),g=i._revisions.start,m=i._revisions.ids[0]),!i._rev_tree){if(o=eA(i._rev),o.error){return o}g=o.prefix,m=o.id,i._rev_tree=[{pos:g,ids:[m,h,[]]}]}}cU(i._id),i._rev=g+"-"+m;var j={metadata:{},data:{}};for(var l in i){if(Object.prototype.hasOwnProperty.call(i,l)){var p="_"===l[0];if(p&&!ea[l]){var n=av(eZ,l);throw n.message=eZ.message+": "+l,n}p&&!cG[l]?j.metadata[l.slice(1)]=i[l]:j.data[l]=i[l]}}return j}function cO(k){for(var i="",h=new Uint8Array(k),j=h.byteLength,g=0;j>g;g++){i+=String.fromCharCode(h[g])}return i}function fE(g){return cD(cO(g))}function cp(l,j){l=l||[],j=j||{};try{return new Blob(l,j)}catch(i){if("TypeError"!==i.name){throw i}for(var k="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,h=new k,g=0;g<l.length;g+=1){h.append(l[g])}return h.getBlob(j.type)}}function dE(k){for(var i=k.length,h=new ArrayBuffer(i),j=new Uint8Array(h),g=0;i>g;g++){j[g]=k.charCodeAt(g)}return h}function eR(h,g){return cp([dE(h)],{type:g})}function dz(h,g){return eR(f1(h),g)}function fJ(i,g){if("undefined"==typeof FileReader){return g(cO((new FileReaderSync).readAsArrayBuffer(i)))}var j=new FileReader,h="function"==typeof j.readAsBinaryString;j.onloadend=function(k){var l=k.target.result||"";return h?g(l):void g(cO(l))},h?j.readAsBinaryString(i):j.readAsArrayBuffer(i)}function bB(h,g){fJ(h,function(i){g(cD(i))})}function fK(i,h){if("undefined"==typeof FileReader){return h((new FileReaderSync).readAsArrayBuffer(i))}var g=new FileReader;g.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);h(k)},g.readAsArrayBuffer(i)}function aB(g){return cD(g)}function eU(i,g,j,h){(j>0||h<g.byteLength)&&(g=new Uint8Array(g,j,Math.min(h,g.byteLength)-j)),i.append(g)}function db(i,g,j,h){(j>0||h<g.length)&&(g=g.substring(j,h)),i.appendBinary(g)}function jW(i,k){function g(){var q=l*h,u=q+h;if(l++,j>l){n(p,i,q,u),ck(g)}else{n(p,i,q,u);var r=p.end(!0),s=aB(r);k(s),p.destroy()}}var m="string"==typeof i,o=m?i.length:i.byteLength,h=Math.min(bG,o),j=Math.ceil(o/h),l=0,p=m?new cS:new cS.ArrayBuffer,n=m?db:eU;g()}function jG(g){return cS.hash(g)}function jV(g,h,m){function i(o){try{return f1(o)}catch(q){var p=av(bW,"Attachment is not a valid base64 string");return{error:p}}}function k(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=i(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===h?q.data=eR(o,q.content_type):"base64"===h?q.data=cD(o):q.data=o,jW(o,function(r){q.digest="md5-"+r,p()})}else{fK(q.data,function(r){"binary"===h?q.data=cO(r):"base64"===h&&(q.data=fE(r)),jW(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function l(){n++,g.length===n&&(j?m(j):m())}if(!g.length){return m()}var j,n=0;g.forEach(function(r){function p(u){j=u,q++,q===s.length&&l()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return l()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&k(r.data._attachments[o],p)}})}function bu(g,y,q,r,s,j,x,h){if(aT(y.rev_tree,q.metadata.rev)){return r[s]=q,j()}var w=y.winningRev||dH(y),m="deleted" in y?y.deleted:aP(y,w),B="deleted" in q.metadata?q.metadata.deleted:aP(q.metadata),n=/^1-/.test(q.metadata.rev);if(m&&!B&&h&&n){var p=q.data;p._rev=w,p._id=q.metadata.id,q=bR(p,h)}var i=a8(y.rev_tree,q.metadata.rev_tree[0],g),z=h&&(m&&B||!m&&"new_leaf"!==i.conflicts||m&&!B&&"new_branch"===i.conflicts);if(z){var l=av(dF);return r[s]=l,j()}var k=q.metadata.rev;q.metadata.rev_tree=i.tree,q.stemmedRevs=i.stemmedRevs||[],y.rev_map&&(q.metadata.rev_map=y.rev_map);var u,A=dH(q.metadata),o=aP(q.metadata,A),v=m===o?0:o>m?-1:1;u=k===A?o:aP(q.metadata,k),x(q,A,o,u,!0,v,s,j)}function jM(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function bl(q,u,j,k,g,m,o,i,r){function v(B,x,C){var A=dH(B.metadata),D=aP(B.metadata,A);if("was_delete" in i&&D){return m[x]=av(bb,"deleted"),C()}var w=h&&jM(B);if(w){var z=av(dF);return m[x]=z,C()}var y=D?0:1;o(B,A,D,D,!1,y,x,C)}function p(){++s===l&&r&&r()}q=q||1000;var h=i.new_edits,n=new bm.Map,s=0,l=u.length;u.forEach(function(y,w){if(y._id&&du(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void j[x](y,{ctx:g},function(B,A){m[w]=B||A,p()})}var z=y.metadata.id;n.has(z)?(l--,n.get(z).push([y,w])):n.set(z,[[y,w]])}),n.forEach(function(x,z){function y(){++w<x.length?A():p()}function A(){var C=x[w],E=C[0],D=C[1];if(k.has(z)){bu(q,k.get(z),E,m,D,y,o,h)}else{var B=a8([],E.metadata.rev_tree[0],q);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],v(E,D,y)}}var w=0;A()})}function aM(h){try{return JSON.parse(h)}catch(g){return aX.parse(h)}}function t(g){return g.length<50000?JSON.parse(g):aM(g)}function j1(h){try{return JSON.stringify(h)}catch(g){return aX.stringify(h)}}function j7(k,i,h,j){try{k.apply(i,h)}catch(g){j.emit("error",g)}}function ay(h){if(!ag.running&&ag.queue.length){ag.running=!0;var g=ag.queue.shift();g.action(function(i,j){j7(g.callback,this,[i,j],h),ag.running=!1,c1.nextTick(function(){ay(h)})})}}function aa(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(av(e6,i,h.type))}}function cZ(i,h,g){return{data:j1(i),winningRev:h,deletedOrLocal:g?"1":"0",seq:i.seq,id:i.id}}function jN(h){if(!h){return null}var g=t(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function j0(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function b8(i,g,j,h){j?h(i?"string"!=typeof i?i:dz(i,g):cp([""],{type:g})):i?"string"!=typeof i?fJ(i,function(k){h(cD(k))}):h(i):h("")}function bk(g,h,m,i){function k(){++n===j.length&&i&&i()}function l(s,q){var r=s._attachments[q],p=r.digest,o=m.objectStore(dl).get(p);o.onsuccess=function(u){r.body=u.target.result.body,k()}}var j=Object.keys(g._attachments||{});if(!j.length){return i&&i()}var n=0;j.forEach(function(o){h.attachments&&h.include_docs?l(g,o):(g._attachments[o].stub=!0,k())})}function bM(h,g){return cz.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return cz.all(j.map(function(n){var l=i.doc._attachments[n];if("body" in l){var m=l.body,k=l.content_type;return new cz(function(o){b8(m,k,g,function(p){i.doc._attachments[n]=d0.extend(f5(l,["digest","content_type"]),{data:p}),o()})})}}))}}))}function c3(i,k,g){function m(){n--,n||o()}function o(){h.length&&h.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||l["delete"](q)}})}var h=[],j=g.objectStore(e7),l=g.objectStore(dl),p=g.objectStore(bg),n=i.length;i.forEach(function(s){var r=j.index("_doc_id_rev"),q=k+"::"+s;r.getKey(q).onsuccess=function(w){var v=w.target.result;if("number"!=typeof v){return m()}j["delete"](v);var u=p.index("seq").openCursor(IDBKeyRange.only(v));u.onsuccess=function(y){var x=y.target.result;if(x){var z=x.value.digestSeq.split("::")[0];h.push(z),p["delete"](x.primaryKey),x["continue"]()}else{m()}}}})}function aE(i,g,j){try{return{txn:i.transaction(g,j)}}catch(h){return{error:h}}}function aR(j,p,E,k,v,D,C){function G(){var P=[cA,e7,dl,cN,bg],O=aE(v,P,"readwrite");return O.error?C(O.error):(H=O.txn,H.onabort=aa(C),H.ontimeout=aa(C),H.oncomplete=x,y=H.objectStore(cA),I=H.objectStore(e7),q=H.objectStore(dl),o=H.objectStore(bg),void g(function(Q){return Q?(N=!0,C(Q)):void h()}))}function l(){bl(j.revs_limit,F,k,M,H,z,n,E)}function h(){function Q(){++S===F.length&&l()}function O(W){var V=jN(W.target.result);V&&M.set(V.id,V),Q()}if(F.length){for(var S=0,P=0,R=F.length;R>P;P++){var U=F[P];if(U._id&&du(U._id)){Q()}else{var T=y.get(U.metadata.id);T.onsuccess=O}}}}function x(){N||(D.notify(k._meta.name),k._meta.docCount+=B,C(null,z))}function u(P,O){var Q=q.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=av(bA,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(F.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){u(T,function(U){U&&!P&&(P=U),O()})})}function n(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?m(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ao){var ai=X.stemmedRevs||[];R&&k.auto_compaction&&(ai=ai.concat(cd(X.metadata))),ai&&ai.length&&c3(ai,X.metadata.id,H),T.seq=ao.target.result,delete T.rev;var ae=cZ(T,Q,S),an=y.put(ae);an.onsuccess=Z}function P(ae){ae.preventDefault(),ae.stopPropagation();var an=I.index("_doc_id_rev"),ai=an.getKey(V._doc_id_rev);ai.onsuccess=function(ar){var ao=I.put(V,ar.target.result);ao.onsuccess=W}}function Z(){z[U]={ok:!0,id:T.id,rev:Q},M.set(X.metadata.id,X.metadata),r(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=I.put(V);Y.onsuccess=W,Y.onerror=P}function m(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(ai){var Z=W.data._attachments[ai];if(Z.stub){X++,Y()}else{var ae=Z.data;delete Z.data,Z.revpos=parseInt(P,10);var an=Z.digest;A(an,ae,Q)}})}function r(V,S,P){function U(){++R===Q.length&&P()}function O(Y){var X=V.data._attachments[Y].digest,W=o.put({seq:S,digestSeq:X+"::"+S});W.onsuccess=U,W.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),U()}}var R=0,Q=Object.keys(V.data._attachments||{});if(!Q.length){return P()}for(var T=0;T<Q.length;T++){O(Q[T])}}function A(Q,O,R){var P=q.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=q.put(U);T.onsuccess=R}}for(var H,y,I,q,o,s,F=p.docs,B=0,w=0,J=F.length;J>w;w++){var L=F[w];L._id&&du(L._id)||(L=F[w]=bR(L,E.new_edits),L.error&&!s&&(s=L))}if(s){return C(s)}var z=new Array(F.length),M=new bm.Map,N=!1,i=k._meta.blobSupport?"blob":"base64";jV(F,i,function(O){return O?C(O):void G()})}function cH(l,j,i,k,h){try{if(l&&j){return h?IDBKeyRange.bound(j,l,!i,!1):IDBKeyRange.bound(l,j,!1,!i)}if(l){return h?IDBKeyRange.upperBound(l):IDBKeyRange.lowerBound(l)}if(j){return h?IDBKeyRange.lowerBound(j,!i):IDBKeyRange.upperBound(j,!i)}if(k){return IDBKeyRange.only(k)}}catch(g){return{error:g}}return null}function b1(i,g,j,h){return"DataError"===j.name&&0===j.code?h(null,{total_rows:i._meta.docCount,offset:g.skip,rows:[]}):void h(av(e6,j.name,j.message))}function bs(l,j,i,k){function h(C,z){function A(L,O,M){var N=L.id+"::"+M;p.get(N).onsuccess=function(P){O.doc=j0(P.target.result),C.conflicts&&(O.doc._conflicts=dZ(L)),bk(O.doc,C,x)}}function v(M,O,N){var L={id:N.id,key:N.id,value:{rev:O}},P=N.deleted;if("ok"===C.deleted){w.push(L),P?(L.value.deleted=!0,L.doc=null):C.include_docs&&A(N,L,O)}else{if(!P&&F--<=0&&(w.push(L),C.include_docs&&A(N,L,O),0===--o)){return}}M["continue"]()}function G(M){K=j._meta.docCount;var O=M.target.result;if(O){var L=jN(O.value),N=L.winningRev;v(O,N,L)}}function y(){z(null,{total_rows:K,offset:C.skip,rows:w})}function J(){C.attachments?bM(w,C.binary).then(y):y()}var r="startkey" in C?C.startkey:!1,q="endkey" in C?C.endkey:!1,E="key" in C?C.key:!1,F=C.skip||0,o="number"==typeof C.limit?C.limit:-1,H=C.inclusive_end!==!1,B="descending" in C&&C.descending?"prev":null,u=cH(r,q,H,E,B);if(u&&u.error){return b1(j,C,u.error,z)}var s=[cA,e7];C.attachments&&s.push(dl);var I=aE(i,s,"readonly");if(I.error){return z(I.error)}var x=I.txn,D=x.objectStore(cA),n=x.objectStore(e7),m=B?D.openCursor(u,B):D.openCursor(u),p=n.index("_doc_id_rev"),w=[],K=0;x.oncomplete=J,m.onsuccess=G}function g(m,n){return 0===m.limit?n(null,{total_rows:j._meta.docCount,offset:m.skip,rows:[]}):void h(m,n)}g(l,k)}function cR(g){return new cz(function(h){var i=cp([""]);g.objectStore(am).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function eg(i,h){var g=this;ag.queue.push({action:function(j){aO(g,i,j)},callback:h}),ay(g.constructor)}function aO(p,q,h){function j(x){var w=x.createObjectStore(cA,{keyPath:"id"});x.createObjectStore(e7,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(dl,{keyPath:"digest"}),x.createObjectStore(ej,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(am),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(cN,{keyPath:"_id"});var v=x.createObjectStore(bg,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function k(x,w){var v=x.objectStore(cA);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=aP(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function g(v){v.createObjectStore(cN,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function o(w,y){var x=w.objectStore(cN),z=w.objectStore(cA),v=w.objectStore(e7),A=z.openCursor();A.onsuccess=function(L){var I=L.target.result;if(I){var C=I.value,F=C.id,E=du(F),B=dH(C);if(E){var K=F+"::"+B,H=F+"::",M=F+"::~",J=v.index("_doc_id_rev"),G=IDBKeyRange.bound(H,M,!1,!1),D=J.openCursor(G);D.onsuccess=function(N){if(D=N.target.result){var O=D.value;O._doc_id_rev===K&&x.put(O),v["delete"](D.primaryKey),D["continue"]()}else{z["delete"](I.primaryKey),I["continue"]()}}}else{I["continue"]()}}else{y&&y()}}}function l(w){var v=w.createObjectStore(bg,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function m(w,y){var x=w.objectStore(e7),z=w.objectStore(dl),v=w.objectStore(bg),A=z.count();A.onsuccess=function(B){var C=B.target.result;return C?void (x.openCursor().onsuccess=function(D){var J=D.target.result;if(!J){return y()}for(var I=J.value,L=J.primaryKey,F=Object.keys(I._attachments||{}),H={},G=0;G<F.length;G++){var E=I._attachments[F[G]];H[E.digest]=!0}var M=Object.keys(H);for(G=0;G<M.length;G++){var K=M[G];v.put({seq:L,digestSeq:K+"::"+L})}J["continue"]()}):y()}}function s(x){function y(A){return A.data?jN(A):(A.deleted="1"===A.deletedOrLocal,A)}var w=x.objectStore(e7),v=x.objectStore(cA),z=v.openCursor();z.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=w.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=cZ(B,B.winningRev,B.deleted),F=v.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=y(E.value);return B.winningRev=B.winningRev||dH(B),B.seq?A():void D()}}}var i=q.name,u=null;p._meta=null,p.type=function(){return"idb"},p._id=eX(function(v){v(null,p._meta.instanceId)}),p._bulkDocs=function(v,w,x){aR(q,v,w,p,u,jT,x)},p._get=function(w,A,z){function D(){z(x,{doc:v,metadata:C,ctx:B})}var v,C,x,B=A.ctx;if(!B){var y=aE(u,[cA,e7,dl],"readonly");if(y.error){return z(y.error)}B=y.txn}B.objectStore(cA).get(w).onsuccess=function(E){if(C=jN(E.target.result),!C){return x=av(bb,"missing"),D()}if(aP(C)&&!A.rev){return x=av(bb,"deleted"),D()}var G=B.objectStore(e7),H=A.rev||C.winningRev,F=C.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return v=I.target.result,v&&(v=j0(v)),v?void D():(x=av(bb,"missing"),D())}}},p._getAttachment=function(w,A,z,D,v){var C;if(D.ctx){C=D.ctx}else{var x=aE(u,[cA,e7,dl],"readonly");if(x.error){return v(x.error)}C=x.txn}var B=z.digest,y=z.content_type;C.objectStore(dl).get(B).onsuccess=function(E){var F=E.target.result.body;b8(F,y,D.binary,function(G){v(null,G)})}},p._info=function(A){if(null===u||!el.has(i)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var x,z,v=aE(u,[e7],"readonly");if(v.error){return A(v.error)}var w=v.txn,B=w.objectStore(e7).openCursor(null,"prev");B.onsuccess=function(D){var C=D.target.result;x=C?C.key:0,z=p._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:x,idb_attachment_format:p._meta.blobSupport?"binary":"base64"})}},p._allDocs=function(v,w){bs(v,p,u,w)},p._changes=function(L){function C(N){function T(){return S.seq!==O?N["continue"]():(I=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=E.get(U);V.onsuccess=function(W){R(j0(W.target.result))}}function R(V){var W=L.processChange(V,S,L);W.seq=S.seq;var U=G(W);return"object"==typeof U?L.complete(U):(U&&(B++,w&&v.push(W),L.attachments&&L.include_docs?bk(V,L,J,function(){bM([W],L.binary).then(function(){L.onChange(W)})}):L.onChange(W)),void (B!==z&&N["continue"]()))}var P=j0(N.value),O=N.key;if(x&&!x.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (M.get(P._id).onsuccess=function(U){S=jN(U.target.result),y.set(P._id,S),T()})}function H(N){var O=N.target.result;O&&C(O)}function K(){var P=[cA,e7];L.attachments&&P.push(dl);var O=aE(u,P,"readonly");if(O.error){return L.complete(O.error)}J=O.txn,J.onabort=aa(L.complete),J.oncomplete=D,F=J.objectStore(e7),M=J.objectStore(cA),E=F.index("_doc_id_rev");var N;N=L.descending?F.openCursor(null,"prev"):F.openCursor(IDBKeyRange.lowerBound(L.since,!0)),N.onsuccess=H}function D(){function N(){L.complete(null,{results:v,last_seq:I})}!L.continuous&&L.attachments?bM(v).then(N):N()}if(L=dC(L),L.continuous){var A=i+":"+eM();return jT.addListener(i,A,p,L),jT.notify(i),{cancel:function(){jT.removeListener(i,A)}}}var x=L.doc_ids&&new bm.Set(L.doc_ids);L.since=L.since||0;var I=L.since,z="limit" in L?L.limit:-1;0===z&&(z=1);var w;w="return_docs" in L?L.return_docs:"returnDocs" in L?L.returnDocs:!0;var J,F,M,E,v=[],B=0,G=aD(L),y=new bm.Map;K()},p._close=function(v){return null===u?v(av(ba)):(u.close(),el["delete"](i),u=null,void v())},p._getRevisionTree=function(x,y){var w=aE(u,[cA],"readonly");if(w.error){return y(w.error)}var v=w.txn,z=v.objectStore(cA).get(x);z.onsuccess=function(B){var A=jN(B.target.result);A?y(null,A.rev_tree):y(av(bb))}},p._doCompaction=function(y,A,z){var B=[cA,e7,dl,bg],x=aE(u,B,"readwrite");if(x.error){return z(x.error)}var v=x.txn,w=v.objectStore(cA);w.get(y).onsuccess=function(E){var C=jN(E.target.result);fM(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),c3(A,y,v);var D=C.winningRev,F=C.deleted;v.objectStore(cA).put(cZ(C,D,F))},v.onabort=aa(z),v.oncomplete=function(){z()}},p._getLocal=function(x,y){var w=aE(u,[cN],"readonly");if(w.error){return y(w.error)}var v=w.txn,z=v.objectStore(cN).get(x);z.onerror=aa(y),z.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,y(null,A)):y(av(bb))}},p._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=aE(u,[cN],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=aa(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(cN);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(av(dF))}}):(y=v.add(E),y.onerror=function(F){x(av(dF)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},p._removeLocal=function(w,A,z){"function"==typeof A&&(z=A,A={});var D=A.ctx;if(!D){var v=aE(u,[cN],"readwrite");if(v.error){return z(v.error)}D=v.txn,D.oncomplete=function(){C&&z(null,C)}}var C,x=w._id,B=D.objectStore(cN),y=B.get(x);y.onerror=aa(z),y.onsuccess=function(F){var E=F.target.result;E&&E._rev===w._rev?(B["delete"](x),C={ok:!0,id:x,rev:"0-0"},A.ctx&&z(null,C)):z(av(bb))}},p._destroy=function(y,w){jT.removeAllListeners(i);var v=jL.get(i);v&&v.result&&(v.result.close(),el["delete"](i));var x=indexedDB.deleteDatabase(i);x.onsuccess=function(){jL["delete"](i),dd()&&i in localStorage&&delete localStorage[i],w(null,{ok:!0})},x.onerror=aa(w)};var n=el.get(i);if(n){return u=n.idb,p._meta=n.global,void c1.nextTick(function(){h(null,p)})}var r;r=q.storage?aG(i,q.storage):indexedDB.open(i,dG),jL.set(i,r),r.onupgradeneeded=function(y){function w(){var B=v[A-1];A++,B&&B(x,w)}var z=y.target.result;if(y.oldVersion<1){return j(z)}var x=y.currentTarget.transaction;y.oldVersion<3&&g(z),y.oldVersion<4&&l(z);var v=[k,o,m,s],A=y.oldVersion;w()},r.onsuccess=function(z){u=z.target.result,u.onversionchange=function(){u.close(),el["delete"](i)},u.onabort=function(B){bJ("error","Database has a global failure",B.target.error),u.close(),el["delete"](i)};var x=u.transaction([ej,am,cA],"readwrite"),v=x.objectStore(ej).get(ej),y=null,w=null,A=null;v.onsuccess=function(D){var B=function(){null!==y&&null!==w&&null!==A&&(p._meta={name:i,instanceId:A,blobSupport:y,docCount:w},el.set(i,{idb:u,global:p._meta}),h(null,p))},E=D.target.result||{id:ej};i+"_id" in E?(A=E[i+"_id"],B()):(A=eM(),E[i+"_id"]=A,x.objectStore(ej).put(E).onsuccess=function(){B()}),bE||(bE=cR(x)),bE.then(function(F){y=F,B()});var C=x.objectStore(cA).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){w=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";bJ("error",v),h(av(e6,v))}}function aG(i,h){try{return indexedDB.open(i,{version:dG,storage:h})}catch(g){return indexedDB.open(i,dG)}}function b4(g){g.adapter("idb",eg,!0)}function aS(g){return decodeURIComponent(escape(g))}function cy(g){return 65>g?g-48:g-55}function al(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(cy(i.charCodeAt(g++))<<4|cy(i.charCodeAt(g++)))}return h}function c5(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(cy(i.charCodeAt(g+2))<<12|cy(i.charCodeAt(g+3))<<8|cy(i.charCodeAt(g))<<4|cy(i.charCodeAt(g+1))),g+=4}return h}function bf(h,g){return"UTF-8"===g?aS(al(h,0,h.length)):c5(h,0,h.length)}function aV(g){return"'"+g+"'"}function b5(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function cw(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function aH(g){return delete g._id,delete g._rev,JSON.stringify(g)}function bh(i,h,g){return i=JSON.parse(i),i._id=h,i._rev=g,i}function cK(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function cX(k,i,h,j,g){return"SELECT "+k+" FROM "+("string"==typeof i?i:i.join(" JOIN "))+(h?" ON "+h:"")+(j?" WHERE "+("string"==typeof j?j:j.join(" AND ")):"")+(g?" ORDER BY "+g:"")}function aJ(i,l,g){function m(){++k===i.length&&j()}function j(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+ab+" WHERE seq IN "+cK(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+ab+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+ab+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new bm.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+ab+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+aq+" WHERE digest=?",[A]))})})})}})}}if(i.length){var k=0,h=[];i.forEach(function(o){var n="SELECT seq FROM "+c7+" WHERE doc_id=? AND rev=?";g.executeSql(n,[l,o],function(q,p){if(!p.rows.length){return m()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+c7+" WHERE seq=?",[r],m)})})}}function dW(g){return function(h){bJ("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(av(dP,j,i))}}function bY(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function aw(x,v,k,g,i,l,C){function n(){return w?C(w):(l.notify(g._name),g._docCount=-1,void C(null,r))}function u(E,D){var F="SELECT count(*) as cnt FROM "+aq+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=av(bA,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function z(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){u(I,function(J){J&&!E&&(E=J),D()})})}function h(N,G,Q,L,J,D,I,F){function P(){function Y(ar,at){function a0(){return ++ao===an.length&&at(),!1}function ai(a2){var a3="INSERT INTO "+ab+" (digest, seq) VALUES (?,?)",a1=[X._attachments[a2].digest,ar];p.executeSql(a3,a1,a0,a0)}var ao=0,an=Object.keys(X._attachments||{});if(!an.length){return at()}for(var ae=0;ae<an.length;ae++){ai(an[ae])}}var X=N.data,S=L?1:0,V=X._id,Z=X._rev,T=aH(X),U="INSERT INTO "+c7+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",W=[V,Z,T,S];p.executeSql(U,W,function(ai,ae){var an=ae.insertId;Y(an,function(){O(ai,an)})},function(){var ae=cX("seq",c7,null,"doc_id=? AND rev=?");return p.executeSql(ae,[V,Z],function(ai,an){var ao=an.rows.item(0).seq,ar="UPDATE "+c7+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[T,S,V,Z];ai.executeSql(ar,at,function(a0){Y(ao,function(){O(a0,ao)})})}),!1})}function M(S){K||(S?(K=S,F(K)):E===R.length&&P())}function H(S){E++,M(S)}function O(U,T){var W=N.metadata.id,V=N.stemmedRevs||[];J&&g.auto_compaction&&(V=cd(N.metadata).concat(V)),V.length&&aJ(V,W,U),N.metadata.seq=T,delete N.metadata.rev;var X=J?"UPDATE "+cW+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+c7+" WHERE doc_id="+cW+".id AND rev=?) WHERE id=?":"INSERT INTO "+cW+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",Y=j1(N.metadata),S=J?[Y,T,G,W]:[W,T,T,Y];U.executeSql(X,S,function(){r[I]={ok:!0,id:N.metadata.id,rev:G},A.set(W,N.metadata),F()})}var K=null,E=0;N.data._id=N.metadata.id,N.data._rev=N.metadata.rev;var R=Object.keys(N.data._attachments||{});L&&(N.data._deleted=!0),R.forEach(function(U){var S=N.data._attachments[U];if(S.stub){E++,M()}else{var T=S.data;delete S.data,S.revpos=parseInt(G,10);var V=S.digest;j(V,T,H)}}),R.length||P()}function B(){bl(x.revs_limit,o,g,A,p,r,h,k)}function m(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&du(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+cW+" WHERE id = ?",[H],function(K,J){if(J.rows.length){var I=t(J.rows.item(0).json);A.set(H,I)}D()})})}function j(F,D,G){var E="SELECT digest FROM "+aq+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+aq+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,b5(D)],function(){G()},function(){return G(),!1}))})}var q=k.new_edits,s=v.docs,o=s.map(function(E){if(E._id&&du(E._id)){return E}var D=bR(E,q);return D}),y=o.filter(function(D){return D.error});if(y.length){return C(y[0])}var p,w,r=new Array(o.length),A=new bm.Map;jV(o,"binary",function(D){return D?C(D):void i.transaction(function(E){p=E,z(function(F){F?w=F:m(B)})},dW(C),n)})}function cQ(g){return g.websql(g.name,g.version,g.description,g.size)}function aW(h){try{return{db:cQ(h)}}catch(g){return{error:g}}}function dM(h){var g=f2.get(h.name);return g||(g=aW(h),f2.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function bL(g,i,l,j,m){function n(){++o===k.length&&m&&m()}function h(q,s){var r=q._attachments[s],p={binary:i.binary,ctx:j};l._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=d0.extend(f5(r,["digest","content_type"]),{data:v}),n()})}var k=Object.keys(g._attachments||{});if(!k.length){return m&&m()}var o=0;k.forEach(function(p){i.attachments&&i.include_docs?h(g,p):(g._attachments[p].stub=!0,n())})}function cV(A,m){function C(){dd()&&(window.localStorage["_pouch__websqldb_"+x._name]=!0),m(null,x)}function n(F,E){F.executeSql(a9),F.executeSql("ALTER TABLE "+c7+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(bX),F.executeSql("ALTER TABLE "+cW+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+cW+" (local, id)");var G="SELECT "+cW+".winningseq AS seq, "+cW+".json AS metadata FROM "+c7+" JOIN "+cW+" ON "+c7+".seq = "+cW+".winningseq";F.executeSql(G,[],function(I,M){for(var H=[],K=[],L=0;L<M.rows.length;L++){var N=M.rows.item(L),O=N.seq,J=JSON.parse(N.metadata);aP(J)&&H.push(O),du(J.id)&&K.push(J.id)}I.executeSql("UPDATE "+cW+"SET local = 1 WHERE id IN "+cK(K.length),K,function(){I.executeSql("UPDATE "+c7+" SET deleted = 1 WHERE seq IN "+cK(H.length),H,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+cv+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+cW+".id AS id, "+c7+".json AS data FROM "+c7+" JOIN "+cW+" ON "+c7+".seq = "+cW+".winningseq WHERE local = 1";F.executeSql(H,[],function(I,K){function M(){if(!J.length){return E(I)}var O=J.shift(),N=JSON.parse(O.data)._rev;I.executeSql("INSERT INTO "+cv+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+cW+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+c7+" WHERE seq=?",[O.seq],function(){M()})})})}for(var J=[],L=0;L<K.rows.length;L++){J.push(K.rows.item(L))}M()})})}function h(G,E){function H(J){function I(){if(!J.length){return E(G)}var P=J.shift(),N=bf(P.hex,k),K=N.lastIndexOf("::"),O=N.substring(0,K),M=N.substring(K+2),L="UPDATE "+c7+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(L,[O,M,N],function(){I()})}I()}var F="ALTER TABLE "+c7+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+c7+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(kf,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+c7;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function B(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+aq;I.executeSql(J,[],function(O,K){function N(){var Q=cX(b7+", "+cW+".id AS id",[cW,c7],ke,null,cW+".id ");Q+=" LIMIT "+L+" OFFSET "+M,M+=L,O.executeSql(Q,[],function(ai,R){function V(at,ar){var ao=T[at]=T[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!R.rows.length){return E(ai)}for(var T={},X=0;X<R.rows.length;X++){for(var an=R.rows.item(X),Z=bh(an.data,an.id,an.rev),U=Object.keys(Z._attachments||{}),W=0;W<U.length;W++){var S=Z._attachments[U[W]];V(S.digest,an.seq)}}var ae=[];if(Object.keys(T).forEach(function(ar){var ao=T[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return N()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+ab+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&N()})})})}var P=K.rows.item(0).cnt;if(!P){return E(O)}var M=0,L=10;N()})}var F="CREATE TABLE IF NOT EXISTS "+ab+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(cB,[],function(J){J.executeSql(dQ,[],H)})})}function D(F,E){var G="ALTER TABLE "+aq+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function v(F,E){var G="ALTER TABLE "+cW+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+cW+" SET max_seq=(SELECT MAX(seq) FROM "+c7+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+cW+" (max_seq)";J.executeSql(K,[],E)})})}function w(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;k=2===H.length?"UTF-8":"UTF-16",E()})}function y(){for(;i.length>0;){var E=i.pop();E(null,o)}}function s(I,E){if(0===E){var N="CREATE TABLE IF NOT EXISTS "+j6+" (dbid, db_version INTEGER)",K="CREATE TABLE IF NOT EXISTS "+aq+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",H="CREATE TABLE IF NOT EXISTS "+ab+" (digest, seq INTEGER)",F="CREATE TABLE IF NOT EXISTS "+cW+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",G="CREATE TABLE IF NOT EXISTS "+c7+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",M="CREATE TABLE IF NOT EXISTS "+cv+" (id UNIQUE, rev, json)";I.executeSql(K),I.executeSql(M),I.executeSql(H,[],function(){I.executeSql(dQ),I.executeSql(cB)}),I.executeSql(F,[],function(){I.executeSql(a9),I.executeSql(G,[],function(){I.executeSql(bX),I.executeSql(kf),I.executeSql(N,[],function(){var R="INSERT INTO "+j6+" (db_version, dbid) VALUES (?,?)";o=eM();var Q=[f4,o];I.executeSql(R,Q,function(){y()})})})})}else{var O=function(){var Q=f4>E;Q&&I.executeSql("UPDATE "+j6+" SET db_version = "+f4);var R="SELECT dbid FROM "+j6;I.executeSql(R,[],function(T,S){o=S.rows.item(0).dbid,y()})},L=[n,p,h,B,D,v,O],J=E,P=function(Q){L[J-1](Q,P),J++};P(I)}}function g(){u.transaction(function(E){w(E,function(){r(E)})},dW(m),C)}function r(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+j6;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+j6,[],function(K,J){var I=J.rows.item(0).db_version;s(K,I)}):H.executeSql("ALTER TABLE "+j6+" ADD COLUMN db_version INTEGER",[],function(){s(H,1)}):s(H,0)})}function j(F,E){if(-1!==x._docCount){return E(x._docCount)}var G=cX("COUNT("+cW+".id) AS 'num'",[cW,c7],ke,c7+".deleted=0");F.executeSql(G,[],function(I,H){x._docCount=H.rows.item(0).num,E(x._docCount)})}var k,x=this,o=null,l=bY(A),i=[];x._docCount=-1,x._name=A.name;var q=d0.extend({},A,{version:fA,description:A.name,size:l}),z=dM(q);if(z.error){return dW(m)(z.error)}var u=z.db;"function"!=typeof u.readTransaction&&(u.readTransaction=u.transaction),g(),x.type=function(){return"websql"},x._id=eX(function(E){E(null,o)}),x._info=function(E){u.readTransaction(function(F){j(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+c7;F.executeSql(G,[],function(J,K){var I=K.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:I,sqlite_plugin:u._sqlitePlugin,websql_encoding:k})})})},dW(E))},x._bulkDocs=function(E,G,F){aw(A,E,G,x,u,dL,F)},x._get=function(H,I,F){function M(){F(K,{doc:N,metadata:G,ctx:E})}var N,G,K,E=I.ctx;if(!E){return u.readTransaction(function(O){x._get(H,d0.extend({ctx:O},I),F)})}var L,J;I.rev?(L=cX(b7,[cW,c7],cW+".id="+c7+".doc_id",[c7+".doc_id=?",c7+".rev=?"]),J=[H,I.rev]):(L=cX(b7,[cW,c7],ke,cW+".id=?"),J=[H]),E.executeSql(L,J,function(O,P){if(!P.rows.length){return K=av(bb,"missing"),M()}var Q=P.rows.item(0);return G=t(Q.metadata),Q.deleted&&!I.rev?(K=av(bb,"deleted"),M()):(N=bh(Q.data,G.id,Q.rev),void M())})},x._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(cW+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(cW+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(cW+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(cW+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(c7+".deleted = 0"),u.readTransaction(function(S){j(S,function(U){if(P=U,0!==N){var T=cX(b7,[cW,c7],ke,J,cW+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(ar,X){for(var W=0,ai=X.rows.length;ai>W;W++){var ao=X.rows.item(W),V=t(ao.metadata),Z=V.id,an=bh(ao.data,Z,ao.rev),Y=an._rev,ae={id:Z,key:Z,value:{rev:Y}};if(E.include_docs&&(ae.doc=an,ae.doc._rev=Y,E.conflicts&&(ae.doc._conflicts=dZ(V)),bL(ae.doc,E,x,ar)),ao.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},dW(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},x._changes=function(E){function F(){var S=cW+".json AS metadata, "+cW+".max_seq AS maxSeq, "+c7+".json AS winningDoc, "+c7+".rev AS winningRev ",T=cW+" JOIN "+c7,R=cW+".id="+c7+".doc_id AND "+cW+".winningseq="+c7+".seq",Q=["maxSeq > ?"],O=[E.since];E.doc_ids&&(Q.push(cW+".id IN "+cK(E.doc_ids.length)),O=O.concat(E.doc_ids));var U="maxSeq "+(J?"DESC":"ASC"),N=cX(S,T,R,Q,U),M=aD(E);E.view||E.filter||(N+=" LIMIT "+G);var P=E.since||0;u.readTransaction(function(V){V.executeSql(N,O,function(ai,an){function Z(a0){return function(){E.onChange(a0)}}for(var at=0,ar=an.rows.length;ar>at;at++){var ao=an.rows.item(at),W=t(ao.metadata);P=ao.maxSeq;var ae=bh(ao.winningDoc,W.id,ao.winningRev),Y=E.processChange(ae,W,E);Y.seq=ao.maxSeq;var X=M(Y);if("object"==typeof X){return E.complete(X)}if(X&&(I++,L&&K.push(Y),E.attachments&&E.include_docs?bL(ae,E,x,ai,Z(Y)):Z(Y)()),I===G){break}}})},dW(E.complete),function(){E.continuous||E.complete(null,{results:K,last_seq:P})})}if(E=dC(E),E.continuous){var H=x._name+":"+eM();return dL.addListener(x._name,H,x,E),dL.notify(x._name),{cancel:function(){dL.removeListener(x._name,H)}}}var J=E.descending;E.since=E.since&&!J?E.since:0;var G="limit" in E?E.limit:-1;0===G&&(G=1);var L;L="return_docs" in E?E.return_docs:"returnDocs" in E?E.returnDocs:!0;var K=[],I=0;F()},x._close=function(E){E()},x._getAttachment=function(H,I,F,M,N){var G,K=M.ctx,E=F.digest,L=F.content_type,J="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+aq+" WHERE digest=?";K.executeSql(J,[E],function(P,O){var Q=O.rows.item(0),R=Q.escaped?cw(Q.body):bf(Q.body,k);G=M.binary?eR(R,L):cD(R),N(null,G)})},x._getRevisionTree=function(F,E){u.readTransaction(function(H){var G="SELECT json AS metadata FROM "+cW+" WHERE id = ?";H.executeSql(G,[F],function(K,I){if(I.rows.length){var J=t(I.rows.item(0).metadata);E(null,J.rev_tree)}else{E(av(bb))}})})},x._doCompaction=function(F,E,G){return E.length?void u.transaction(function(H){var I="SELECT json AS metadata FROM "+cW+" WHERE id = ?";H.executeSql(I,[F],function(L,J){var K=t(J.rows.item(0).metadata);fM(K.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var M="UPDATE "+cW+" SET json = ? WHERE id = ?";L.executeSql(M,[j1(K),F])}),aJ(E,F,H)},dW(G),function(){G()}):G()},x._getLocal=function(F,E){u.readTransaction(function(H){var G="SELECT json, rev FROM "+cv+" WHERE id=?";H.executeSql(G,[F],function(L,J){if(J.rows.length){var K=J.rows.item(0),I=bh(K.json,F,K.rev);E(null,I)}else{E(av(bb))}})})},x._putLocal=function(H,L,F){function M(N){var P,O;G?(P="UPDATE "+cv+" SET rev=?, json=? WHERE id=? AND rev=?",O=[E,K,J,G]):(P="INSERT INTO "+cv+" (id, rev, json) VALUES (?,?,?)",O=[J,E,K]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(I={ok:!0,id:J,rev:E},L.ctx&&F(null,I)):F(av(dF))},function(){return F(av(dF)),!1})}"function"==typeof L&&(F=L,L={}),delete H._revisions;var E,G=H._rev,J=H._id;E=G?H._rev="0-"+(parseInt(G.split("-")[1],10)+1):H._rev="0-1";var I,K=aH(H);L.ctx?M(L.ctx):u.transaction(M,dW(F),function(){I&&F(null,I)})},x._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+cv+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(av(bb))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):u.transaction(G,dW(E),function(){I&&E(null,I)})},x._destroy=function(F,E){dL.removeAllListeners(x._name),u.transaction(function(H){var G=[cW,c7,aq,j6,cv,ab];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},dW(E),function(){dd()&&(delete window.localStorage["_pouch__websqldb_"+x._name],delete window.localStorage[x._name]),E(null,{ok:!0})})}}function jZ(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function dA(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var i=dd(),h="_pouch__websqldb_valid_"+navigator.userAgent;if(i&&localStorage[h]){return"1"===localStorage[h]}var g=jZ();return i&&(localStorage[h]=g?"1":"0"),g}function cE(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:dA()}function jJ(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=d0.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function kc(i,g){var j=jJ(i),h=d0.extend({websql:j},i);cV.call(this,h,g)}function cq(g){g.adapter("websql",kc,!0)}function aj(){for(var i={},g=new cz(function(k,l){i.resolve=k,i.reject=l}),j=new Array(arguments.length),h=0;h<j.length;h++){j[h]=arguments[h]}return i.promise=g,cz.resolve().then(function(){return fetch.apply(null,j)}).then(function(k){i.resolve(k)})["catch"](function(k){i.reject(k)}),i}function kk(i,l){var g,m,j,k=new Headers,h={method:i.method,credentials:"include",headers:k};return i.json&&(k.set("Accept","application/json"),k.set("Content-Type",i.headers["Content-Type"]||"application/json")),i.body&&i.body instanceof Blob?fK(i.body,function(n){h.body=n}):i.body&&i.processData&&"string"!=typeof i.body?h.body=JSON.stringify(i.body):"body" in i?h.body=i.body:h.body=null,Object.keys(i.headers).forEach(function(n){i.headers.hasOwnProperty(n)&&k.set(n,i.headers[n])}),g=aj(i.url,h),i.timeout>0&&(m=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+i.url))},i.timeout)),g.promise.then(function(n){return j={statusCode:n.status},i.timeout>0&&clearTimeout(m),j.statusCode>=200&&j.statusCode<300?i.binary?n.blob():n.text():n.json()}).then(function(n){j.statusCode>=200&&j.statusCode<300?l(null,j,n):l(n,j)})["catch"](function(n){l(n,j)}),{abort:g.reject}}function f0(g,i){var l,j,m=!1,n=function(){l.abort()},h=function(){m=!0,l.abort()};l=g.xhr?new g.xhr:new XMLHttpRequest;try{l.open(g.method,g.url)}catch(k){i(k,{statusCode:413})}l.withCredentials="withCredentials" in g?g.withCredentials:!0,"GET"===g.method?delete g.headers["Content-Type"]:g.json&&(g.headers.Accept="application/json",g.headers["Content-Type"]=g.headers["Content-Type"]||"application/json",g.body&&g.processData&&"string"!=typeof g.body&&(g.body=JSON.stringify(g.body))),g.binary&&(l.responseType="arraybuffer"),"body" in g||(g.body=null);for(var o in g.headers){g.headers.hasOwnProperty(o)&&l.setRequestHeader(o,g.headers[o])}return g.timeout>0&&(j=setTimeout(h,g.timeout),l.onprogress=function(){clearTimeout(j),4!==l.readyState&&(j=setTimeout(h,g.timeout))},"undefined"!=typeof l.upload&&(l.upload.onprogress=l.onprogress)),l.onreadystatechange=function(){if(4===l.readyState){var s={statusCode:l.status};if(l.status>=200&&l.status<300){var q;q=g.binary?cp([l.response||""],{type:l.getResponseHeader("Content-Type")}):l.responseText,i(null,s,q)}else{var p={};if(m){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(l.response)}catch(r){}}i(p,s)}}},g.body&&g.body instanceof Blob?fK(g.body,function(p){l.send(p)}):l.send(g.body),{abort:n}}function eS(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function jQ(h,g){return ax||h.xhr?f0(h,g):kk(h,g)}function ep(){return""}function ad(k,i){function h(l,o,m){if(!k.binary&&k.json&&"string"==typeof l){try{l=JSON.parse(l)}catch(n){return m(n)}}Array.isArray(l)&&(l=l.map(function(p){return p.error||p.missing?dX(p):p})),k.binary&&aF(l,o),m(null,l,o)}function j(m,q){var o,l;if(m.code&&m.status){var n=new Error(m.message||m.code);return n.status=m.status,q(n)}if(m.message&&"ETIMEDOUT"===m.message){return q(m)}try{o=JSON.parse(m.responseText),l=dX(o)}catch(p){l=dX(m)}q(l)}k=dC(k);var g={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return k=d0.extend(g,k),k.json&&(k.binary||(k.headers.Accept="application/json"),k.headers["Content-Type"]=k.headers["Content-Type"]||"application/json"),k.binary&&(k.encoding=null,k.json=!1),k.processData||(k.json=!1),jQ(k,function(m,q,o){if(m){return m.status=q?q.statusCode:400,j(m,i)}var r,p=q.headers&&q.headers["content-type"],n=o||ep();if(!k.binary&&(k.json||!k.processData)&&"object"!=typeof n&&(/json/.test(p)||/^[\s]*\{/.test(n)&&/\}[\s]*$/.test(n))){try{n=JSON.parse(n.toString())}catch(l){}}q.statusCode>=200&&q.statusCode<300?h(n,q,i):(r=dX(n),r.status=q.statusCode,i(r))})}function dD(i,k){var g=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m=-1!==g.indexOf("safari")&&-1===g.indexOf("chrome"),o=-1!==g.indexOf("msie"),h=-1!==g.indexOf("edge"),j=m||(o||h)&&"GET"===i.method,l="cache" in i?i.cache:!0,p=/^blob:/.test(i.url);if(!p&&(j||!l)){var n=-1!==i.url.indexOf("?");i.url+=(n?"&":"?")+"_nonce="+Date.now()}return ad(i,k)}function eL(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=dz(j.data,j.content_type)})}function ki(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function bV(g){return g._attachments&&Object.keys(g._attachments)?cz.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new cz(function(j){bB(i.data,j)}).then(function(j){i.data=j}):void 0})):cz.resolve()}function cj(i){var h=bc(i);(h.user||h.password)&&(h.auth={username:h.user,password:h.password});var g=h.path.replace(/(^\/|\/$)/g,"").split("/");return h.db=g.pop(),-1===h.db.indexOf("%")&&(h.db=encodeURIComponent(h.db)),h.path=g.join("/"),h}function cb(h,g){return fP(h,h.db+"/"+g)}function fP(i,h){var g=i.path?"/":"";return i.protocol+"://"+i.host+(i.port?":"+i.port:"")+"/"+i.path+g+h}function aY(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function eI(j,o){function w(A,y,B){var z=A.ajax||{},x=d0.extend(dC(q),z,y);return b3(x.method+" "+x.url),k._ajax(x,B)}function p(x,y){return new cz(function(z,A){w(x,y,function(C,B){return C?A(C):void z(B)})})}function h(x,y){return fD(x,by(function(z){v().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function v(){if(j.skipSetup||j.skip_setup){return cz.resolve()}if(i){return i}var x={method:"GET",url:u};return i=p({},x)["catch"](function(y){return y&&y.status&&404===y.status?(bS(404,"PouchDB is just detecting if the remote exists."),p({},{method:"PUT",url:u})):cz.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:cz.reject(y)}),i["catch"](function(){i=null}),i}function g(x){return x.split("/").map(encodeURIComponent).join("/")}var k=this,s=cj;j.getHost&&(s=j.getHost);var m=s(j.name,j),u=cb(m,"");j=dC(j);var q=j.ajax||{};if(k.getUrl=function(){return u},k.getHeaders=function(){return q.headers||{}},j.auth||m.auth){var r=j.auth||m.auth,n=r.username+":"+r.password,l=cD(unescape(encodeURIComponent(n)));q.headers=q.headers||{},q.headers.Authorization="Basic "+l}k._ajax=dD;var i;setTimeout(function(){o(null,k)}),k.type=function(){return"http"},k.id=h("id",function(x){w({},{method:"GET",url:fP(m,"")},function(y,A){var z=A&&A.uuid?A.uuid+m.db:cb(m,"");x(null,z)})}),k.request=h("request",function(x,y){x.url=cb(m,x.url),w({},x,y)}),k.compact=h("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=dC(x),w(x,{url:cb(m,"_compact"),method:"POST"},function(){function z(){k.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),k.bulkGet=fD("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),w({},{url:cb(m,"_bulk_get"+aY(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function G(L){return function(M,N){J[L]=N.results,++H===E&&C(null,{results:eh(J)})}}for(var K=az,E=Math.ceil(y.docs.length/K),H=0,J=new Array(E),I=0;E>I;I++){var F=f5(y,["revs","attachments"]);F.ajax=q,F.docs=y.docs.slice(I*K,Math.min(y.docs.length,(I+1)*K)),eB(z,F,G(I))}}var z=this,D=fP(m,""),x=jS[D];"boolean"!=typeof x?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(jS[D]=!1,bS(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{jS[D]=!0,C(null,F)}}):x?A(C):B()}),k._info=function(x){v().then(function(){w({},{method:"GET",url:cb(m,"")},function(y,z){return y?x(y):(z.host=cb(m,""),void x(null,z))})})["catch"](x)},k.get=h("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?cz.all(E.map(function(I){var J=G[I],H=ki(F._id)+"/"+g(I)+"?rev="+F._rev;return p(y,{method:"GET",url:cb(m,H),binary:!0}).then(function(K){return y.binary?K:new cz(function(L){bB(K,L)})}).then(function(K){delete J.stub,delete J.length,J.data=K})})):void 0}function z(E){return Array.isArray(E)?cz.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=dC(y);var x={};y.revs&&(x.revs=!0),y.revs_info&&(x.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),x.open_revs=y.open_revs),y.rev&&(x.rev=y.rev),y.conflicts&&(x.conflicts=y.conflicts),C=ki(C);var D={method:"GET",url:cb(m,C+aY(x))};p(y,D).then(function(E){return cz.resolve().then(function(){return y.attachments?z(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),k.remove=h("remove",function(B,z,x,C){var y;"string"==typeof z?(y={_id:B,_rev:z},"function"==typeof x&&(C=x,x={})):(y=B,"function"==typeof z?(C=z,x={}):(C=x,x=z));var A=y._rev||x.rev;w(x,{method:"DELETE",url:cb(m,ki(y._id))+"?rev="+A},C)}),k.getAttachment=h("getAttachment",function(B,x,z,y){"function"==typeof z&&(y=z,z={});var A=z.rev?"?rev="+z.rev:"",C=cb(m,ki(B))+"/"+g(x)+A;w(z,{method:"GET",url:C,binary:!0},y)}),k.removeAttachment=h("removeAttachment",function(A,y,z,B){var x=cb(m,ki(A)+"/"+g(y))+"?rev="+z;w({},{method:"DELETE",url:x},B)}),k.putAttachment=h("putAttachment",function(y,C,E,F,H,D){"function"==typeof H&&(D=H,H=F,F=E,E=null);var B=ki(y)+"/"+g(C),A=cb(m,B);if(E&&(A+="?rev="+E),"string"==typeof F){var G;try{G=f1(F)}catch(z){return D(av(bW,"Attachment is not a valid base64 string"))}F=G?eR(G,H):""}var x={headers:{"Content-Type":H},method:"PUT",url:A,processData:!1,body:F,timeout:q.timeout||60000};w({},x,D)}),k._bulkDocs=function(z,x,y){z.new_edits=x.new_edits,v().then(function(){return cz.all(z.docs.map(bV))}).then(function(){w(x,{method:"POST",url:cb(m,"_bulk_docs"),body:z},function(B,A){return B?y(B):(A.forEach(function(C){C.ok=!0}),void y(null,A))})})["catch"](y)},k.allDocs=h("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=dC(C);var A,B={},z="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var D=aY(B);if("undefined"!=typeof C.keys){var x="keys="+encodeURIComponent(JSON.stringify(C.keys));x.length+D.length+1<=j5?D+="&"+x:(z="POST",A={keys:C.keys})}p(C,{method:z,url:cb(m,"_all_docs"+D),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eL),y(null,E)})["catch"](y)}),k._changes=function(B){var J="batch_size" in B?B.batch_size:bT;B=dC(B),B.timeout="timeout" in B?B.timeout:"timeout" in q?q.timeout:30000;var H,A=B.timeout?{timeout:B.timeout-5000}:{},D="undefined"!=typeof B.limit?B.limit:!1;H="return_docs" in B?B.return_docs:"returnDocs" in B?B.returnDocs:!0;var L=D;if(B.style&&(A.style=B.style),(B.include_docs||B.filter&&"function"==typeof B.filter)&&(A.include_docs=!0),B.attachments&&(A.attachments=!0),B.continuous&&(A.feed="longpoll"),B.conflicts&&(A.conflicts=!0),B.descending&&(A.descending=!0),"heartbeat" in B?B.heartbeat&&(A.heartbeat=B.heartbeat):A.heartbeat=10000,B.filter&&"string"==typeof B.filter&&(A.filter=B.filter),B.view&&"string"==typeof B.view&&(A.filter="_view",A.view=B.view),B.query_params&&"object"==typeof B.query_params){for(var F in B.query_params){B.query_params.hasOwnProperty(F)&&(A[F]=B.query_params[F])}}var y,z="GET";if(B.doc_ids){A.filter="_doc_ids";var K=JSON.stringify(B.doc_ids);K.length<j5?A.doc_ids=K:(z="POST",y={doc_ids:B.doc_ids})}var x,I,G=function(N,M){if(!B.aborted){A.since=N,"object"==typeof A.since&&(A.since=JSON.stringify(A.since)),B.descending?D&&(A.limit=L):A.limit=!D||L>J?J:L;var O={method:z,url:cb(m,"_changes"+aY(A)),timeout:B.timeout,body:y};I=N,B.aborted||v().then(function(){x=w(B,O,M)})["catch"](M)}},E={results:[]},C=function(O,Q){if(!B.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,E.last_seq=Q.last_seq;var M={};M.query=B.query_params,Q.results=Q.results.filter(function(R){L--;var S=aD(B)(R);return S&&(B.include_docs&&B.attachments&&B.binary&&eL(R),H&&E.results.push(R),B.onChange(R)),S})}else{if(O){return B.aborted=!0,void B.complete(O)}}Q&&Q.last_seq&&(I=Q.last_seq);var N=D&&0>=L||Q&&J>P||B.descending;(!B.continuous||D&&0>=L)&&N?B.complete(null,E):setTimeout(function(){G(I,C)},0)}};return G(B.since||0,C),{cancel:function(){B.aborted=!0,x&&x.abort()}}},k.revsDiff=h("revsDiff",function(z,x,y){"function"==typeof x&&(y=x,x={}),w(x,{method:"POST",url:cb(m,"_revs_diff"),body:z},y)}),k._close=function(x){x()},k._destroy=function(x,y){w(x,{url:cb(m,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function jF(g){g.adapter("http",eI,!1),g.adapter("https",eI,!1)}function bU(){this.promise=new cz(function(g){g()})}function cF(g){var h=g.db,m=g.viewName,i=g.map,k=g.reduce,l=g.temporary,j=i.toString()+(k&&k.toString())+"undefined";if(!l&&h._cachedViews){var n=h._cachedViews[j];if(n){return cz.resolve(n)}}return h.info().then(function(p){function o(u){u.views=u.views||{};var r=m;-1===r.indexOf("/")&&(r=m+"/"+m);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(l?"temp":jG(j));return j8(h,"_local/mrviews",o).then(function(){return h.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:h,adapter:h.adapter,mapFun:i,reduceFun:k};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,l||(h._cachedViews=h._cachedViews||{},h._cachedViews[j]=r,r.db.once("destroyed",function(){delete h._cachedViews[j]})),r})})})})}function eV(l,j,i,k,h,g){return aC("return ("+l.replace(/;\s*$/,"")+");",{emit:j,sum:i,log:k,isArray:h,toJSON:g})}function fN(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function eT(g){return 1===g.length&&/^1-/.test(g[0].rev)}function dI(i,h){try{i.emit("error",h)}catch(g){bJ("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),bJ("error",h)}}function eq(i,g,j){try{return{output:g.apply(null,j)}}catch(h){return dI(i,h),{error:h}}}function km(i,h){var g=bz.collate(i.key,h.key);return 0!==g?g:bz.collate(i.value,h.value)}function bO(i,h,g){return g=g||0,"number"==typeof h?i.slice(g,h+g):g>0?i.slice(g):i}function kg(i){var h=i.value,g=h&&"object"==typeof h&&h._id||i.id;return g}function e2(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=dz(k.data,k.content_type)})})}function j3(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&e2(h),h}}function jI(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new j9(g)}function fQ(g){for(var h=0,m=0,i=g.length;i>m;m++){var k=g[m];if("number"!=typeof k){if(!Array.isArray(k)){throw jI("_sum")}h="number"==typeof h?[h]:h;for(var l=0,j=k.length;j>l;l++){var n=k[l];if("number"!=typeof n){throw jI("_sum")}"undefined"==typeof h[l]?h.push(n):h[l]+=n}}else{"number"==typeof h?h+=k:h[0]+=k}}return h}function jP(k,i,h,j){var g=i[k];"undefined"!=typeof g&&(j&&(g=encodeURIComponent(JSON.stringify(g))),h.push(k+"="+g))}function kj(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function f9(g){return g.group_level=kj(g.group_level),g.limit=kj(g.limit),g.skip=kj(g.skip),g}function cc(g){if(g){if("number"!=typeof g){return new em('Invalid value for integer: "'+g+'"')}if(0>g){return new em('Invalid value for positive integer: "'+g+'"')}}}function ef(i,g){var j=i.descending?"endkey":"startkey",h=i.descending?"startkey":"endkey";if("undefined"!=typeof i[j]&&"undefined"!=typeof i[h]&&bz.collate(i[j],i[h])>0){throw new em("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(g.reduce&&i.reduce!==!1){if(i.include_docs){throw new em("{include_docs:true} is invalid for reduce")}if(i.keys&&i.keys.length>1&&!i.group&&!i.group_level){throw new em("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=cc(i[k]);if(l){throw l}})}function kb(g,i,l){var j,m=[],n="GET";if(jP("reduce",l,m),jP("include_docs",l,m),jP("attachments",l,m),jP("limit",l,m),jP("descending",l,m),jP("group",l,m),jP("group_level",l,m),jP("skip",l,m),jP("stale",l,m),jP("conflicts",l,m),jP("startkey",l,m,!0),jP("start_key",l,m,!0),jP("endkey",l,m,!0),jP("end_key",l,m,!0),jP("inclusive_end",l,m),jP("key",l,m,!0),m=m.join("&"),m=""===m?"":"?"+m,"undefined"!=typeof l.keys){var h=2000,k="keys="+encodeURIComponent(JSON.stringify(l.keys));k.length+m.length+1<=h?m+=("?"===m[0]?"&":"?")+k:(n="POST","string"==typeof i?j={keys:l.keys}:i.keys=l.keys)}if("string"==typeof i){var o=fN(i);return g.request({method:n,url:"_design/"+o[0]+"/_view/"+o[1]+m,body:j}).then(j3(l))}return j=j||{},Object.keys(i).forEach(function(p){Array.isArray(i[p])?j[p]=i[p]:j[p]=i[p].toString()}),g.request({method:"POST",url:"_temp_view"+m,body:j}).then(j3(l))}function kl(i,h,g){return new cz(function(j,k){i._query(h,g,function(m,l){return m?k(m):void j(l)})})}function ac(g){return new cz(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function eN(g){return function(h){if(404===h.status){return g}throw h}}function f6(k,p,j){function h(){return eT(q)?cz.resolve(n):p.db.get(l)["catch"](eN(n))}function g(r){return r.keys.length?p.db.allDocs({keys:r.keys,include_docs:!0}):cz.resolve({rows:[]})}function i(v,x){for(var B=[],y={},A=0,r=x.rows.length;r>A;A++){var u=x.rows[A],z=u.doc;if(z&&(B.push(z),y[z._id]=!0,z._deleted=!o[z._id],!z._deleted)){var w=o[z._id];"value" in w&&(z.value=w.value)}}var s=Object.keys(o);return s.forEach(function(C){if(!y[C]){var E={_id:C},D=o[C];"value" in D&&(E.value=D.value),B.push(E)}}),v.keys=aN(s.concat(v.keys)),B.push(v),B}var l="_local/doc_"+k,n={_id:l,keys:[]},m=j[k],o=m.indexableKeysToKeyValues,q=m.changes;return h().then(function(r){return g(r).then(function(s){return i(r,s)})})}function eF(i,g,j){var h="_local/lastSeq";return i.db.get(h)["catch"](eN({_id:h,seq:0})).then(function(k){var l=Object.keys(g);return cz.all(l.map(function(m){return f6(m,i,g)})).then(function(m){var n=eh(m);return k.seq=j,n.push(k),i.db.bulkDocs({docs:n})})})}function jU(i){var h="string"==typeof i?i:i.name,g=bx[h];return g||(g=bx[h]=new bU),g}function jX(g){return cT(jU(g),function(){return dR(g)})()}function dR(g){function i(p,r){var q={id:m._id,key:bz.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=bz.normalizeKey(r)),j.push(q)}function l(q,p){return function(){return eF(g,q,p)}}var j,m,n;if("function"==typeof g.mapFun&&2===g.mapFun.length){var h=g.mapFun;n=function(p){return h(p,i)}}else{n=eV(g.mapFun.toString(),i,fQ,bj,Array.isArray,JSON.parse)}var k=g.seq||0,o=new bU;return new cz(function(p,s){function r(){o.finish().then(function(){g.seq=k,p()})}function q(){function u(v){s(v)}g.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:k,limit:ak}).on("complete",function(A){var v=A.results;if(!v.length){return r()}for(var D={},F=0,C=v.length;C>F;F++){var x=v[F];if("_"!==x.doc._id[0]){j=[],m=x.doc,m._deleted||eq(g.sourceDB,n,[m]),j.sort(km);for(var z,H={},w=0,B=j.length;B>w;w++){var E=j[w],G=[E.key,E.id];0===bz.collate(E.key,z)&&G.push(w);var y=bz.toIndexableString(G);H[y]=E,z=E.key}D[x.doc._id]={indexableKeysToKeyValues:H,changes:x.changes}}k=x.seq}return o.add(l(D,k)),v.length<ak?r():q()}).on("error",u)}q()})}function ah(k,p,j){0===j.group_level&&delete j.group_level;var h,g=j.group||j.group_level;h=cg[k.reduceFun]?cg[k.reduceFun]:eV(k.reduceFun.toString(),null,fQ,bj,Array.isArray,JSON.parse);var i=[],l=isNaN(j.group_level)?Number.POSITIVE_INFINITY:j.group_level;p.forEach(function(r){var u=i[i.length-1],s=g?r.key:null;return g&&Array.isArray(s)&&(s=s.slice(0,l)),u&&0===bz.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void i.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),p=[];for(var n=0,m=i.length;m>n;n++){var o=i[n],q=eq(k.sourceDB,h,[o.keys,o.values,!1]);if(q.error&&q.error instanceof j9){throw q.error}p.push({value:q.error?null:q.output,key:o.groupKey})}return{rows:bO(p,j.limit,j.skip)}}function eJ(h,g){return cT(jU(h),function(){return bv(h,g)})()}function bv(r,s){function i(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return h=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=bz.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function g(v){var u;if(u=k?ah(r,v,s):{total_rows:h,offset:p,rows:v},s.include_docs){var w=aN(v.map(kg));return r.sourceDB.allDocs({keys:w,include_docs:!0,conflicts:s.conflicts,attachments:s.attachments,binary:s.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),v.forEach(function(A){var B=kg(A),z=y["$"+B];z&&(A.doc=z)}),u})}return u}var h,k=r.reduceFun&&s.reduce!==!1,p=s.skip||0;if("undefined"==typeof s.keys||s.keys.length||(s.limit=0,delete s.keys),"undefined"!=typeof s.keys){var l=s.keys,q=l.map(function(v){var u={startkey:bz.toIndexableString([v]),endkey:bz.toIndexableString([v,{}])};return i(u)});return cz.all(q).then(eh).then(g)}var o={descending:s.descending};if(s.start_key&&(s.startkey=s.start_key),s.end_key&&(s.endkey=s.end_key),"undefined"!=typeof s.startkey&&(o.startkey=s.descending?bz.toIndexableString([s.startkey,{}]):bz.toIndexableString([s.startkey])),"undefined"!=typeof s.endkey){var m=s.inclusive_end!==!1;s.descending&&(m=!m),o.endkey=bz.toIndexableString(m?[s.endkey,{}]:[s.endkey])}if("undefined"!=typeof s.key){var j=bz.toIndexableString([s.key]),n=bz.toIndexableString([s.key,{}]);o.descending?(o.endkey=j,o.startkey=n):(o.startkey=j,o.endkey=n)}return k||("number"==typeof s.limit&&(o.limit=s.limit),o.skip=p),i(o).then(g)}function jO(g){return g.request({method:"POST",url:"_view_cleanup"})}function bQ(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(m){var k=fN(m),l="_design/"+k[0],n=k[1];j[l]=j[l]||{},j[l][n]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(m){var n={};m.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){n[v]=n[v]||s})})});var l=Object.keys(n).filter(function(o){return !n[o]}),k=l.map(function(o){return cT(jU(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return cz.all(k).then(function(){return{ok:!0}})})},eN({ok:!0}))}function kh(k,n,g){if("http"===k.type()){return kb(k,n,g)}if("function"==typeof k._query){return kl(k,n,g)}if("string"!=typeof n){ef(g,n);var m={db:k,viewName:"temp_view/temp_view",map:n.map,reduce:n.reduce,temporary:!0};return jK.add(function(){return cF(m).then(function(o){function p(){return o.db.destroy()}return bN(jX(o).then(function(){return eJ(o,g)}),p)})}),jK.finish()}var h=n,j=fN(h),i=j[0],l=j[1];return k.get("_design/"+i).then(function(o){var p=o.views&&o.views[l];if(!p||"string"!=typeof p.map){throw new cl("ddoc "+i+" has no view named "+l)}ef(g,p);var q={db:k,viewName:h,map:p.map,reduce:p.reduce};return cF(q).then(function(r){return"ok"===g.stale||"update_after"===g.stale?("update_after"===g.stale&&c1.nextTick(function(){jX(r)}),eJ(r,g)):jX(r).then(function(){return eJ(r,g)})})})}function em(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,em)}catch(g){}}function cl(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,cl)}catch(g){}}function j9(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,j9)}catch(g){}}function cx(g){return/^1-/.test(g)}function j2(i,h,g){return !i._attachments||!i._attachments[g]||i._attachments[g].digest!==h._attachments[g].digest}function dq(i,h){var g=Object.keys(h._attachments);return cz.all(g.map(function(j){return i.getAttachment(h._id,j,{rev:h._rev})}))}function fR(k,i,h){var j="http"===i.type()&&"http"!==k.type(),g=Object.keys(h._attachments);return j?k.get(h._id).then(function(l){return cz.all(g.map(function(m){return j2(l,h,m)?i.getAttachment(h._id,m):k.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return dq(i,h)}):dq(i,h)}function cC(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function dU(j,n,i,g){function h(){var r=cC(i);if(r.docs.length){return j.bulkGet(r).then(function(s){if(g.cancelled){throw new Error("cancelled")}return cz.all(s.results.map(function(u){return cz.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?fR(n,j,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){o=o.concat(eh(u).filter(Boolean))})})}}function k(r){return r._attachments&&Object.keys(r._attachments).length>0}function l(r){return j.allDocs({keys:r,include_docs:!0}).then(function(s){if(g.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&cx(u.value.rev)&&!k(u.doc)&&(o.push(u.doc),delete i[u.id])})})}function p(){var r=Object.keys(i).filter(function(s){var u=i[s].missing;return 1===u.length&&cx(u[0])});return r.length>0?l(r):void 0}function m(){return{ok:q,docs:o}}i=dC(i);var o=[],q=!0;return cz.resolve().then(p).then(h).then(m)}function jH(k,i,h,j,g){return k.get(i)["catch"](function(l){if(404===l.status){return"http"===k.type()&&bS(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:j,_id:i,history:[],replicator:dK,version:dx}}throw l}).then(function(l){return g.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==j}),l.history.unshift({last_seq:h,session_id:j}),l.history=l.history.slice(0,bp),l.version=dx,l.replicator=dK,l.session_id=j,l.last_seq=h,k.put(l)["catch"](function(m){if(409===m.status){return jH(k,i,h,j,g)}throw m}))})}function eD(i,g,j,h){this.src=i,this.target=g,this.id=j,this.returnValue=h}function dm(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:fL(h.history,g.history)}function fL(g,h){var m=g[0],i=g.slice(1),k=h[0],l=h.slice(1);if(!m||0===h.length){return{last_seq:b0,history:[]}}var j=m.session_id;if(c0(j,h)){return{last_seq:m.last_seq,history:g}}var n=k.session_id;return c0(n,i)?{last_seq:k.last_seq,history:l}:fL(i,l)}function c0(i,g){var j=g[0],h=g.slice(1);return i&&0!==g.length?i===j.session_id?!0:c0(i,h):!1}function da(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function ec(i,g,j,h){return i.retry===!1?(g.emit("error",j),void g.removeAllListeners()):("function"!=typeof i.back_off_function&&(i.back_off_function=eO),g.emit("requestError",j),"active"!==g.state&&"pending"!==g.state||(g.emit("paused",j),g.state="stopped",g.once("active",function(){i.current_back_off=d9})),i.current_back_off=i.current_back_off||d9,i.current_back_off=i.back_off_function(i.current_back_off),void setTimeout(h,i.current_back_off))}function dN(g){return Object.keys(g).sort(bz.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function dS(i,l,g){var m=g.doc_ids?g.doc_ids.sort(bz.collate):"",j=g.filter?g.filter.toString():"",k="",h="";return g.filter&&g.query_params&&(k=JSON.stringify(dN(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),cz.all([i.id(),l.id()]).then(function(n){var o=n[0]+n[1]+j+h+k+m;return new cz(function(p){jW(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function dc(r,B,N,I,M){function h(){return n?cz.resolve():dS(r,B,N).then(function(T){z=T,n=new eD(r,B,z,I)})}function H(){if(F=[],0!==p.docs.length){var T=p.docs;return B.bulkDocs({docs:T,new_edits:!1}).then(function(Y){if(I.cancelled){throw L(),new Error("cancelled")}var V=[],X={};Y.forEach(function(Z){Z.error&&(M.doc_write_failures++,V.push(Z),X[Z.id]=Z)}),q=q.concat(V),M.docs_written+=p.docs.length-V.length;var W=V.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=X[Z._id];ae?I.emit("denied",dC(ae)):F.push(Z)}),W.length>0){var U=new Error("bulkDocs error");throw U.other_errors=V,i("target.bulkDocs failed to write docs",U),new Error("bulkWrite partial failure")}},function(U){throw M.doc_write_failures+=T.length,U})}}function C(){if(p.error){throw new Error("There was a problem getting docs.")}M.last_seq=g=p.seq;var T=dC(M);return F.length&&(T.docs=F,I.emit("change",T)),k=!0,n.writeCheckpoint(p.seq,s).then(function(){if(k=!1,I.cancelled){throw L(),new Error("cancelled")}p=void 0,P()})["catch"](A)}function v(){var T={};return p.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),B.revsDiff(T).then(function(U){if(I.cancelled){throw L(),new Error("cancelled")}p.diffs=U})}function m(){return dU(r,B,p.diffs,I).then(function(T){p.error=!T.ok,T.docs.forEach(function(U){delete p.diffs[U._id],M.docs_read++,p.docs.push(U)})})}function Q(){if(!I.cancelled&&!p){if(0===R.length){return void x(!0)}p=R.shift(),v().then(m).then(H).then(C).then(Q)["catch"](function(T){i("batch processing terminated with error",T)})}}function x(T){return 0===K.changes.length?void (0!==R.length||p||((E&&O.live||G)&&(I.state="pending",I.emit("paused")),G&&L())):void ((T||G||K.changes.length>=w)&&(R.push(K),K={seq:0,changes:[],docs:[]},"pending"!==I.state&&"stopped"!==I.state||(I.state="active",I.emit("active")),Q()))}function i(U,T){l||(T.message||(T.message=U),M.ok=!1,M.status="aborting",M.errors.push(T),q=q.concat(T),R=[],K={seq:0,changes:[],docs:[]},L())}function L(){if(!(l||I.cancelled&&(M.status="cancelled",k))){M.status=M.status||"complete",M.end_time=new Date,M.last_seq=g,l=!0;var U=q.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=q.pop();q.length>0&&(T.other_errors=q),T.result=M,ec(N,I,T,function(){dc(r,B,N,I)})}else{M.errors=q,I.emit("complete",M),I.removeAllListeners()}}}function u(U){if(I.cancelled){return L()}var T=aD(N)(U);T&&(K.seq=U.seq,K.changes.push(U),x(0===R.length&&O.live))}function S(U){if(D=!1,I.cancelled){return L()}if(U.results.length>0){O.since=U.last_seq,P(),x(!0)}else{var T=function(){E?(O.live=!0,P()):G=!0,x(!0)};p||0!==U.results.length?T():(k=!0,n.writeCheckpoint(U.last_seq,s).then(function(){k=!1,M.last_seq=g=U.last_seq,T()})["catch"](A))}}function J(T){return D=!1,I.cancelled?L():void i("changes rejected",T)}function P(){function V(){U.cancel()}function T(){I.removeListener("cancel",V)}if(!D&&!G&&R.length<y){D=!0,I._changes&&(I.removeListener("cancel",I._abortChanges),I._changes.cancel()),I.once("cancel",V);var U=r.changes(O).on("change",u);U.then(T,T),U.then(S)["catch"](J),N.retry&&(I._changes=U,I._abortChanges=V)}}function j(){h().then(function(){return I.cancelled?void L():n.getCheckpoint().then(function(T){g=T,O={since:g,limit:w,batch_size:w,style:"all_docs",doc_ids:o,return_docs:!0},N.filter&&("string"!=typeof N.filter?O.include_docs=!0:O.filter=N.filter),"heartbeat" in N&&(O.heartbeat=N.heartbeat),"timeout" in N&&(O.timeout=N.timeout),N.query_params&&(O.query_params=N.query_params),N.view&&(O.view=N.view),P()})})["catch"](function(T){i("getCheckpoint rejected with ",T)})}function A(T){throw k=!1,i("writeCheckpoint completed with error",T),T}var p,z,n,R=[],K={seq:0,changes:[],docs:[]},k=!1,G=!1,l=!1,g=0,E=N.continuous||N.live||!1,w=N.batch_size||100,y=N.batches_limit||10,D=!1,o=N.doc_ids,q=[],F=[],s=eM();M=M||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var O={};return I.ready(r,B),I.cancelled?void L():(I._addedListeners||(I.once("cancel",L),"function"==typeof N.complete&&(I.once("error",N.complete),I.once("complete",function(T){N.complete(null,T)})),I._addedListeners=!0),void ("undefined"==typeof N.since?j():h().then(function(){return k=!0,n.writeCheckpoint(N.since,s)}).then(function(){return k=!1,I.cancelled?void L():(g=N.since,void j())})["catch"](A)))}function e9(){aZ.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new cz(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function b9(i,h){var g=h.PouchConstructor;return"string"==typeof i?new g(i,h):i}function c8(i,l,g,m){if("function"==typeof g&&(m=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw av(eP,"`doc_ids` filter parameter is not a list.")}g.complete=m,g=dC(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var j=new e9(g),k=b9(i,g),h=b9(l,g);return dc(k,h,g,j),j}function b6(i,g,j,h){return"function"==typeof j&&(h=j,j={}),"undefined"==typeof j&&(j={}),j=dC(j),j.PouchConstructor=j.PouchConstructor||this,i=b9(i,j),g=b9(g,j),new cf(i,g,j,h)}function cf(m,u,v,o){function s(z){k.emit("change",{direction:"pull",change:z})}function y(z){k.emit("change",{direction:"push",change:z})}function r(z){k.emit("denied",{direction:"push",doc:z})}function w(z){k.emit("denied",{direction:"pull",doc:z})}function i(){k.pushPaused=!0,k.pullPaused&&k.emit("paused")}function p(){k.pullPaused=!0,k.pushPaused&&k.emit("paused")}function l(){k.pushPaused=!1,k.pullPaused&&k.emit("active",{direction:"push"})}function x(){k.pullPaused=!1,k.pushPaused&&k.emit("active",{direction:"pull"})}function n(z){return function(D,A){var B="change"===D&&(A===s||A===y),F="denied"===D&&(A===w||A===r),C="paused"===D&&(A===p||A===i),E="active"===D&&(A===x||A===l);(B||F||C||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&k.removeAllListeners(D))}}var k=this;this.canceled=!1;var q=v.push?d0.extend({},v,v.push):v,h=v.pull?d0.extend({},v,v.pull):v;this.push=c8(m,u,q),this.pull=c8(u,m,h),this.pushPaused=!0,this.pullPaused=!0;var g={};v.live&&(this.push.on("complete",k.pull.cancel.bind(k.pull)),this.pull.on("complete",k.push.cancel.bind(k.push))),this.on("newListener",function(z){"change"===z?(k.pull.on("change",s),k.push.on("change",y)):"denied"===z?(k.pull.on("denied",w),k.push.on("denied",r)):"active"===z?(k.pull.on("active",x),k.push.on("active",l)):"paused"===z&&(k.pull.on("paused",p),k.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(k.pull.removeListener("change",s),k.push.removeListener("change",y)):"denied"===z?(k.pull.removeListener("denied",w),k.push.removeListener("denied",r)):"active"===z?(k.pull.removeListener("active",x),k.push.removeListener("active",l)):"paused"===z&&(k.pull.removeListener("paused",p),k.push.removeListener("paused",i))}),this.pull.on("removeListener",n("pull")),this.push.on("removeListener",n("push"));var j=cz.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return k.emit("complete",z),o&&o(null,z),k.removeAllListeners(),z},function(z){if(k.cancel(),o?o(z):k.emit("error",z),k.removeAllListeners(),o){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function au(g){g.replicate=c8,g.sync=b6}var fO,d0=c(9),b2=eK(c(5)),ca=eK(c(8)),d5=eK(c(10)),bm=c(14),by=eK(c(4)),aZ=c(1),aC=eK(c(15)),cS=eK(c(16)),aX=eK(c(17)),bz=c(12),cz="function"==typeof Promise?Promise:d5,fC=Function.prototype.toString,dO=fC.call(Object),aK=b2("pouchdb:api"),cY=6;if(ap()){fO=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),fO=!!localStorage.getItem("_pouch_check_localstorage")}catch(c6){fO=!1}}ca(e4,aZ.EventEmitter),e4.prototype.addListener=function(i,l,g,m){function j(){function n(){h=!1}if(k._listeners[l]){if(h){return void (h="waiting")}h=!0;var o=f5(m,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>m.since&&!m.cancelled&&(m.since=p.seq,m.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){j()},0),h=!1}).on("error",n)}}if(!this._listeners[l]){var k=this,h=!1;this._listeners[l]=j,this.on(i,j)}},e4.prototype.removeListener=function(h,g){g in this._listeners&&aZ.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},e4.prototype.notifyLocalWindows=function(g){ap()?chrome.storage.local.set({dbName:g}):dd()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},e4.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},ca(d2,Error),d2.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var d4=new d2({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),cJ=new d2({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),bb=new d2({status:404,error:"not_found",reason:"missing"}),dF=new d2({status:409,error:"conflict",reason:"Document update conflict"}),cL=new d2({status:400,error:"invalid_id",reason:"_id field must contain a string"}),eH=new d2({status:412,error:"missing_id",reason:"_id is required for puts"}),dw=new d2({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),ba=new d2({status:412,error:"precondition_failed",reason:"Database not open"}),eW=new d2({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),bW=new d2({status:500,error:"badarg",reason:"Some query argument is invalid"}),bw=new d2({status:400,error:"invalid_request",reason:"Request was invalid"}),cs=new d2({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),eZ=new d2({status:500,error:"doc_validation",reason:"Bad special document member"}),eP=new d2({status:400,error:"bad_request",reason:"Something wrong with the request"}),dJ=new d2({status:400,error:"bad_request",reason:"Document must be a JSON object"}),d6=new d2({status:404,error:"not_found",reason:"Database not found"}),e6=new d2({status:500,error:"indexed_db_went_bad",reason:"unknown"}),dP=new d2({status:500,error:"web_sql_went_bad",reason:"unknown"}),jR=new d2({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),bF=new d2({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),c2=new d2({status:400,error:"bad_request",reason:"Invalid rev format"}),fG=new d2({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),bA=new d2({status:412,error:"missing_stub"}),eQ=new d2({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cu=[d4,cJ,bb,dF,cL,eH,dw,ba,eW,bW,bw,cs,eZ,eP,dJ,d6,dP,jR,bF,c2,fG,bA,e6,eQ],dV=function(i,g,j){var h=cu.filter(function(k){return k[i]===g});return j&&h.filter(function(k){return k.message===j})[0]||h[0]},kd=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],d1="queryKey",f7=/(?:^|&)([^&=]*)=?([^&]*)/g,fI=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,df="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");ca(fH,aZ.EventEmitter),fH.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},fH.prototype.doChanges=function(k){var i=this,h=k.complete;if(k=dC(k),"live" in k&&!("continuous" in k)&&(k.continuous=k.live),k.processChange=bC,"latest"===k.since&&(k.since="now"),k.since||(k.since=0),"now"===k.since){return void this.db.info().then(function(l){return i.isCancelled?void h(null,{status:"cancelled"}):(k.since=l.update_seq,void i.doChanges(k))},h)}if(k.continuous&&"now"!==k.since&&this.db.info().then(function(l){i.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),k.view&&!k.filter&&(k.filter="_view"),k.filter&&"string"==typeof k.filter&&("_view"===k.filter?k.view=e3(k.view):k.filter=e3(k.filter),"http"!==this.db.type()&&!k.doc_ids)){return this.filterChanges(k)}"descending" in k||(k.descending=!1),k.limit=0===k.limit?1:k.limit,k.complete=h;var j=this.db._changes(k);if(j&&"function"==typeof j.cancel){var g=i.cancel;i.cancel=by(function(l){j.cancel(),g.apply(this,l)})}},fH.prototype.filterChanges=function(l){var j=this,i=l.complete;if("_view"===l.filter){if(!l.view||"string"!=typeof l.view){var k=av(eP,"`view` filter parameter not found or invalid.");return i(k)}var h=aU(l.view);this.db.get("_design/"+h[0],function(n,m){if(j.isCancelled){return i(null,{status:"cancelled"})}if(n){return i(dX(n))}var o=m&&m.views&&m.views[h[1]]&&m.views[h[1]].map;return o?(l.filter=bI(o),void j.doChanges(l)):i(av(bb,m.views?"missing json key: "+h[1]:"missing json key: views"))})}else{var g=aU(l.filter);if(!g){return j.doChanges(l)}this.db.get("_design/"+g[0],function(o,m){if(j.isCancelled){return i(null,{status:"cancelled"})}if(o){return i(dX(o))}var n=m&&m.filters&&m.filters[g[1]];return n?(l.filter=c4(n),void j.doChanges(l)):i(av(bb,m&&m.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},ca(aQ,aZ.EventEmitter),aQ.prototype.post=fD("post",function(i,h,g){return"function"==typeof h&&(g=h,h={}),"object"!=typeof i||Array.isArray(i)?g(av(dJ)):void this.bulkDocs({docs:[i]},h,e8(g))}),aQ.prototype.put=fD("put",by(function(g){function i(){h||(bJ("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),h=!0)}var l,j,m,n,h=!1,k=g.shift(),o="_id" in k;if("object"!=typeof k||Array.isArray(k)){return(n=g.pop())(av(dJ))}for(;;){if(l=g.shift(),j=typeof l,"string"!==j||o?"string"!==j||!o||"_rev" in k?"object"===j?m=l:"function"===j&&(n=l):(i(),k._rev=l):(i(),k._id=l,o=!0),!g.length){break}}return m=m||{},cU(k._id),du(k._id)&&"function"==typeof this._putLocal?k._deleted?this._removeLocal(k,n):this._putLocal(k,n):void this.bulkDocs({docs:[k]},m,e8(n))})),aQ.prototype.putAttachment=fD("putAttachment",function(i,l,g,m,j){function k(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[l]={content_type:j,data:m,revpos:++n},h.put(o)}var h=this;return"function"==typeof j&&(j=m,m=g,g=null),"undefined"==typeof j&&(j=m,m=g,g=null),h.get(i).then(function(n){if(n._rev!==g){throw av(dF)}return k(n)},function(n){if(n.reason===bb.message){return k({_id:i})}throw n})}),aQ.prototype.removeAttachment=fD("removeAttachment",function(k,i,h,j){var g=this;g.get(k,function(m,l){return m?void j(m):l._rev!==h?void j(av(dF)):l._attachments?(delete l._attachments[i],0===Object.keys(l._attachments).length&&delete l._attachments,void g.put(l,j)):j()})}),aQ.prototype.remove=fD("remove",function(l,j,i,k){var h;"string"==typeof j?(h={_id:l,_rev:j},"function"==typeof i&&(k=i,i={})):(h=l,"function"==typeof j?(k=j,i={}):(k=i,i=j)),i=i||{},i.was_delete=!0;var g={_id:h._id,_rev:h._rev||i.rev};return g._deleted=!0,du(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(h,k):void this.bulkDocs({docs:[g]},i,e8(k))}),aQ.prototype.revsDiff=fD("revsDiff",function(g,h,m){function i(o,p){n.has(o)||n.set(o,{missing:[]}),n.get(o).missing.push(p)}function k(q,p){var o=g[q].slice(0);fM(p,function(r,x,w,s,v){var y=x+"-"+w,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==v.status&&i(q,y))}),o.forEach(function(r){i(q,r)})}"function"==typeof h&&(m=h,h={});var l=Object.keys(g);if(!l.length){return m(null,{})}var j=0,n=new bm.Map;l.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){n.set(o,{missing:g[o]})}else{if(q){return m(q)}k(o,p)}if(++j===l.length){var r={};return n.forEach(function(u,s){r[s]=u}),m(null,r)}})},this)}),aQ.prototype.bulkGet=fD("bulkGet",function(h,g){eB(this,h,g)}),aQ.prototype.compactDocument=fD("compactDocument",function(i,g,j){var h=this;this._getRevisionTree(i,function(l,o){if(l){return j(l)}var m=cI(o),k=[],n=[];Object.keys(m).forEach(function(p){m[p]>g&&k.push(p)}),fM(o,function(v,s,q,u,p){var r=s+"-"+q;"available"===p.status&&-1!==k.indexOf(r)&&n.push(r)}),h._doCompaction(i,n,j)})}),aQ.prototype.compact=fD("compact",function(i,h){"function"==typeof i&&(h=i,i={});var g=this;i=i||{},g._compactionQueue=g._compactionQueue||[],g._compactionQueue.push({opts:i,callback:h}),1===g._compactionQueue.length&&f8(g)}),aQ.prototype._compact=function(i,l){function g(n){h.push(j.compactDocument(n.id,0))}function m(o){var n=o.last_seq;cz.all(h).then(function(){return j8(j,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){l(null,{ok:!0})})["catch"](l)}var j=this,k={return_docs:!1,last_seq:i.last_seq||0},h=[];j.changes(k).on("change",g).on("complete",m).on("error",l)},aQ.prototype.get=fD("get",function(g,h,m){function i(){var o=[],p=k.length;return p?void k.forEach(function(q){l.get(g,{rev:q,revs:h.revs,attachments:h.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||m(null,o)})}):m(null,o)}if("function"==typeof h&&(m=h,h={}),"string"!=typeof g){return m(av(cL))}if(du(g)&&"function"==typeof this._getLocal){return this._getLocal(g,m)}var k=[],l=this;if(!h.open_revs){return this._get(g,h,function(B,C){if(B){return m(B)}var w=C.doc,p=C.metadata,x=C.ctx;if(h.conflicts){var v=dZ(p);v.length&&(w._conflicts=v)}if(aP(p,w._rev)&&(w._deleted=!0),h.revs||h.revs_info){var r=d3(p.rev_tree),A=e1(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(w._rev.split("-")[1])}),y=A.ids.map(function(D){return D.id}).indexOf(w._rev.split("-")[1])+1,u=A.ids.length-y;if(A.ids.splice(y,u),A.ids.reverse(),h.revs&&(w._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),h.revs_info){var o=A.pos+A.ids.length;w._revs_info=A.ids.map(function(D){return o--,{rev:o+"-"+D.id,status:D.opts.status}})}}if(h.attachments&&w._attachments){var q=w._attachments,s=Object.keys(q).length;if(0===s){return m(null,w)}Object.keys(q).forEach(function(D){this._getAttachment(w._id,D,q[D],{rev:w._rev,binary:h.binary,ctx:x},function(F,G){var E=w._attachments[D];E.data=G,delete E.stub,delete E.length,--s||m(null,w)})},l)}else{if(w._attachments){for(var z in w._attachments){w._attachments.hasOwnProperty(z)&&(w._attachments[z].stub=!0)}}m(null,w)}})}if("all"===h.open_revs){this._getRevisionTree(g,function(o,p){return o?m(o):(k=jY(p).map(function(q){return q.rev}),void i())})}else{if(!Array.isArray(h.open_revs)){return m(av(eW,"function_clause"))}k=h.open_revs;for(var j=0;j<k.length;j++){var n=k[j];if("string"!=typeof n||!/^\d+-/.test(n)){return m(av(c2))}}i()}}),aQ.prototype.getAttachment=fD("getAttachment",function(k,i,h,j){var g=this;h instanceof Function&&(j=h,h={}),this._get(k,h,function(m,l){return m?j(m):l.doc._attachments&&l.doc._attachments[i]?(h.ctx=l.ctx,h.binary=!0,g._getAttachment(k,i,l.doc._attachments[i],h,j),void 0):j(av(bb))})}),aQ.prototype.allDocs=fD("allDocs",function(i,h){if("function"==typeof i&&(h=i,i={}),i.skip="undefined"!=typeof i.skip?i.skip:0,i.start_key&&(i.startkey=i.start_key),i.end_key&&(i.endkey=i.end_key),"keys" in i){if(!Array.isArray(i.keys)){return h(new TypeError("options.keys must be an array"))}var g=["startkey","endkey","key"].filter(function(j){return j in i})[0];if(g){return void h(av(cs,"Query parameter `"+g+"` is not compatible with multi-get"))}if("http"!==this.type()){return j4(this,i,h)}}return this._allDocs(i,h)}),aQ.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new fH(this,h,g)},aQ.prototype.close=fD("close",function(g){return this._closed=!0,this._close(g)}),aQ.prototype.info=fD("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),aQ.prototype.id=fD("id",function(g){return this._id(g)}),aQ.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},aQ.prototype.bulkDocs=fD("bulkDocs",function(k,i,h){if("function"==typeof i&&(h=i,i={}),i=i||{},Array.isArray(k)&&(k={docs:k}),!k||!k.docs||!Array.isArray(k.docs)){return h(av(cJ))}for(var j=0;j<k.docs.length;++j){if("object"!=typeof k.docs[j]||Array.isArray(k.docs[j])){return h(av(dJ))}}var g;return k.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){g=g||bd(m)})}),g?h(av(eP,g)):("new_edits" in i||("new_edits" in k?i.new_edits=k.new_edits:i.new_edits=!0),i.new_edits||"http"===this.type()||k.docs.sort(eb),dT(k.docs),this._bulkDocs(k,i,function(m,l){return m?h(m):(i.new_edits||(l=l.filter(function(n){return n.error})),void h(null,l))}))}),aQ.prototype.registerDependentDatabase=fD("registerDependentDatabase",function(i,g){function j(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[i]?!1:(k.dependentDbs[i]=!0,k)}var h=new this.constructor(i,this.__opts);j8(this,"_local/_pouch_dependentDbs",j).then(function(){g(null,{db:h})})["catch"](g)}),aQ.prototype.destroy=fD("destroy",function(k,i){function h(){j._destroy(k,function(l,m){return l?i(l):(j._destroyed=!0,j.emit("destroyed"),void i(null,m||{ok:!0}))})}"function"==typeof k&&(i=k,k={});var j=this,g="use_prefix" in j?j.use_prefix:!0;return"http"===j.type()?h():void j.get("_local/_pouch_dependentDbs",function(m,p){if(m){return 404!==m.status?i(m):h()}var n=p.dependentDbs,l=j.constructor,o=Object.keys(n).map(function(r){var q=g?r.replace(new RegExp("^"+l.prefix),""):r;return new l(q,j.__opts).destroy()});cz.all(o).then(h,i)})}),dk.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},dk.prototype.fail=function(g){this.failed=g,this.execute()},dk.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},dk.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},ca(dj,aQ),dj.debug=b2,dj.adapters={},dj.preferredAdapters=[],dj.prefix="_pouch_";var cM=new aZ.EventEmitter;bq(dj),dj.parseAdapter=function(g,h){var m,i,k=g.match(/([a-z\-]*):\/\/(.*)/);if(k){if(g=/http(s?)/.test(k[1])?k[1]+"://"+k[2]:k[2],m=k[1],!dj.adapters[m].valid()){throw"Invalid adapter"}return{name:g,adapter:k[1]}}var l="idb" in dj.adapters&&"websql" in dj.adapters&&dd()&&localStorage["_pouch__websqldb_"+dj.prefix+g];if(h.adapter){i=h.adapter}else{if("undefined"!=typeof h&&h.db){i="leveldb"}else{for(var j=0;j<dj.preferredAdapters.length;++j){if(i=dj.preferredAdapters[j],i in dj.adapters){if(l&&"idb"===i){bJ("log",'PouchDB is downgrading "'+g+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}m=dj.adapters[i];var n=m&&"use_prefix" in m?m.use_prefix:!0;return{name:n?dj.prefix+g:g,adapter:i}},dj.adapter=function(i,h,g){h.valid()&&(dj.adapters[i]=h,g&&dj.preferredAdapters.push(i))},dj.plugin=function(g){return"function"==typeof g?g(dj):Object.keys(g).forEach(function(h){dj.prototype[h]=g[h]}),dj},dj.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=d0.extend({},h,i),void dj.call(this,k,i,j)):new g(k,i,j)}return ca(g,dj),g.preferredAdapters=dj.preferredAdapters.slice(),Object.keys(dj).forEach(function(i){i in g||(g[i]=dj[i])}),g};var ka="5.4.4";dj.version=ka;var bE,ea=eG(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cG=eG(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),f1=function(g){return atob(g)},cD=function(g){return btoa(g)},ck=aL.setImmediate||aL.setTimeout,bG=32768,dG=5,cA="document-store",e7="by-sequence",dl="attach-store",bg="attach-seq-store",ej="meta-store",cN="local-store",am="detect-blob-support",ag={running:!1,queue:[]},el=new bm.Map,jT=new e4,jL=new bm.Map;eg.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var f4=7,cW=aV("document-store"),c7=aV("by-sequence"),aq=aV("attach-store"),cv=aV("local-store"),j6=aV("metadata-store"),ab=aV("attach-seq-store"),f2=new bm.Map,dL=new e4,fA=1,bX="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+c7+" (seq, deleted)",kf="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+c7+" (doc_id, rev)",a9="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+cW+" (winningseq)",dQ="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+ab+" (seq)",cB="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+ab+" (digest, seq)",ke=c7+".seq = "+cW+".winningseq",b7=c7+".seq AS seq, "+c7+".deleted AS deleted, "+c7+".json AS data, "+c7+".rev AS rev, "+cW+".json AS metadata";kc.valid=cE,kc.use_prefix=!0;var ax=eS(),aF=function(){},bT=25,az=50,jS={},j5=1800,b3=b2("pouchdb:http");eI.valid=function(){return !0},bU.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},bU.prototype.finish=function(){return this.promise};var d7=function(h,g){return g&&h.then(function(i){c1.nextTick(function(){g(null,i)})},function(i){c1.nextTick(function(){g(i)})}),h},bD=function(g){return by(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&d7(i,j),i})},bN=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},cT=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},aN=function(l){for(var j={},i=0,k=l.length;k>i;i++){j["$"+l[i]]=!0}var h=Object.keys(j),g=new Array(h.length);for(i=0,k=h.length;k>i;i++){g[i]=h[i].substring(1)}return g},bx={},jK=new bU,ak=50,bj=bJ.bind(null,"log"),cg={_sum:function(h,g){return fQ(g)},_count:function(h,g){return g.length},_stats:function(i,h){function g(n){for(var l=0,k=0,m=n.length;m>k;k++){var j=n[k];l+=j*j}return l}return{sum:fQ(h),min:Math.min.apply(null,h),max:Math.max.apply(null,h),count:h.length,sumsqr:g(h)}}},fF=bD(function(){var g=this;return"http"===g.type()?jO(g):"function"==typeof g._viewCleanup?ac(g):bQ(g)}),dB=function(k,i,h){"function"==typeof i&&(h=i,i={}),i=i?f9(i):{},"function"==typeof k&&(k={map:k});var j=this,g=cz.resolve().then(function(){return kh(j,k,i)});return d7(g,h),g};ca(em,Error),ca(cl,Error),ca(j9,Error);var dp={query:dB,viewCleanup:fF},dx=1,dK="pouchdb",bp=5,b0=0;eD.prototype.writeCheckpoint=function(i,h){var g=this;return this.updateTarget(i,h).then(function(){return g.updateSource(i,h)})},eD.prototype.updateTarget=function(h,g){return jH(this.target,this.id,h,g,this.returnValue)},eD.prototype.updateSource=function(i,h){var g=this;return this.readOnlySource?cz.resolve(!0):jH(this.src,this.id,i,h,this.returnValue)["catch"](function(j){if(da(j)){return g.readOnlySource=!0,!0}throw j})};var bZ={undefined:function(h,g){return 0===bz.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return dm(g,h).last_seq}};eD.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?cz.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return b0}var j;return j=h.version?h.version.toString():"undefined",j in bZ?bZ[j](h,i):b0},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:b0}).then(function(){return b0},function(j){return da(j)?(g.readOnlySource=!0,h.last_seq):b0})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return b0})};var d9=0;ca(e9,aZ.EventEmitter),e9.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},e9.prototype.ready=function(k,i){function h(){g.cancel()}function j(){k.removeListener("destroyed",h),i.removeListener("destroyed",h)}var g=this;g._readyCalled||(g._readyCalled=!0,k.once("destroyed",h),i.once("destroyed",h),g.once("complete",j))},ca(cf,aZ.EventEmitter),cf.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},dj.plugin(b4).plugin(cq).plugin(jF).plugin(dp).plugin(au),f.exports=dj}).call(this,c(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var i="color: "+this.color;n=[n[0],i,"color: inherit"].concat(Array.prototype.slice.call(n,1));var o=0,p=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(o++,"%c"===q&&(p=o))}),n.splice(p,0,i),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(d,k,q){function m(){return q.colors[c++%q.colors.length]}function p(n){function f(){}function i(){var s=i,u=+new Date,t=u-(g||u);s.diff=t,s.prev=g,s.curr=u,g=u,null==s.useColors&&(s.useColors=q.useColors()),null==s.color&&s.useColors&&(s.color=m());var o=Array.prototype.slice.call(arguments);o[0]=q.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var x=0;o[0]=o[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}x++;var w=q.formatters[B];if("function"==typeof w){var C=o[x];D=w.call(s,C),o.splice(x,1),x--}return D}),"function"==typeof q.formatArgs&&(o=q.formatArgs.apply(s,o));var r=i.log||q.log||console.log.bind(console);r.apply(s,o)}f.enabled=!1,i.enabled=!0;var e=q.enabled(n)?i:f;return e.namespace=n,e}function v(i){q.save(i);for(var n=(i||"").split(/[\s,]+/),f=n.length,e=0;f>e;e++){n[e]&&(i=n[e].replace(/\*/g,".*?"),"-"===i[0]?q.skips.push(new RegExp("^"+i.substr(1)+"$")):q.names.push(new RegExp("^"+i+"$")))}}function h(){q.enable("")}function l(i){var e,f;for(e=0,f=q.skips.length;f>e;e++){if(q.skips[e].test(i)){return !1}}for(e=0,f=q.names.length;f>e;e++){if(q.names[e].test(i)){return !0}}return !1}function j(e){return e instanceof Error?e.stack||e.message:e}q=k.exports=p,q.coerce=j,q.disable=h,q.enable=v,q.enabled=l,q.humanize=d(11),q.names=[],q.skips=[],q.formatters={};var g,c=0},{11:11}],7:[function(c,f,d){(function(j){function w(){h=!0;for(var n,l,i=e.length;i;){for(l=e,e=[],n=-1;++n<i;){l[n]()}i=e.length}h=!1}function q(i){1!==e.push(i)||h||t()}var t,g=j.MutationObserver||j.WebKitMutationObserver;if(g){var k=0,p=new g(w),m=j.document.createTextNode("");p.observe(m,{characterData:!0}),t=function(){m.data=k=++k%2}}else{if(j.setImmediate||"undefined"==typeof j.MessageChannel){t="document" in j&&"onreadystatechange" in j.document.createElement("script")?function(){var i=j.document.createElement("script");i.onreadystatechange=function(){w(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},j.document.documentElement.appendChild(i)}:function(){setTimeout(w,0)}}else{var v=new j.MessageChannel;v.port1.onmessage=w,t=function(){v.port2.postMessage(0)}}}var h,e=[];f.exports=q}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(c,f,d){"function"==typeof Object.create?f.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:f.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(c,f,d){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(w,k,B){function G(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=z,this.queue=[],this.outcome=void 0,e!==G&&g(this,e)}function H(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function C(f,e,h){x(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function I(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(l,h){function f(o){e||(e=!0,d.reject(l,o))}function i(o){e||(e=!0,d.resolve(l,o))}function m(){h(i,f)}var e=!1,n=q(m);"error"===n.status&&f(n.value)}function q(h,e){var i={};try{i.value=h(e),i.status="success"}catch(f){i.status="error",i.value=f}return i}function D(e){return e instanceof this?e:d.resolve(new this(G),e)}function A(f){var e=new this(G);return d.reject(e,f)}function J(l){function p(r,s){function t(u){n[s]=u,++m!==e||i||(i=!0,d.resolve(f,n))}h.resolve(r).then(t,function(u){i||(i=!0,d.reject(f,u))})}var h=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var e=l.length,i=!1;if(!e){return this.resolve([])}for(var n=new Array(e),m=0,o=-1,f=new this(G);++o<e;){p(l[o],o)}return f}function E(l){function h(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(i,p))},function(p){e||(e=!0,d.reject(i,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var m=l.length,e=!1;if(!m){return this.resolve([])}for(var n=-1,i=new this(G);++n<m;){h(l[n])}return i}var x=w(7),d={},c=["REJECTED"],F=["FULFILLED"],z=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(f,e){if("function"!=typeof f&&this.state===F||"function"!=typeof e&&this.state===c){return this}var i=new this.constructor(G);if(this.state!==z){var h=this.state===F?f:e;C(i,h,this.outcome)}else{this.queue.push(new H(i,f,e))}return i},H.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},H.prototype.otherCallFulfilled=function(e){C(this.promise,this.onFulfilled,e)},H.prototype.callRejected=function(e){d.reject(this.promise,e)},H.prototype.otherCallRejected=function(e){C(this.promise,this.onRejected,e)},d.resolve=function(i,f){var m=q(I,f);if("error"===m.status){return d.reject(i,m.value)}var h=m.value;if(h){g(i,h)}else{i.state=F,i.outcome=f;for(var l=-1,e=i.queue.length;++l<e;){i.queue[l].callFulfilled(f)}}return i},d.reject=function(h,e){h.state=c,h.outcome=e;for(var i=-1,f=h.queue.length;++i<f;){h.queue[i].callRejected(e)}return h},j.resolve=D,j.reject=A,j.all=J,j.race=E},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(c,v,d){function y(i){if(null!==i){switch(typeof i){case"boolean":return i?1:0;case"number":return k(i);case"string":return i.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var f=Array.isArray(i),o=f?i:Object.keys(i),l=-1,n=o.length,e="";if(f){for(;++l<n;){e+=d.toIndexableString(o[l])}}else{for(;++l<n;){var h=o[l];e+=d.toIndexableString(h)+d.toIndexableString(i[h])}}return e}}return""}function m(e,l){var r,o=l,p="1"===e[l];if(p){r=0,l++}else{var s="0"===e[l];l++;var h="",n=e.substring(l,l+q),i=parseInt(n,10)+B;for(s&&(i=-i),l+=q;;){var f=e[l];if("\x00"===f){break}h+=f,l++}h=h.split("."),r=1===h.length?parseInt(h,10):parseFloat(h[0]+"."+h[1]),s&&(r-=10),0!==i&&(r=parseFloat(r+"e"+i))}return{num:r,length:l-o}}function j(o,l){var f=o.pop();if(l.length){var e=l[l.length-1];f===e.element&&(l.pop(),e=l[l.length-1]);var n=e.element,i=e.index;if(Array.isArray(n)){n.push(f)}else{if(i===o.length-2){var h=o.pop();n[h]=f}else{o.push(f)}}}}function C(f,l){for(var e=Math.min(f.length,l.length),h=0;e>h;h++){var i=d.collate(f[h],l[h]);if(0!==i){return i}}return f.length===l.length?0:f.length>l.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(i,f){for(var o=Object.keys(i),l=Object.keys(f),n=Math.min(o.length,l.length),e=0;n>e;e++){var h=d.collate(o[e],l[e]);if(0!==h){return h}if(h=d.collate(i[o[e]],f[l[e]]),0!==h){return h}}return o.length===l.length?0:o.length>l.length?1:-1}function g(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function k(o){if(0===o){return"1"}var e=o.toExponential().split(/e\+?/),l=parseInt(e[1],10),h=0>o,i=h?"0":"2",n=(h?-l:l)-B,p=z.padLeft(n.toString(),"0",q);i+=w+p;var f=Math.abs(parseFloat(e[0]));h&&(f=10-f);var r=f.toFixed(20);return r=r.replace(/\.?0+$/,""),i+=w+r}var B=-324,q=3,w="",z=c(13);d.collate=function(h,e){if(h===e){return 0}h=d.normalizeKey(h),e=d.normalizeKey(e);var f=g(h),i=g(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},d.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var f=0;i>f;f++){l[f]=d.normalizeKey(h[f])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var e in h){if(h.hasOwnProperty(e)){var n=h[e];"undefined"!=typeof n&&(l[e]=d.normalizeKey(n))}}}}}return l},d.toIndexableString=function(f){var e="\x00";return f=d.normalizeKey(f),g(f)+w+y(f)+e},d.parseIndexableString=function(e){for(var l=[],p=[],o=0;;){var h=e[o++];if("\x00"!==h){switch(h){case"1":l.push(null);break;case"2":l.push("1"===e[o]),o++;break;case"3":var n=m(e,o);l.push(n.num),o+=n.length;break;case"4":for(var i="";;){var f=e[o];if("\x00"===f){break}i+=f,o++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),l.push(i);break;case"5":var s={element:[],index:l.length};l.push(s.element),p.push(s);break;case"6":var r={element:{},index:l.length};l.push(r.element),p.push(r);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+h)}}else{if(1===l.length){return l.pop()}j(l,p)}}}},{13:13}],13:[function(f,c,g){function d(k,i,h){for(var j="",e=h-k.length;j.length<e;){j+=i}return j}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var l,h=j.length,m=p.length;for(l=0;h>l;l++){if(l===m){return 1}var e=j.charAt(l),k=p.charAt(l);if(e!==k){return k>e?-1:1}}return m>h?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(d,h,g){function c(){this.store={}}function f(i){if(this.store=new c,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}g.Map=c,g.Set=f,c.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},c.prototype.unmangle=function(e){return e.substring(1)},c.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},c.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},c.prototype.has=function(i){var e=this.mangle(i);return e in this.store},c.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},c.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},f.prototype.add=function(e){return this.store.set(e,!0)},f.prototype.has=function(e){return this.store.has(e)},f.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(c,f,d){(function(){var e={}.hasOwnProperty,g=[].slice;f.exports=function(m,l){var k,j,i,h;j=[],h=[];for(k in l){e.call(l,k)&&(i=l[k],"this"!==k&&(j.push(k),h.push(i)))}return Function.apply(null,g.call(j).concat([m])).apply(l["this"],h)}}).call(this)},{}],16:[function(e,d,c){!function(g){if("object"==typeof c){d.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(z){function w(i,h,n,m,l,g){return h=K(K(h,i),K(m,g)),K(h<<l|h>>>32-l,n)}function A(m,n,l,h,i,o,g){return w(n&l|~n&h,m,n,i,o,g)}function C(m,n,l,h,i,o,g){return w(n&h|l&~h,m,n,i,o,g)}function x(m,n,l,h,i,o,g){return w(n^l^h,m,n,i,o,g)}function D(m,n,l,h,i,o,g){return w(l^(n|~h),m,n,i,o,g)}function M(i,h){var n=i[0],m=i[1],g=i[2],l=i[3];n=A(n,m,g,l,h[0],7,-680876936),l=A(l,n,m,g,h[1],12,-389564586),g=A(g,l,n,m,h[2],17,606105819),m=A(m,g,l,n,h[3],22,-1044525330),n=A(n,m,g,l,h[4],7,-176418897),l=A(l,n,m,g,h[5],12,1200080426),g=A(g,l,n,m,h[6],17,-1473231341),m=A(m,g,l,n,h[7],22,-45705983),n=A(n,m,g,l,h[8],7,1770035416),l=A(l,n,m,g,h[9],12,-1958414417),g=A(g,l,n,m,h[10],17,-42063),m=A(m,g,l,n,h[11],22,-1990404162),n=A(n,m,g,l,h[12],7,1804603682),l=A(l,n,m,g,h[13],12,-40341101),g=A(g,l,n,m,h[14],17,-1502002290),m=A(m,g,l,n,h[15],22,1236535329),n=C(n,m,g,l,h[1],5,-165796510),l=C(l,n,m,g,h[6],9,-1069501632),g=C(g,l,n,m,h[11],14,643717713),m=C(m,g,l,n,h[0],20,-373897302),n=C(n,m,g,l,h[5],5,-701558691),l=C(l,n,m,g,h[10],9,38016083),g=C(g,l,n,m,h[15],14,-660478335),m=C(m,g,l,n,h[4],20,-405537848),n=C(n,m,g,l,h[9],5,568446438),l=C(l,n,m,g,h[14],9,-1019803690),g=C(g,l,n,m,h[3],14,-187363961),m=C(m,g,l,n,h[8],20,1163531501),n=C(n,m,g,l,h[13],5,-1444681467),l=C(l,n,m,g,h[2],9,-51403784),g=C(g,l,n,m,h[7],14,1735328473),m=C(m,g,l,n,h[12],20,-1926607734),n=x(n,m,g,l,h[5],4,-378558),l=x(l,n,m,g,h[8],11,-2022574463),g=x(g,l,n,m,h[11],16,1839030562),m=x(m,g,l,n,h[14],23,-35309556),n=x(n,m,g,l,h[1],4,-1530992060),l=x(l,n,m,g,h[4],11,1272893353),g=x(g,l,n,m,h[7],16,-155497632),m=x(m,g,l,n,h[10],23,-1094730640),n=x(n,m,g,l,h[13],4,681279174),l=x(l,n,m,g,h[0],11,-358537222),g=x(g,l,n,m,h[3],16,-722521979),m=x(m,g,l,n,h[6],23,76029189),n=x(n,m,g,l,h[9],4,-640364487),l=x(l,n,m,g,h[12],11,-421815835),g=x(g,l,n,m,h[15],16,530742520),m=x(m,g,l,n,h[2],23,-995338651),n=D(n,m,g,l,h[0],6,-198630844),l=D(l,n,m,g,h[7],10,1126891415),g=D(g,l,n,m,h[14],15,-1416354905),m=D(m,g,l,n,h[5],21,-57434055),n=D(n,m,g,l,h[12],6,1700485571),l=D(l,n,m,g,h[3],10,-1894986606),g=D(g,l,n,m,h[10],15,-1051523),m=D(m,g,l,n,h[1],21,-2054922799),n=D(n,m,g,l,h[8],6,1873313359),l=D(l,n,m,g,h[15],10,-30611744),g=D(g,l,n,m,h[6],15,-1560198380),m=D(m,g,l,n,h[13],21,1309151649),n=D(n,m,g,l,h[4],6,-145523070),l=D(l,n,m,g,h[11],10,-1120210379),g=D(g,l,n,m,h[2],15,718787259),m=D(m,g,l,n,h[9],21,-343485551),i[0]=K(n,i[0]),i[1]=K(m,i[1]),i[2]=K(g,i[2]),i[3]=K(l,i[3])}function J(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g.charCodeAt(i)+(g.charCodeAt(i+1)<<8)+(g.charCodeAt(i+2)<<16)+(g.charCodeAt(i+3)<<24)}return h}function B(g){var i,h=[];for(i=0;64>i;i+=4){h[i>>2]=g[i]+(g[i+1]<<8)+(g[i+2]<<16)+(g[i+3]<<24)}return h}function G(g){var m,o,l,n,p,i,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;h>=m;m+=64){M(r,J(g.substring(m-64,m)))}for(g=g.substring(m-64),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;o>m;m+=1){l[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(l[m>>2]|=128<<(m%4<<3),m>55){for(M(r,l),m=0;16>m;m+=1){l[m]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),i=parseInt(n[1],16)||0,l[14]=p,l[15]=i,M(r,l),r}function q(g){var i,o,l,n,p,m,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(i=64;h>=i;i+=64){M(r,B(g.subarray(i-64,i)))}for(g=h>i-64?g.subarray(i-64):new Uint8Array(0),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;o>i;i+=1){l[i>>2]|=g[i]<<(i%4<<3)}if(l[i>>2]|=128<<(i%4<<3),i>55){for(M(r,l),i=0;16>i;i+=1){l[i]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=p,l[15]=m,M(r,l),r}function E(g){var i,h="";for(i=0;4>i;i+=1){h+=L[g>>8*i+4&15]+L[g>>8*i&15]}return h}function F(h){var g;for(g=0;g<h.length;g+=1){h[g]=E(h[g])}return h.join("")}function I(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(i,h){var n,m=i.length,l=new ArrayBuffer(m),g=new Uint8Array(l);for(n=0;m>n;n+=1){g[n]=i.charCodeAt(n)}return h?g:l}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(h,g,i){var l=new Uint8Array(h.byteLength+g.byteLength);return l.set(new Uint8Array(h)),l.set(new Uint8Array(g),h.byteLength),i?l:l.buffer}function N(h){var g,i=[],l=h.length;for(g=0;l-1>g;g+=2){i.push(parseInt(h.substr(g,2),16))}return String.fromCharCode.apply(String,i)}function H(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==F(G("hello"))&&(K=function(h,g){var i=(65535&h)+(65535&g),l=(h>>16)+(g>>16)+(i>>16);return l<<16|65535&i}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(n,m){var p,o,l,h,s=this.byteLength,r=g(n,s),i=s;return m!==z&&(i=g(m,s)),r>i?new ArrayBuffer(0):(p=i-r,o=new ArrayBuffer(p),l=new Uint8Array(o),h=new Uint8Array(this,r,p),l.set(h),o)}}(),H.prototype.append=function(g){return this.appendBinary(I(g)),this},H.prototype.appendBinary=function(g){this._buff+=g,this._length+=g.length;var i,h=this._buff.length;for(i=64;h>=i;i+=64){M(this._hash,J(this._buff.substring(i-64,i)))}return this._buff=this._buff.substring(i-64),this},H.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m.charCodeAt(h)<<(h%4<<3)}return this._finish(g,l),n=F(this._hash),i&&(n=N(n)),this.reset(),n},H.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},H.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},H.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},H.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},H.prototype._finish=function(i,h){var n,m,l,g=h;if(i[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,i),g=0;16>g;g+=1){i[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(n[2],16),l=parseInt(n[1],16)||0,i[14]=m,i[15]=l,M(this._hash,i)},H.hash=function(h,g){return H.hashBinary(I(h),g)},H.hashBinary=function(h,g){var i=G(h),l=F(i);return g?N(l):l},H.ArrayBuffer=function(){this.reset()},H.ArrayBuffer.prototype.append=function(h){var g,i=f(this._buff.buffer,h,!0),l=i.length;for(this._length+=h.byteLength,g=64;l>=g;g+=64){M(this._hash,B(i.subarray(g-64,g)))}return this._buff=l>g-64?new Uint8Array(i.buffer.slice(g-64)):new Uint8Array(0),this},H.ArrayBuffer.prototype.end=function(i){var h,n,m=this._buff,l=m.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;l>h;h+=1){g[h>>2]|=m[h]<<(h%4<<3)}return this._finish(g,l),n=F(this._hash),i&&(n=N(n)),this.reset(),n},H.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},H.ArrayBuffer.prototype.getState=function(){var g=H.prototype.getState.call(this);return g.buff=j(g.buff),g},H.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),H.prototype.setState.call(this,g)},H.ArrayBuffer.prototype.destroy=H.prototype.destroy,H.ArrayBuffer.prototype._finish=H.prototype._finish,H.ArrayBuffer.hash=function(h,g){var i=q(new Uint8Array(h)),l=F(i);return g?N(l):l},H})},{}],17:[function(f,c,g){function d(j,p,l){var h=l[l.length-1];j===h.element&&(l.pop(),h=l[l.length-1]);var m=h.element,e=h.index;if(Array.isArray(m)){m.push(j)}else{if(e===p.length-2){var k=p.pop();m[k]=j}else{p.push(j)}}}g.stringify=function(w){var z=[];z.push({obj:w});for(var B,x,h,m,q,A,p,j,v,k,y,e="";B=z.pop();){if(x=B.obj,h=B.prefix||"",m=B.val||"",e+=h,m){e+=m}else{if("object"!=typeof x){e+="undefined"==typeof x?null:JSON.stringify(x)}else{if(null===x){e+="null"}else{if(Array.isArray(x)){for(z.push({val:"]"}),q=x.length-1;q>=0;q--){A=0===q?"":",",z.push({obj:x[q],prefix:A})}z.push({val:"["})}else{p=[];for(j in x){x.hasOwnProperty(j)&&p.push(j)}for(z.push({val:"}"}),q=p.length-1;q>=0;q--){v=p[q],k=x[v],y=q>0?",":"",y+=JSON.stringify(v)+":",z.push({obj:k,prefix:y})}z.push({val:"{"})}}}}}return e},g.parse=function(x){for(var w,m,y,q,v,h,e,p,k,z=[],r=[],j=0;;){if(w=x[j++],"}"!==w&&"]"!==w&&"undefined"!=typeof w){switch(w){case" ":case"	":case"\n":case":":case",":break;case"n":j+=3,d(null,z,r);break;case"t":j+=3,d(!0,z,r);break;case"f":j+=4,d(!1,z,r);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(m="",j--;;){if(y=x[j++],!/[\d\.\-e\+]/.test(y)){j--;break}m+=y}d(parseFloat(m),z,r);break;case'"':for(q="",v=void 0,h=0;;){if(e=x[j++],'"'===e&&("\\"!==v||h%2!==1)){break}q+=e,v=e,"\\"===v?h++:h=0}d(JSON.parse('"'+q+'"'),z,r);break;case"[":p={element:[],index:z.length},z.push(p.element),r.push(p);break;case"{":k={element:{},index:z.length},z.push(k.element),r.push(k);break;default:throw new Error("unexpectedly reached end of input: "+w)}}else{if(1===z.length){return z.pop()}d(z.pop(),z,r)}}}},{}]},{},[3])(3)});