!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.PouchDB=b()}}}(function(){var b;return function a(h,c,f){function g(m,i){if(!c[m]){if(!h[m]){var e="function"==typeof require&&require;if(!i&&e){return e(m,!0)}if(d){return d(m,!0)}var l=new Error("Cannot find module '"+m+"'");throw l.code="MODULE_NOT_FOUND",l}var k=c[m]={exports:{}};h[m][0].call(k.exports,function(n){var o=h[m][1][n];return g(o?o:n)},k,k.exports,a,h,c,f)}return c[m].exports}for(var d="function"==typeof require&&require,j=0;j<f.length;j++){g(f[j])}return g}({1:[function(j,f,l){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function k(e){return"function"==typeof e}function h(e){return"number"==typeof e}function c(e){return"object"==typeof e&&null!==e}function g(e){return void 0===e}f.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(e){if(!h(e)||0>e||isNaN(e)){throw TypeError("n must be a positive number")}return this._maxListeners=e,this},d.prototype.emit=function(p){var i,e,m,o,q,n;if(this._events||(this._events={}),"error"===p&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error){throw i}throw TypeError('Uncaught, unspecified "error" event.')}if(e=this._events[p],g(e)){return !1}if(k(e)){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),e.apply(this,o)}}else{if(c(e)){for(o=Array.prototype.slice.call(arguments,1),n=e.slice(),m=n.length,q=0;m>q;q++){n[q].apply(this,o)}}}return !0},d.prototype.addListener=function(m,i){var e;if(!k(i)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",m,k(i.listener)?i.listener:i),this._events[m]?c(this._events[m])?this._events[m].push(i):this._events[m]=[this._events[m],i]:this._events[m]=i,c(this._events[m])&&!this._events[m].warned&&(e=g(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[m].length>e&&(this._events[m].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[m].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(n,i){function e(){this.removeListener(n,e),m||(m=!0,i.apply(this,arguments))}if(!k(i)){throw TypeError("listener must be a function")}var m=!1;return e.listener=i,this.on(n,e),this},d.prototype.removeListener=function(p,m){var i,e,n,o;if(!k(m)){throw TypeError("listener must be a function")}if(!this._events||!this._events[p]){return this}if(i=this._events[p],n=i.length,e=-1,i===m||k(i.listener)&&i.listener===m){delete this._events[p],this._events.removeListener&&this.emit("removeListener",p,m)}else{if(c(i)){for(o=n;o-->0;){if(i[o]===m||i[o].listener&&i[o].listener===m){e=o;break}}if(0>e){return this}1===i.length?(i.length=0,delete this._events[p]):i.splice(e,1),this._events.removeListener&&this.emit("removeListener",p,m)}}return this},d.prototype.removeAllListeners=function(m){var i,e;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[m]&&delete this._events[m],this}if(0===arguments.length){for(i in this._events){"removeListener"!==i&&this.removeAllListeners(i)}return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[m],k(e)){this.removeListener(m,e)}else{if(e){for(;e.length;){this.removeListener(m,e[e.length-1])}}}return delete this._events[m],this},d.prototype.listeners=function(i){var e;return e=this._events&&this._events[i]?k(this._events[i])?[this._events[i]]:this._events[i].slice():[]},d.prototype.listenerCount=function(i){if(this._events){var e=this._events[i];if(k(e)){return 1}if(e){return e.length}}return 0},d.listenerCount=function(i,e){return i.listenerCount(e)}},{}],2:[function(q,z,y){function w(){j&&v&&(j=!1,v.length?A=v.concat(A):d=-1,A.length&&g())}function g(){if(!j){var f=m(w);j=!0;for(var e=A.length;e;){for(v=A,A=[];++d<e;){v&&v[d].run()}d=-1,e=A.length}v=null,j=!1,x(f)}}function p(f,e){this.fun=f,this.array=e}function c(){}var m,x,k=z.exports={};!function(){try{m=setTimeout}catch(e){m=function(){throw new Error("setTimeout is not defined")}}try{x=clearTimeout}catch(e){x=function(){throw new Error("clearTimeout is not defined")}}}();var v,A=[],j=!1,d=-1;k.nextTick=function(f){var e=new Array(arguments.length-1);if(arguments.length>1){for(var h=1;h<arguments.length;h++){e[h-1]=arguments[h]}}A.push(new p(f,e)),1!==A.length||j||m(g,0)},p.prototype.run=function(){this.fun.apply(null,this.array)},k.title="browser",k.browser=!0,k.env={},k.argv=[],k.version="",k.versions={},k.on=c,k.addListener=c,k.once=c,k.off=c,k.removeListener=c,k.removeAllListeners=c,k.emit=c,k.binding=function(e){throw new Error("process.binding is not supported")},k.cwd=function(){return"/"},k.chdir=function(e){throw new Error("process.chdir is not supported")},k.umask=function(){return 0}},{}],3:[function(d,c,f){(function(dY,bc){function eC(g){return g&&"object"==typeof g&&"default" in g?g["default"]:g}function dg(g){return g instanceof ArrayBuffer||"undefined"!=typeof Blob&&g instanceof Blob}function dy(i){if("function"==typeof i.slice){return i.slice(0)}var g=new ArrayBuffer(i.byteLength),j=new Uint8Array(g),h=new Uint8Array(i);return j.set(h),g}function aU(h){if(h instanceof ArrayBuffer){return dy(h)}var g=h.size,i=h.type;return"function"==typeof h.slice?h.slice(0,g,i):h.webkitSlice(0,g,i)}function aQ(h){var g=Object.getPrototypeOf(h);if(null===g){return !0}var i=g.constructor;return"function"==typeof i&&i instanceof i&&ka.call(i)==by}function c1(j){var h,g,i;if(!j||"object"!=typeof j){return j}if(Array.isArray(j)){for(h=[],g=0,i=j.length;i>g;g++){h[g]=c1(j[g])}return h}if(j instanceof Date){return j.toISOString()}if(dg(j)){return aU(j)}if(!aQ(j)){return j}h={};for(g in j){if(Object.prototype.hasOwnProperty.call(j,g)){var k=c1(j[g]);"undefined"!=typeof k&&(h[g]=k)}}return h}function f5(h){var g=!1;return cY(function(i){if(g){throw new Error("once called more than once")}g=!0,h.apply(this,i)})}function f3(g){return cY(function(j){j=c1(j);var k,l=this,i="function"==typeof j[j.length-1]?j.pop():!1;i&&(k=function(n,m){dY.nextTick(function(){i(n,m)})});var h=new cf(function(n,m){var p;try{var o=f5(function(r,s){r?m(r):n(s)});j.push(o),p=g.apply(l,j),p&&"function"==typeof p.then&&n(p)}catch(q){m(q)}});return k&&h.then(function(m){k(null,m)},k),h})}function eX(h,g){function i(m,k,o){if(eW.enabled){for(var l=[m._db_name,k],n=0;n<o.length-1;n++){l.push(o[n])}eW.apply(null,l);var j=o[o.length-1];o[o.length-1]=function(r,p){var q=[m._db_name,k];q=q.concat(r?["error",r]:["success",p]),eW.apply(null,q),j(r,p)}}}return f3(cY(function(j){if(this._closed){return cf.reject(new Error("database is closed"))}if(this._destroyed){return cf.reject(new Error("database is destroyed"))}var k=this;return i(k,h,j),this.taskqueue.isReady?g.apply(this,j):new cf(function(l,m){k.taskqueue.addTask(function(n){n?m(n):l(k[h].apply(k,j))})})}))}function eK(k,i){for(var h={},j=0,l=i.length;l>j;j++){var g=i[j];g in k&&(h[g]=k[g])}return h}function fD(g){return g}function eO(g){return[{ok:g}]}function ds(m,q,k){function u(){var w=[];v.forEach(function(x){x.docs.forEach(function(y){w.push({id:x.id,docs:[y]})})}),k(null,{results:w})}function h(){++l===p&&u()}function i(x,w,y){v[x]={id:w,docs:y},h()}function g(){if(!(r>=s.length)){var x=Math.min(r+c8,s.length),w=s.slice(r,x);o(w,r),r+=w.length}}function o(x,w){x.forEach(function(z,D){var B=w+D,y=j[z],A=eK(y[0],["atts_since","attachments"]);A.open_revs=y.map(function(E){return E.rev}),A.open_revs=A.open_revs.filter(fD);var C=fD;0===A.open_revs.length&&(delete A.open_revs,C=eO),["revs","attachments","binary","ajax"].forEach(function(E){E in q&&(A[E]=q[E])}),m.get(z,A,function(G,E){var F;F=G?[{error:G}]:C(E),i(B,z,F),g()})})}var n=q.docs,j={};n.forEach(function(w){w.id in j?j[w.id].push(w):j[w.id]=[w]});var p=Object.keys(j).length,l=0,v=new Array(p),s=Object.keys(j),r=0;g()}function fB(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function eB(){return f7}function eE(g){fB()?chrome.storage.onChanged.addListener(function(h){null!=h.db_name&&g.emit(h.dbName.newValue)}):eB()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(h){g.emit(h.key)}):window.attachEvent("storage",function(h){g.emit(h.key)}))}function ed(){c6.EventEmitter.call(this),this._listeners={},eE(this)}function aL(h){if("undefined"!==console&&h in console){var g=Array.prototype.slice.call(arguments,1);console[h].apply(console,g)}}function e4(j,h){var g=600000;j=parseInt(j,10)||0,h=parseInt(h,10),h!==h||j>=h?h=(j||1)<<1:h+=1,h>g&&(j=g>>1,h=g);var i=Math.random(),k=h-j;return ~~(k*i+j)}function ch(h){var g=0;return h||(g=2000),e4(h,g)}function bH(h,g){aL("info","The above "+h+" is totally normal. "+g)}function e0(g){Error.call(this,g.reason),this.status=g.status,this.name=g.error,this.message=g.reason,this.error=!0}function dX(i,g,j){function h(k){for(var l in i){"function"!=typeof i[l]&&(this[l]=i[l])}void 0!==j&&(this.name=j),void 0!==k&&(this.reason=k)}return h.prototype=e0.prototype,new h(g)}function dC(k){var i,h,j,l,g;return h=k.error===!0&&"string"==typeof k.name?k.name:k.error,g=k.reason,j=dV("name",h,g),k.missing||"missing"===g||"deleted"===g||"not_found"===h?j=d4:"doc_validation"===h?(j=fI,l=g):"bad_request"===h&&j.message!==g&&(j=dF),j||(j=dV("status",k.status,g)||dJ),i=dX(j,g,h),l&&(i.message=l),k.id&&(i.id=k.id),k.status&&(i.status=k.status),k.missing&&(i.missing=k.missing),i}function bS(j,h,g){try{return !j(h,g)}catch(i){var k="Filter function threw: "+i.toString();return dX(dF,k)}}function eU(h){var g={},i=h.filter&&"function"==typeof h.filter;return g.query=h.query_params,function(k){k.doc||(k.doc={});var l=i&&bS(h.filter,k.doc,g);if("object"==typeof l){return l}if(l){return !1}if(h.include_docs){if(!h.attachments){for(var j in k.doc._attachments){k.doc._attachments.hasOwnProperty(j)&&(k.doc._attachments[j].stub=!0)}}}else{delete k.doc}return !0}}function fK(i){for(var g=[],j=0,h=i.length;h>j;j++){g=g.concat(i[j])}return g}function bJ(h){var g;if(h?"string"!=typeof h?g=dX(cz):/^_/.test(h)&&!/^_(design|local)/.test(h)&&(g=dX(fC)):g=dX(ba),g){throw g}}function aD(h,g){return"listenerCount" in h?h.listenerCount(g):c6.EventEmitter.listenerCount(h,g)}function bd(h){if(!h){return null}var g=h.split("/");return 2===g.length?g:1===g.length?[h,h]:null}function av(h){var g=bd(h);return g?g.join("/"):null}function dE(m){for(var k=fO.exec(m),g={},l=14;l--;){var i=kd[l],j=k[l]||"",h=-1!==["user","password"].indexOf(i);g[i]=h?decodeURIComponent(j):j}return g[d1]={},g[kd[12]].replace(dw,function(o,p,n){p&&(g[d1][p]=n)}),g}function fE(h,g,i){return new cf(function(j,k){h.get(g,function(n,l){if(n){if(404!==n.status){return k(n)}l={}}var o=l._rev,m=i(l);return m?(m._id=g,m._rev=o,void j(af(h,m,i))):j({updated:!1,rev:o})})})}function af(h,g,i){return h.put(g).then(function(j){return{updated:!0,rev:j.rev}},function(j){if(409!==j.status){throw j}return fE(h,g._id,i)})}function aI(g){return 0|Math.random()*g}function cI(i,g){g=g||df.length;var j="",h=-1;if(i){for(;++h<i;){j+=df[aI(g)]}return j}for(;++h<36;){switch(h){case 8:case 13:case 18:case 23:j+="-";break;case 19:j+=df[3&aI(16)|8];break;default:j+=df[aI(16)]}}return j}function cE(r){for(var j,m,k,l,o=r.rev_tree.slice();l=o.pop();){var h=l.ids,p=h[2],i=l.pos;if(p.length){for(var g=0,q=p.length;q>g;g++){o.push({pos:i+1,ids:p[g]})}}else{var n=!!h[1].deleted,s=h[0];j&&!(k!==n?k:m!==i?i>m:s>j)||(j=s,m=i,k=n)}}return m+"-"+j}function dd(i,k){for(var g,m=i.slice();g=m.pop();){for(var o=g.pos,h=g.ids,j=h[2],l=k(0===j.length,o,h[0],g.ctx,h[1]),p=0,n=j.length;n>p;p++){m.push({pos:o+1,ids:j[p],ctx:l})}}}function j4(h,g){return h.pos-g.pos}function bK(i){var g=[];dd(i,function(n,k,m,o,l){n&&g.push({rev:k+"-"+m,pos:k,opts:l})}),g.sort(j4).reverse();for(var j=0,h=g.length;h>j;j++){delete g[j].pos}return g}function d3(m){for(var k=cE(m),g=bK(m.rev_tree),l=[],i=0,j=g.length;j>i;i++){var h=g[i];h.rev===k||h.opts.deleted||l.push(h.rev)}return l}function bi(h){var g=[];return dd(h.rev_tree,function(l,i,k,m,j){"available"!==j.status||l||(g.push(i+"-"+k),j.status="missing")}),g}function eY(r){for(var j,m=[],k=r.slice();j=k.pop();){var l=j.pos,o=j.ids,h=o[0],p=o[1],i=o[2],g=0===i.length,q=j.history?j.history.slice():[];q.push({id:h,opts:p}),g&&m.push({pos:l+1-q.length,ids:q});for(var n=0,s=i.length;s>n;n++){k.push({pos:l+1,ids:i[n],history:q})}}return m.reverse()}function bI(h,g){return h.pos-g.pos}function aA(k,i,h){for(var j,l=0,g=k.length;g>l;){j=l+g>>>1,h(k[j],i)<0?l=j+1:g=j}return l}function a8(i,g,j){var h=aA(i,g,j);i.splice(h,0,g)}function fM(g,h){for(var m,i,k=h,l=g.length;l>k;k++){var j=g[k],n=[j.id,j.opts,[]];i?(i[2].push(n),i=n):m=i=n}return m}function dZ(h,g){return h[0]<g[0]?-1:1}function kc(i,k){for(var g=[{tree1:i,tree2:k}],m=!1;g.length>0;){var o=g.pop(),h=o.tree1,j=o.tree2;(h[1].status||j[1].status)&&(h[1].status="available"===h[1].status||"available"===j[1].status?"available":"missing");for(var l=0;l<j[2].length;l++){if(h[2][0]){for(var p=!1,n=0;n<h[2].length;n++){h[2][n][0]===j[2][l][0]&&(g.push({tree1:h[2][n],tree2:j[2][l]}),p=!0)}p||(m="new_branch",a8(h[2],j[2][l],dZ))}else{m="new_leaf",h[2][0]=j[2][l]}}}return{conflicts:m,tree:i}}function ap(m,r,z){var v,k=[],o=!1,A=!1;if(!m.length){return{tree:[r],conflicts:"new_leaf"}}for(var u=0,j=m.length;j>u;u++){var x=m[u];if(x.pos===r.pos&&x.ids[0]===r.ids[0]){v=kc(x.ids,r.ids),k.push({pos:x.pos,ids:v.tree}),o=o||v.conflicts,A=!0}else{if(z!==!0){var s=x.pos<r.pos?x:r,n=x.pos<r.pos?r:x,q=n.pos-s.pos,p=[],i=[];for(i.push({ids:s.ids,diff:q,parent:null,parentIdx:null});i.length>0;){var h=i.pop();if(0!==h.diff){for(var g=h.ids[2],y=0,w=g.length;w>y;y++){i.push({ids:g[y],diff:h.diff-1,parent:h.ids,parentIdx:y})}}else{h.ids[0]===n.ids[0]&&p.push(h)}}var l=p[0];l?(v=kc(l.ids,n.ids),l.parent[2][l.parentIdx]=v.tree,k.push({pos:s.pos,ids:s.ids}),o=o||v.conflicts,A=!0):k.push(x)}else{k.push(x)}}}return A||k.push(r),k.sort(bI),{tree:k,conflicts:o||"internal_node"}}function jY(r,j){for(var m,k=eY(r),l={},o=0,h=k.length;h>o;o++){for(var p=k[o],i=p.ids,g=Math.max(0,i.length-j),q={pos:p.pos+g,ids:fM(i,g)},n=0;g>n;n++){var s=p.pos+n+"-"+i[n].id;l[s]=!0}m=m?ap(m,q,!0).tree:[q]}return dd(m,function(w,v,u){delete l[v+"-"+u]}),{tree:m,revs:Object.keys(l)}}function cP(j,h,g){var i=ap(j,h),k=jY(i.tree,g);return{tree:k.tree,stemmedRevs:k.revs,conflicts:i.conflicts}}function eM(i,k){for(var g,m=i.slice(),o=k.split("-"),h=parseInt(o[0],10),j=o[1];g=m.pop();){if(g.pos===h&&g.ids[0]===j){return !0}for(var l=g.ids[2],p=0,n=l.length;n>p;p++){m.push({pos:g.pos+1,ids:l[p]})}}return !1}function bP(g){return g.ids}function fH(j,h){h||(h=cE(j));for(var g,i=h.substring(h.indexOf("-")+1),k=j.rev_tree.map(bP);g=k.pop();){if(g[0]===i){return !!g[1].deleted}k=k.concat(g[2])}}function e8(g){return/^_local/.test(g)}function du(g){return dO("return "+g+";",{})}function aP(g){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+g+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function dH(h,g){try{h.emit("change",g)}catch(i){aL("error",'Error in .on("change", function):',i)}}function c4(m,k,g){function l(){i.cancel()}c6.EventEmitter.call(this);var i=this;this.db=m,k=k?c1(k):{};var j=k.complete=f5(function(o,n){o?aD(i,"error")>0&&i.emit("error",o):i.emit("complete",n),i.removeAllListeners(),m.removeListener("destroyed",l)});g&&(i.on("complete",function(n){g(null,n)}),i.on("error",g)),m.once("destroyed",l),k.onChange=function(n){k.isCancelled||(dH(i,n),i.startSeq&&i.startSeq<=n.seq&&(i.startSeq=!1))};var h=new cf(function(o,n){k.complete=function(p,q){p?n(p):o(q)}});i.once("cancel",function(){m.removeListener("destroyed",l),k.complete(null,{status:"cancelled"})}),this.then=h.then.bind(h),this["catch"]=h["catch"].bind(h),this.then(function(n){j(null,n)},j),m.taskqueue.isReady?i.doChanges(k):m.taskqueue.addTask(function(){i.isCancelled?i.emit("cancel"):i.doChanges(k)})}function aT(j,h,g){var i=[{rev:j._rev}];"all_docs"===g.style&&(i=bK(h.rev_tree).map(function(l){return{rev:l.rev}}));var k={id:h.id,changes:i,doc:j};return fH(h,j._rev)&&(k.deleted=!0),g.conflicts&&(k.doc._conflicts=d3(h),k.doc._conflicts.length||delete k.doc._conflicts),k}function cd(h,g){return g>h?-1:h>g?1:0}function f8(h,g){for(var i=0;i<h.length;i++){if(g(h[i],i)===!0){return h[i]}}}function f0(g){return function(h,i){h||i[0]&&i[0].error?g(h||i[0]):g(null,i.length?i[0]:i)}}function fP(k){for(var i=0;i<k.length;i++){var h=k[i];if(h._deleted){delete h._attachments}else{if(h._attachments){for(var j=Object.keys(h._attachments),l=0;l<j.length;l++){var g=j[l];h._attachments[g]=eK(h._attachments[g],["data","digest","content_type","length","revpos","stub"])}}}}}function eS(j,h){var g=cd(j._id,h._id);if(0!==g){return g}var i=j._revisions?j._revisions.start:0,k=h._revisions?h._revisions.start:0;return cd(i,k)}function e5(h){var g={},i=[];return dd(h,function(n,m,j,l){var k=m+"-"+j;return n&&(g[k]=0),void 0!==l&&i.push({from:l,to:k}),k}),i.reverse(),i.forEach(function(j){void 0===g[j.from]?g[j.from]=1+g[j.to]:g[j.from]=Math.min(g[j.from],1+g[j.to])}),g}function dT(j,h,g){var i="limit" in h?h.keys.slice(h.skip,h.limit+h.skip):h.skip>0?h.keys.slice(h.skip):h.keys;if(h.descending&&i.reverse(),!i.length){return j._allDocs({limit:0},g)}var k={offset:h.skip};return cf.all(i.map(function(m){var l=dN.extend({key:m,deleted:"ok"},h);return["limit","skip","keys"].forEach(function(n){delete l[n]}),new cf(function(o,n){j._allDocs(l,function(q,p){return q?n(q):(k.total_rows=p.total_rows,void o(p.rows[0]||{key:m,error:"not_found"}))})})})).then(function(l){return k.rows=l,k})}function bC(i){var g=i._compactionQueue[0],h=g.opts,j=g.callback;i.get("_local/compaction")["catch"](function(){return !1}).then(function(k){k&&k.last_seq&&(h.last_seq=k.last_seq),i._compact(h,function(l,m){l?j(l):j(null,m),dY.nextTick(function(){i._compactionQueue.shift(),i._compactionQueue.length&&bC(i)})})})}function cU(g){return"_"===g.charAt(0)?g+"is not a valid attachment name, attachment names cannot start with '_'":!1}function dv(){c6.EventEmitter.call(this)}function d8(){this.isReady=!1,this.failed=!1,this.queue=[]}function eR(g){g&&bc.debug&&aL("error",g)}function c9(m,k){function g(){j.emit("destroyed",i)}function l(){m.removeListener("destroyed",g),m.emit("destroyed",m)}var i=k.originalName,j=m.constructor,h=j._destructionListeners;m.once("destroyed",g),h.has(i)||h.set(i,[]),h.get(i).push(l)}function eA(m,k,g){if(!(this instanceof eA)){return new eA(m,k,g)}var l=this;if("function"!=typeof k&&"undefined"!=typeof k||(g=k,k={}),m&&"object"==typeof m&&(k=m,m=void 0),"undefined"==typeof g){g=eR}else{var i=g;g=function(){return aL("warn","Using a callback for new PouchDB()is deprecated."),i.apply(null,arguments)}}m=m||k.name,k=c1(k),delete k.name,this.__opts=k;var j=g;l.auto_compaction=k.auto_compaction,l.prefix=eA.prefix,dv.call(l),l.taskqueue=new d8;var h=new cf(function(q,o){g=function(r,s){return r?o(r):(delete s.then,void q(s))},k=c1(k);var n,p;return function(){try{if("string"!=typeof m){throw p=new Error("Missing/invalid DB name"),p.code=400,p}var r=(k.prefix||"")+m;if(n=eA.parseAdapter(r,k),k.originalName=m,k.name=n.name,k.adapter=k.adapter||n.adapter,l._adapter=k.adapter,bb("pouchdb:adapter")("Picked adapter: "+k.adapter),l._db_name=m,!eA.adapters[k.adapter]){throw p=new Error("Adapter is missing"),p.code=404,p}if(!eA.adapters[k.adapter].valid()){throw p=new Error("Invalid Adapter"),p.code=404,p}}catch(s){l.taskqueue.fail(s)}}(),p?o(p):(l.adapter=k.adapter,l.replicate={},l.replicate.from=function(r,u,s){return l.constructor.replicate(r,l,u,s)},l.replicate.to=function(r,u,s){return l.constructor.replicate(l,r,u,s)},l.sync=function(r,u,s){return l.constructor.sync(l,r,u,s)},l.replicate.sync=l.sync,void eA.adapters[k.adapter].call(l,k,function(r){return r?(l.taskqueue.fail(r),void g(r)):(c9(l,k),l.emit("created",l),eA.emit("created",k.originalName),l.taskqueue.ready(l),void g(null,l))}))});h.then(function(n){j(null,n)},j),l.then=h.then.bind(h),l["catch"]=h["catch"].bind(h)}function eG(h){Object.keys(c6.EventEmitter.prototype).forEach(function(i){"function"==typeof c6.EventEmitter.prototype[i]&&(h[i]=cM[i].bind(cM))});var g=h._destructionListeners=new d5.Map;h.on("destroyed",function(i){g.get(i).forEach(function(j){j()}),g["delete"](i)})}function e(g){return g.reduce(function(i,h){return i[h]=!0,i},{})}function db(i){if(!/^\d+\-./.test(i)){return dX(c2)}var g=i.indexOf("-"),j=i.substring(0,g),h=i.substring(g+1);return{prefix:parseInt(j,10),id:h}}function dk(m,k){for(var g=m.start-m.ids.length+1,l=m.ids,i=[l[0],k,[]],j=1,h=l.length;h>j;j++){i=[l[j],{status:"missing"},[i]]}return[{pos:g,ids:i}]}function bq(i,k){var g,m,o,h={status:"available"};if(i._deleted&&(h.deleted=!0),k){if(i._id||(i._id=cI()),m=cI(32,16).toLowerCase(),i._rev){if(o=db(i._rev),o.error){return o}i._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[m,h,[]]]]}],g=o.prefix+1}else{i._rev_tree=[{pos:1,ids:[m,h,[]]}],g=1}}else{if(i._revisions&&(i._rev_tree=dk(i._revisions,h),g=i._revisions.start,m=i._revisions.ids[0]),!i._rev_tree){if(o=db(i._rev),o.error){return o}g=o.prefix,m=o.id,i._rev_tree=[{pos:g,ids:[m,h,[]]}]}}bJ(i._id),i._rev=g+"-"+m;var j={metadata:{},data:{}};for(var l in i){if(Object.prototype.hasOwnProperty.call(i,l)){var p="_"===l[0];if(p&&!ea[l]){var n=dX(fI,l);throw n.message=fI.message+": "+l,n}p&&!cG[l]?j.metadata[l.slice(1)]=i[l]:j.data[l]=i[l]}}return j}function j8(j){for(var h="",g=new Uint8Array(j),i=g.byteLength,k=0;i>k;k++){h+=String.fromCharCode(g[k])}return h}function aB(g){return cD(j8(g))}function cp(k,i){k=k||[],i=i||{};try{return new Blob(k,i)}catch(h){if("TypeError"!==h.name){throw h}for(var j="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,l=new j,g=0;g<k.length;g+=1){l.append(k[g])}return l.getBlob(i.type)}}function aa(j){for(var h=j.length,g=new ArrayBuffer(h),i=new Uint8Array(g),k=0;h>k;k++){i[k]=j.charCodeAt(k)}return g}function cO(h,g){return cp([aa(h)],{type:g})}function bR(h,g){return cO(f1(h),g)}function fJ(i,g){if("undefined"==typeof FileReader){return g(j8((new FileReaderSync).readAsArrayBuffer(i)))}var j=new FileReader,h="function"==typeof j.readAsBinaryString;j.onloadend=function(k){var l=k.target.result||"";return h?g(l):void g(j8(l))},h?j.readAsBinaryString(i):j.readAsArrayBuffer(i)}function bB(h,g){fJ(h,function(i){g(cD(i))})}function j1(h,g){if("undefined"==typeof FileReader){return g((new FileReaderSync).readAsArrayBuffer(h))}var i=new FileReader;i.onloadend=function(j){var k=j.target.result||new ArrayBuffer(0);g(k)},i.readAsArrayBuffer(h)}function jW(g){return cD(g)}function jN(i,g,j,h){(j>0||h<g.byteLength)&&(g=new Uint8Array(g,j,Math.min(h,g.byteLength)-j)),i.append(g)}function e3(i,g,j,h){(j>0||h<g.length)&&(g=g.substring(j,h)),i.appendBinary(g)}function jG(i,k){function g(){var q=l*h,u=q+h;if(l++,j>l){n(p,i,q,u),ck(g)}else{n(p,i,q,u);var r=p.end(!0),s=jW(r);k(s),p.destroy()}}var m="string"==typeof i,o=m?i.length:i.byteLength,h=Math.min(bG,o),j=Math.ceil(o/h),l=0,p=m?new cL:new cL.ArrayBuffer,n=m?e3:jN;g()}function d2(g){return cL.hash(g)}function jV(g,h,m){function i(o){try{return f1(o)}catch(q){var p=dX(eH,"Attachment is not a valid base64 string");return{error:p}}}function k(q,p){if(q.stub){return p()}if("string"==typeof q.data){var o=i(q.data);if(o.error){return p(o.error)}q.length=o.length,"blob"===h?q.data=cO(o,q.content_type):"base64"===h?q.data=cD(o):q.data=o,jG(o,function(r){q.digest="md5-"+r,p()})}else{j1(q.data,function(r){"binary"===h?q.data=j8(r):"base64"===h&&(q.data=aB(r)),jG(r,function(s){q.digest="md5-"+s,q.length=r.byteLength,p()})})}}function l(){n++,g.length===n&&(j?m(j):m())}if(!g.length){return m()}var j,n=0;g.forEach(function(r){function p(u){j=u,q++,q===s.length&&l()}var s=r.data&&r.data._attachments?Object.keys(r.data._attachments):[],q=0;if(!s.length){return l()}for(var o in r.data._attachments){r.data._attachments.hasOwnProperty(o)&&k(r.data._attachments[o],p)}})}function bu(l,r,j,x,i,s,B,z){if(eM(r.rev_tree,j.metadata.rev)){return x[i]=j,s()}var h=r.winningRev||cE(r),m="deleted" in r?r.deleted:fH(r,h),v="deleted" in j.metadata?j.metadata.deleted:fH(j.metadata),n=/^1-/.test(j.metadata.rev);if(m&&!v&&z&&n){var k=j.data;k._rev=h,k._id=j.metadata.id,j=bq(k,z)}var w=cP(r.rev_tree,j.metadata.rev_tree[0],l),g=z&&(m&&v||!m&&"new_leaf"!==w.conflicts||m&&!v&&"new_branch"===w.conflicts);if(g){var p=dX(cS);return x[i]=p,s()}var q=j.metadata.rev;j.metadata.rev_tree=w.tree,j.stemmedRevs=w.stemmedRevs||[],r.rev_map&&(j.metadata.rev_map=r.rev_map);var y,u=cE(j.metadata),o=fH(j.metadata,u),A=m===o?0:o>m?-1:1;y=q===u?o:fH(j.metadata,q),B(j,u,o,y,!0,A,i,s)}function jM(g){return"missing"===g.metadata.rev_tree[0].ids[1].status}function bl(i,k,q,g,m,u,j,o,r){function v(C,B,x){var A=cE(C.metadata),D=fH(C.metadata,A);if("was_delete" in o&&D){return u[B]=dX(d4,"deleted"),x()}var w=h&&jM(C);if(w){var z=dX(cS);return u[B]=z,x()}var y=D?0:1;j(C,A,D,D,!1,y,B,x)}function p(){++s===l&&r&&r()}i=i||1000;var h=o.new_edits,n=new d5.Map,s=0,l=k.length;k.forEach(function(y,w){if(y._id&&e8(y._id)){var x=y._deleted?"_removeLocal":"_putLocal";return void q[x](y,{ctx:m},function(B,A){u[w]=B||A,p()})}var z=y.metadata.id;n.has(z)?(l--,n.get(z).push([y,w])):n.set(z,[[y,w]])}),n.forEach(function(x,z){function y(){++w<x.length?A():p()}function A(){var C=x[w],E=C[0],D=C[1];if(g.has(z)){bu(i,g.get(z),E,u,D,y,j,h)}else{var B=cP([],E.metadata.rev_tree[0],i);E.metadata.rev_tree=B.tree,E.stemmedRevs=B.stemmedRevs||[],v(E,D,y)}}var w=0;A()})}function bh(h){try{return JSON.parse(h)}catch(g){return ca.parse(h)}}function t(g){return g.length<50000?JSON.parse(g):bh(g)}function dj(h){try{return JSON.stringify(h)}catch(g){return ca.stringify(h)}}function j7(j,h,g,i){try{j.apply(h,g)}catch(k){i.emit("error",k)}}function ay(h){if(!dM.running&&dM.queue.length){dM.running=!0;var g=dM.queue.shift();g.action(function(i,j){j7(g.callback,this,[i,j],h),dM.running=!1,dY.nextTick(function(){ay(h)})})}}function eh(g){return function(h){var i="unknown_error";h.target&&h.target.error&&(i=h.target.error.name||h.target.error.message),g(dX(bw,i,h.type))}}function cZ(h,g,i){return{data:dj(h),winningRev:g,deletedOrLocal:i?"1":"0",seq:h.seq,id:h.id}}function b8(h){if(!h){return null}var g=t(h.data);return g.winningRev=h.winningRev,g.deleted="1"===h.deletedOrLocal,g.seq=h.seq,g}function j0(h){if(!h){return h}var g=h._doc_id_rev.lastIndexOf(":");return h._id=h._doc_id_rev.substring(0,g-1),h._rev=h._doc_id_rev.substring(g+1),delete h._doc_id_rev,h}function dz(i,g,j,h){j?h(i?"string"!=typeof i?i:bR(i,g):cp([""],{type:g})):i?"string"!=typeof i?fJ(i,function(k){h(cD(k))}):h(i):h("")}function bk(g,h,m,i){function k(){++n===j.length&&i&&i()}function l(s,q){var r=s._attachments[q],p=r.digest,o=m.objectStore(cQ).get(p);o.onsuccess=function(u){r.body=u.target.result.body,k()}}var j=Object.keys(g._attachments||{});if(!j.length){return i&&i()}var n=0;j.forEach(function(o){h.attachments&&h.include_docs?l(g,o):(g._attachments[o].stub=!0,k())})}function bM(h,g){return cf.all(h.map(function(i){if(i.doc&&i.doc._attachments){var j=Object.keys(i.doc._attachments);return cf.all(j.map(function(n){var l=i.doc._attachments[n];if("body" in l){var m=l.body,k=l.content_type;return new cf(function(o){dz(m,k,g,function(p){i.doc._attachments[n]=dN.extend(eK(l,["digest","content_type"]),{data:p}),o()})})}}))}}))}function c3(i,k,g){function m(){n--,n||o()}function o(){h.length&&h.forEach(function(q){var r=p.index("digestSeq").count(IDBKeyRange.bound(q+"::",q+"::￿",!1,!1));r.onsuccess=function(s){var u=s.target.result;u||l["delete"](q)}})}var h=[],j=g.objectStore(dG),l=g.objectStore(cQ),p=g.objectStore(cW),n=i.length;i.forEach(function(s){var r=j.index("_doc_id_rev"),q=k+"::"+s;r.getKey(q).onsuccess=function(v){var u=v.target.result;if("number"!=typeof u){return m()}j["delete"](u);var w=p.index("seq").openCursor(IDBKeyRange.only(u));w.onsuccess=function(z){var y=z.target.result;if(y){var x=y.value.digestSeq.split("::")[0];h.push(x),p["delete"](y.primaryKey),y["continue"]()}else{m()}}}})}function aE(i,g,j){try{return{txn:i.transaction(g,j)}}catch(h){return{error:h}}}function aR(k,r,l,A,D,p,n){function u(){var P=[e7,dG,cQ,bD,cW],O=aE(D,P,"readwrite");return O.error?n(O.error):(q=O.txn,q.onabort=eh(n),q.ontimeout=eh(n),q.oncomplete=j,H=q.objectStore(e7),E=q.objectStore(dG),y=q.objectStore(cQ),o=q.objectStore(cW),void g(function(Q){return Q?(N=!0,n(Q)):void h()}))}function m(){bl(k.revs_limit,F,A,M,q,z,x,l)}function h(){function S(){++U===F.length&&m()}function Q(W){var V=b8(W.target.result);V&&M.set(V.id,V),S()}if(F.length){for(var U=0,R=0,T=F.length;T>R;R++){var P=F[R];if(P._id&&e8(P._id)){S()}else{var O=H.get(P.metadata.id);O.onsuccess=Q}}}}function j(){N||(p.notify(A._meta.name),A._meta.docCount+=B,n(null,z))}function G(P,O){var Q=y.get(P);Q.onsuccess=function(S){if(S.target.result){O()}else{var R=dX(bA,"unknown stub attachment with digest "+P);R.status=412,O(R)}}}function g(Q){function O(){++R===S.length&&Q(P)}var S=[];if(F.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(V){var U=T.data._attachments[V];U.stub&&S.push(U.digest)})}),!S.length){return Q()}var P,R=0;S.forEach(function(T){G(T,function(U){U&&!P&&(P=U),O()})})}function x(U,O,S,Q,R,T,W,P){B+=T,U.metadata.winningRev=O,U.metadata.deleted=S;var X=U.data;X._id=U.metadata.id,X._rev=U.metadata.rev,Q&&(X._deleted=!0);var V=X._attachments&&Object.keys(X._attachments).length;return V?v(U,O,S,R,W,P):void K(U,O,S,R,W,P)}function K(X,Q,S,R,U,O){function W(ao){var ai=X.stemmedRevs||[];R&&A.auto_compaction&&(ai=ai.concat(bi(X.metadata))),ai&&ai.length&&c3(ai,X.metadata.id,q),T.seq=ao.target.result,delete T.rev;var ae=cZ(T,Q,S),an=H.put(ae);an.onsuccess=Z}function P(ai){ai.preventDefault(),ai.stopPropagation();var ae=E.index("_doc_id_rev"),an=ae.getKey(V._doc_id_rev);an.onsuccess=function(ar){var ao=E.put(V,ar.target.result);ao.onsuccess=W}}function Z(){z[U]={ok:!0,id:T.id,rev:Q},M.set(X.metadata.id,X.metadata),C(X,T.seq,O)}var V=X.data,T=X.metadata;V._doc_id_rev=T.id+"::"+T.rev,delete V._id,delete V._rev;var Y=E.put(V);Y.onsuccess=W,Y.onerror=P}function v(W,P,T,R,S,U){function Y(){X===V.length&&K(W,P,T,R,S,U)}function Q(){X++,Y()}var O=W.data,X=0,V=Object.keys(O._attachments);V.forEach(function(Z){var ae=W.data._attachments[Z];if(ae.stub){X++,Y()}else{var ai=ae.data;delete ae.data,ae.revpos=parseInt(P,10);var an=ae.digest;I(an,ai,Q)}})}function C(V,S,P){function U(){++R===Q.length&&P()}function O(W){var Y=V.data._attachments[W].digest,X=o.put({seq:S,digestSeq:Y+"::"+S});X.onsuccess=U,X.onerror=function(Z){Z.preventDefault(),Z.stopPropagation(),U()}}var R=0,Q=Object.keys(V.data._attachments||{});if(!Q.length){return P()}for(var T=0;T<Q.length;T++){O(Q[T])}}function I(Q,O,R){var P=y.count(Q);P.onsuccess=function(V){var S=V.target.result;if(S){return R()}var U={digest:Q,body:O},T=y.put(U);T.onsuccess=R}}for(var q,H,E,y,o,s,F=r.docs,B=0,w=0,J=F.length;J>w;w++){var L=F[w];L._id&&e8(L._id)||(L=F[w]=bq(L,l.new_edits),L.error&&!s&&(s=L))}if(s){return n(s)}var z=new Array(F.length),M=new d5.Map,N=!1,i=A._meta.blobSupport?"blob":"base64";jV(F,i,function(O){return O?n(O):void u()})}function bf(k,i,h,j,l){try{if(k&&i){return l?IDBKeyRange.bound(i,k,!h,!1):IDBKeyRange.bound(k,i,!1,!h)}if(k){return l?IDBKeyRange.upperBound(k):IDBKeyRange.lowerBound(k)}if(i){return l?IDBKeyRange.lowerBound(i,!h):IDBKeyRange.upperBound(i,!h)}if(j){return IDBKeyRange.only(j)}}catch(g){return{error:g}}return null}function b1(i,g,j,h){return"DataError"===j.name&&0===j.code?h(null,{total_rows:i._meta.docCount,offset:g.skip,rows:[]}):void h(dX(bw,j.name,j.message))}function bs(k,i,h,j){function l(B,J){function r(L,O,M){var N=L.id+"::"+M;n.get(N).onsuccess=function(P){O.doc=j0(P.target.result),B.conflicts&&(O.doc._conflicts=d3(L)),bk(O.doc,B,x)}}function v(N,P,O){var M={id:O.id,key:O.id,value:{rev:P}},L=O.deleted;if("ok"===B.deleted){p.push(M),L?(M.value.deleted=!0,M.doc=null):B.include_docs&&r(O,M,P)}else{if(!L&&s--<=0&&(p.push(M),B.include_docs&&r(O,M,P),0===--E)){return}}N["continue"]()}function I(M){K=i._meta.docCount;var O=M.target.result;if(O){var L=b8(O.value),N=L.winningRev;v(O,N,L)}}function H(){J(null,{total_rows:K,offset:B.skip,rows:p})}function z(){B.attachments?bM(p,B.binary).then(H):H()}var A="startkey" in B?B.startkey:!1,u="endkey" in B?B.endkey:!1,o="key" in B?B.key:!1,s=B.skip||0,E="number"==typeof B.limit?B.limit:-1,y=B.inclusive_end!==!1,C="descending" in B&&B.descending?"prev":null,q=bf(A,u,y,o,C);if(q&&q.error){return b1(i,B,q.error,J)}var F=[e7,dG];B.attachments&&F.push(cQ);var G=aE(h,F,"readonly");if(G.error){return J(G.error)}var x=G.txn,w=x.objectStore(e7),m=x.objectStore(dG),D=C?w.openCursor(q,C):w.openCursor(q),n=m.index("_doc_id_rev"),p=[],K=0;x.oncomplete=z,D.onsuccess=I}function g(m,n){return 0===m.limit?n(null,{total_rows:i._meta.docCount,offset:m.skip,rows:[]}):void l(m,n)}g(k,j)}function cR(g){return new cf(function(h){var i=cp([""]);g.objectStore(aJ).put(i,"key"),g.onabort=function(j){j.preventDefault(),j.stopPropagation(),h(!1)},g.oncomplete=function(){var j=navigator.userAgent.match(/Chrome\/(\d+)/),k=navigator.userAgent.match(/Edge\//);h(k||!j||parseInt(j[1],10)>=43)}})["catch"](function(){return !1})}function eg(h,g){var i=this;dM.queue.push({action:function(j){aO(i,h,j)},callback:g}),ay(i.constructor)}function aO(g,h,l){function n(x){var w=x.createObjectStore(e7,{keyPath:"id"});x.createObjectStore(dG,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),x.createObjectStore(cQ,{keyPath:"digest"}),x.createObjectStore(cN,{keyPath:"id",autoIncrement:!1}),x.createObjectStore(aJ),w.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),x.createObjectStore(bD,{keyPath:"_id"});var v=x.createObjectStore(cW,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function o(x,w){var v=x.objectStore(e7);v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),v.openCursor().onsuccess=function(z){var B=z.target.result;if(B){var y=B.value,A=fH(y);y.deletedOrLocal=A?"1":"0",v.put(y),B["continue"]()}else{w()}}}function k(v){v.createObjectStore(bD,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function u(z,w){var v=z.objectStore(bD),x=z.objectStore(e7),y=z.objectStore(dG),A=x.openCursor();A.onsuccess=function(H){var E=H.target.result;if(E){var K=E.value,B=K.id,M=e8(B),J=cE(K);if(M){var G=B+"::"+J,D=B+"::",I=B+"::~",F=y.index("_doc_id_rev"),C=IDBKeyRange.bound(D,I,!1,!1),L=F.openCursor(C);L.onsuccess=function(N){if(L=N.target.result){var O=L.value;O._doc_id_rev===G&&v.put(O),y["delete"](L.primaryKey),L["continue"]()}else{x["delete"](E.primaryKey),E["continue"]()}}}else{E["continue"]()}}else{w&&w()}}}function p(w){var v=w.createObjectStore(cW,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function q(z,w){var v=z.objectStore(dG),x=z.objectStore(cQ),y=z.objectStore(cW),A=x.count();A.onsuccess=function(B){var C=B.target.result;return C?void (v.openCursor().onsuccess=function(L){var H=L.target.result;if(!H){return w()}for(var G=H.value,J=H.primaryKey,D=Object.keys(G._attachments||{}),F={},E=0;E<D.length;E++){var M=G._attachments[D[E]];F[M.digest]=!0}var K=Object.keys(F);for(E=0;E<K.length;E++){var I=K[E];y.put({seq:J,digestSeq:I+"::"+J})}H["continue"]()}):w()}}function i(v){function w(A){return A.data?b8(A):(A.deleted="1"===A.deletedOrLocal,A)}var z=v.objectStore(dG),y=v.objectStore(e7),x=y.openCursor();x.onsuccess=function(C){function D(){var H=B.id+"::",F=B.id+"::￿",G=z.index("_doc_id_rev").openCursor(IDBKeyRange.bound(H,F)),I=0;G.onsuccess=function(K){var J=K.target.result;if(!J){return B.seq=I,A()}var L=J.primaryKey;L>I&&(I=L),J["continue"]()}}function A(){var G=cZ(B,B.winningRev,B.deleted),F=y.put(G);F.onsuccess=function(){E["continue"]()}}var E=C.target.result;if(E){var B=w(E.value);return B.winningRev=B.winningRev||cE(B),B.seq?A():void D()}}}var m=h.name,j=null;g._meta=null,g.type=function(){return"idb"},g._id=f3(function(v){v(null,g._meta.instanceId)}),g._bulkDocs=function(v,w,x){aR(h,v,w,g,j,bX,x)},g._get=function(v,z,y){function C(){y(w,{doc:D,metadata:B,ctx:A})}var D,B,w,A=z.ctx;if(!A){var x=aE(j,[e7,dG,cQ],"readonly");if(x.error){return y(x.error)}A=x.txn}A.objectStore(e7).get(v).onsuccess=function(E){if(B=b8(E.target.result),!B){return w=dX(d4,"missing"),C()}if(fH(B)&&!z.rev){return w=dX(d4,"deleted"),C()}var G=A.objectStore(dG),H=z.rev||B.winningRev,F=B.id+"::"+H;G.index("_doc_id_rev").get(F).onsuccess=function(I){return D=I.target.result,D&&(D=j0(D)),D?void C():(w=dX(d4,"missing"),C())}}},g._getAttachment=function(v,z,y,C,D){var B;if(C.ctx){B=C.ctx}else{var w=aE(j,[e7,dG,cQ],"readonly");if(w.error){return D(w.error)}B=w.txn}var A=y.digest,x=y.content_type;B.objectStore(cQ).get(A).onsuccess=function(E){var F=E.target.result.body;dz(F,x,C.binary,function(G){D(null,G)})}},g._info=function(A){if(null===j||!dL.has(m)){var y=new Error("db isn't open");return y.id="idbNull",A(y)}var v,z,B=aE(j,[dG],"readonly");if(B.error){return A(B.error)}var w=B.txn,x=w.objectStore(dG).openCursor(null,"prev");x.onsuccess=function(D){var C=D.target.result;v=C?C.key:0,z=g._meta.docCount},w.oncomplete=function(){A(null,{doc_count:z,update_seq:v,idb_attachment_format:g._meta.blobSupport?"binary":"base64"})}},g._allDocs=function(v,w){bs(v,g,j,w)},g._changes=function(E){function B(N){function T(){return S.seq!==O?N["continue"]():(I=O,S.winningRev===P._rev?R(P):void Q())}function Q(){var U=P._id+"::"+S.winningRev,V=z.get(U);V.onsuccess=function(W){R(j0(W.target.result))}}function R(V){var W=E.processChange(V,S,E);W.seq=S.seq;var U=G(W);return"object"==typeof U?E.complete(U):(U&&(J++,x&&v.push(W),E.attachments&&E.include_docs?bk(V,E,L,function(){bM([W],E.binary).then(function(){E.onChange(W)})}):E.onChange(W)),void (J!==w&&N["continue"]()))}var P=j0(N.value),O=N.key;if(F&&!F.has(P._id)){return N["continue"]()}var S;return(S=y.get(P._id))?T():void (M.get(P._id).onsuccess=function(U){S=b8(U.target.result),y.set(P._id,S),T()})}function H(N){var O=N.target.result;O&&B(O)}function K(){var P=[e7,dG];E.attachments&&P.push(cQ);var O=aE(j,P,"readonly");if(O.error){return E.complete(O.error)}L=O.txn,L.onabort=eh(E.complete),L.oncomplete=D,C=L.objectStore(dG),M=L.objectStore(e7),z=C.index("_doc_id_rev");var N;N=E.descending?C.openCursor(null,"prev"):C.openCursor(IDBKeyRange.lowerBound(E.since,!0)),N.onsuccess=H}function D(){function N(){E.complete(null,{results:v,last_seq:I})}!E.continuous&&E.attachments?bM(v).then(N):N()}if(E=c1(E),E.continuous){var A=m+":"+cI();return bX.addListener(m,A,g,E),bX.notify(m),{cancel:function(){bX.removeListener(m,A)}}}var F=E.doc_ids&&new d5.Set(E.doc_ids);E.since=E.since||0;var I=E.since,w="limit" in E?E.limit:-1;0===w&&(w=1);var x;x="return_docs" in E?E.return_docs:"returnDocs" in E?E.returnDocs:!0;var L,C,M,z,v=[],J=0,G=eU(E),y=new d5.Map;K()},g._close=function(v){return null===j?v(dX(aC)):(j.close(),dL["delete"](m),j=null,void v())},g._getRevisionTree=function(v,w){var z=aE(j,[e7],"readonly");if(z.error){return w(z.error)}var y=z.txn,x=y.objectStore(e7).get(v);x.onsuccess=function(B){var A=b8(B.target.result);A?w(null,A.rev_tree):w(dX(d4))}},g._doCompaction=function(y,A,z){var x=[e7,dG,cQ,cW],v=aE(j,x,"readwrite");if(v.error){return z(v.error)}var B=v.txn,w=B.objectStore(e7);w.get(y).onsuccess=function(E){var C=b8(E.target.result);dd(C.rev_tree,function(L,H,K,G,J){var I=H+"-"+K;-1!==A.indexOf(I)&&(J.status="missing")}),c3(A,y,B);var D=C.winningRev,F=C.deleted;B.objectStore(e7).put(cZ(C,D,F))},B.onabort=eh(z),B.oncomplete=function(){z()}},g._getLocal=function(v,w){var z=aE(j,[bD],"readonly");if(z.error){return w(z.error)}var y=z.txn,x=y.objectStore(bD).get(v);x.onerror=eh(w),x.onsuccess=function(B){var A=B.target.result;A?(delete A._doc_id_rev,w(null,A)):w(dX(d4))}},g._putLocal=function(E,z,x){"function"==typeof z&&(x=z,z={}),delete E._revisions;var C=E._rev,D=E._id;C?E._rev="0-"+(parseInt(C.split("-")[1],10)+1):E._rev="0-1";var B,w=z.ctx;if(!w){var A=aE(j,[bD],"readwrite");if(A.error){return x(A.error)}w=A.txn,w.onerror=eh(x),w.oncomplete=function(){B&&x(null,B)}}var y,v=w.objectStore(bD);C?(y=v.get(D),y.onsuccess=function(H){var G=H.target.result;if(G&&G._rev===C){var F=v.put(E);F.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)}}else{x(dX(cS))}}):(y=v.add(E),y.onerror=function(F){x(dX(cS)),F.preventDefault(),F.stopPropagation()},y.onsuccess=function(){B={ok:!0,id:E._id,rev:E._rev},z.ctx&&x(null,B)})},g._removeLocal=function(v,z,y){"function"==typeof z&&(y=z,z={});var C=z.ctx;if(!C){var D=aE(j,[bD],"readwrite");if(D.error){return y(D.error)}C=D.txn,C.oncomplete=function(){B&&y(null,B)}}var B,w=v._id,A=C.objectStore(bD),x=A.get(w);x.onerror=eh(y),x.onsuccess=function(F){var E=F.target.result;E&&E._rev===v._rev?(A["delete"](w),B={ok:!0,id:w,rev:"0-0"},z.ctx&&y(null,B)):y(dX(d4))}},g._destroy=function(y,w){bX.removeAllListeners(m);var v=ag.get(m);v&&v.result&&(v.result.close(),dL["delete"](m));var x=indexedDB.deleteDatabase(m);x.onsuccess=function(){ag["delete"](m),eB()&&m in localStorage&&delete localStorage[m],w(null,{ok:!0})},x.onerror=eh(w)};var s=dL.get(m);if(s){return j=s.idb,g._meta=s.global,void dY.nextTick(function(){l(null,g)})}var r;r=h.storage?b4(m,h.storage):indexedDB.open(m,cA),ag.set(m,r),r.onupgradeneeded=function(w){function z(){var B=y[A-1];A++,B&&B(v,z)}var x=w.target.result;if(w.oldVersion<1){return n(x)}var v=w.currentTarget.transaction;w.oldVersion<3&&k(x),w.oldVersion<4&&p(x);var y=[o,u,q,i],A=w.oldVersion;z()},r.onsuccess=function(x){j=x.target.result,j.onversionchange=function(){j.close(),dL["delete"](m)},j.onabort=function(B){aL("error","Database has a global failure",B.target.error),j.close(),dL["delete"](m)};var v=j.transaction([cN,aJ,e7],"readwrite"),y=v.objectStore(cN).get(cN),w=null,z=null,A=null;y.onsuccess=function(D){var B=function(){null!==w&&null!==z&&null!==A&&(g._meta={name:m,instanceId:A,blobSupport:w,docCount:z},dL.set(m,{idb:j,global:g._meta}),l(null,g))},E=D.target.result||{id:cN};m+"_id" in E?(A=E[m+"_id"],B()):(A=cI(),E[m+"_id"]=A,v.objectStore(cN).put(E).onsuccess=function(){B()}),bE||(bE=cR(v)),bE.then(function(F){w=F,B()});var C=v.objectStore(e7).index("deletedOrLocal");C.count(IDBKeyRange.only("0")).onsuccess=function(F){z=F.target.result,B()}}},r.onerror=function(){var v="Failed to open indexedDB, are you in private browsing mode?";aL("error",v),l(dX(bw,v))}}function b4(h,g){try{return indexedDB.open(h,{version:cA,storage:g})}catch(i){return indexedDB.open(h,cA)}}function al(g){g.adapter("idb",eg,!0)}function am(g){return decodeURIComponent(escape(g))}function cw(g){return 65>g?g-48:g-55}function aG(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(cw(i.charCodeAt(g++))<<4|cw(i.charCodeAt(g++)))}return h}function cX(i,g,j){for(var h="";j>g;){h+=String.fromCharCode(cw(i.charCodeAt(g+2))<<12|cw(i.charCodeAt(g+3))<<8|cw(i.charCodeAt(g))<<4|cw(i.charCodeAt(g+1))),g+=4}return h}function cy(h,g){return"UTF-8"===g?am(aG(h,0,h.length)):cX(h,0,h.length)}function bY(g){return"'"+g+"'"}function aq(g){return g.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function c5(g){return g.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function b5(g){return delete g._id,delete g._rev,JSON.stringify(g)}function aw(h,g,i){return h=JSON.parse(h),h._id=g,h._rev=i,h}function dW(h){for(var g="(";h--;){g+="?",h&&(g+=",")}return g+")"}function aV(j,h,g,i,k){return"SELECT "+j+" FROM "+("string"==typeof h?h:h.join(" JOIN "))+(g?" ON "+g:"")+(i?" WHERE "+("string"==typeof i?i:i.join(" AND ")):"")+(k?" ORDER BY "+k:"")}function aS(m,k,g){function l(){++j===m.length&&i()}function i(){if(h.length){var n="SELECT DISTINCT digest AS digest FROM "+c7+" WHERE seq IN "+dW(h.length);g.executeSql(n,h,function(q,o){for(var s=[],p=0;p<o.rows.length;p++){s.push(o.rows.item(p).digest)}if(s.length){var r="DELETE FROM "+c7+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";q.executeSql(r,h,function(v){var u="SELECT digest FROM "+c7+" WHERE digest IN ("+s.map(function(){return"?"}).join(",")+")";v.executeSql(u,s,function(z,w){for(var y=new d5.Set,x=0;x<w.rows.length;x++){y.add(w.rows.item(x).digest)}s.forEach(function(A){y.has(A)||(z.executeSql("DELETE FROM "+c7+" WHERE digest=?",[A]),z.executeSql("DELETE FROM "+aH+" WHERE digest=?",[A]))})})})}})}}if(m.length){var j=0,h=[];m.forEach(function(o){var n="SELECT seq FROM "+f4+" WHERE doc_id=? AND rev=?";g.executeSql(n,[k,o],function(q,p){if(!p.rows.length){return l()}var r=p.rows.item(0).seq;h.push(r),q.executeSql("DELETE FROM "+f4+" WHERE seq=?",[r],l)})})}}function dQ(g){return function(h){aL("error","WebSQL threw an error",h);var k=h&&h.constructor.toString().match(/function ([^\(]+)/),i=k&&k[1]||h.type,j=h.target||h.message;g(dX(dP,j,i))}}function aM(h){if("size" in h){return 1000000*h.size}var g="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return g?5000000:1}function cH(s,B,m,i,k,y,x){function g(){return r?x(r):(y.notify(i._name),i._docCount=-1,void x(null,A))}function q(E,D){var F="SELECT count(*) as cnt FROM "+aH+" WHERE digest=?";p.executeSql(F,[E],function(G,H){if(0===H.rows.item(0).cnt){var I=dX(bA,"unknown stub attachment with digest "+E);D(I)}else{D()}})}function u(F){function D(){++G===H.length&&F(E)}var H=[];if(o.forEach(function(I){I.data&&I.data._attachments&&Object.keys(I.data._attachments).forEach(function(J){var K=I.data._attachments[J];K.stub&&H.push(K.digest)})}),!H.length){return F()}var E,G=0;H.forEach(function(I){q(I,function(J){J&&!E&&(E=J),D()})})}function j(G,O,J,E,R,L,Q,N){function I(){function Y(ar,at){function a0(){return ++ae===ao.length&&at(),!1}function ai(a1){var a2="INSERT INTO "+c7+" (digest, seq) VALUES (?,?)",a3=[X._attachments[a1].digest,ar];p.executeSql(a2,a3,a0,a0)}var ae=0,ao=Object.keys(X._attachments||{});if(!ao.length){return at()}for(var an=0;an<ao.length;an++){ai(ao[an])}}var X=G.data,S=E?1:0,V=X._id,Z=X._rev,T=b5(X),U="INSERT INTO "+f4+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",W=[V,Z,T,S];p.executeSql(U,W,function(an,ai){var ae=ai.insertId;Y(ae,function(){H(an,ae)})},function(){var ae=aV("seq",f4,null,"doc_id=? AND rev=?");return p.executeSql(ae,[V,Z],function(ai,an){var ao=an.rows.item(0).seq,ar="UPDATE "+f4+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",at=[T,S,V,Z];ai.executeSql(ar,at,function(a0){Y(ao,function(){H(a0,ao)})})}),!1})}function F(S){D||(S?(D=S,N(D)):M===K.length&&I())}function P(S){M++,F(S)}function H(T,S){var V=G.metadata.id,U=G.stemmedRevs||[];R&&i.auto_compaction&&(U=bi(G.metadata).concat(U)),U.length&&aS(U,V,T),G.metadata.seq=S,delete G.metadata.rev;var W=R?"UPDATE "+a9+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+f4+" WHERE doc_id="+a9+".id AND rev=?) WHERE id=?":"INSERT INTO "+a9+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",X=dj(G.metadata),Y=R?[X,S,O,V]:[V,S,S,X];T.executeSql(W,Y,function(){A[Q]={ok:!0,id:G.metadata.id,rev:O},w.set(V,G.metadata),N()})}var D=null,M=0;G.data._id=G.metadata.id,G.data._rev=G.metadata.rev;var K=Object.keys(G.data._attachments||{});E&&(G.data._deleted=!0),K.forEach(function(U){var S=G.data._attachments[U];if(S.stub){M++,F()}else{var T=S.data;delete S.data,S.revpos=parseInt(O,10);var V=S.digest;C(V,T,P)}}),K.length||I()}function h(){bl(s.revs_limit,o,i,w,p,A,j,m)}function n(E){function D(){++F===o.length&&E()}if(!o.length){return E()}var F=0;o.forEach(function(G){if(G._id&&e8(G._id)){return D()}var H=G.metadata.id;p.executeSql("SELECT json FROM "+a9+" WHERE id = ?",[H],function(J,I){if(I.rows.length){var K=t(I.rows.item(0).json);w.set(H,K)}D()})})}function C(F,D,G){var E="SELECT digest FROM "+aH+" WHERE digest=?";p.executeSql(E,[F],function(H,I){return I.rows.length?G():(E="INSERT INTO "+aH+" (digest, body, escaped) VALUES (?,?,1)",void H.executeSql(E,[F,aq(D)],function(){G()},function(){return G(),!1}))})}var z=m.new_edits,l=B.docs,o=l.map(function(E){if(E._id&&e8(E._id)){return E}var D=bq(E,z);return D}),v=o.filter(function(D){return D.error});if(v.length){return x(v[0])}var p,r,A=new Array(o.length),w=new d5.Map;jV(o,"binary",function(D){return D?x(D):void k.transaction(function(E){p=E,u(function(F){F?r=F:n(h)})},dQ(x),g)})}function cK(g){return g.websql(g.name,g.version,g.description,g.size)}function j6(h){try{return{db:cK(h)}}catch(g){return{error:g}}}function dl(h){var g=kf.get(h.name);return g||(g=j6(h),kf.set(h.name,g),g.db&&(g.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),g}function ej(g,i,l,j,m){function n(){++o===k.length&&m&&m()}function h(q,s){var r=q._attachments[s],p={binary:i.binary,ctx:j};l._getAttachment(q._id,s,r,p,function(u,v){q._attachments[s]=dN.extend(eK(r,["digest","content_type"]),{data:v}),n()})}var k=Object.keys(g._attachments||{});if(!k.length){return m&&m()}var o=0;k.forEach(function(p){i.attachments&&i.include_docs?h(g,p):(g._attachments[p].stub=!0,n())})}function jJ(v,h){function D(){eB()&&(window.localStorage["_pouch__websqldb_"+y._name]=!0),h(null,y)}function j(F,E){F.executeSql(el),F.executeSql("ALTER TABLE "+f4+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){F.executeSql(ab),F.executeSql("ALTER TABLE "+a9+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){F.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+a9+" (local, id)");var G="SELECT "+a9+".winningseq AS seq, "+a9+".json AS metadata FROM "+f4+" JOIN "+a9+" ON "+f4+".seq = "+a9+".winningseq";F.executeSql(G,[],function(I,M){for(var H=[],K=[],L=0;L<M.rows.length;L++){var N=M.rows.item(L),O=N.seq,J=JSON.parse(N.metadata);fH(J)&&H.push(O),e8(J.id)&&K.push(J.id)}I.executeSql("UPDATE "+a9+"SET local = 1 WHERE id IN "+dW(K.length),K,function(){I.executeSql("UPDATE "+f4+" SET deleted = 1 WHERE seq IN "+dW(H.length),H,E)})})})})}function p(F,E){var G="CREATE TABLE IF NOT EXISTS "+jT+" (id UNIQUE, rev, json)";F.executeSql(G,[],function(){var H="SELECT "+a9+".id AS id, "+f4+".json AS data FROM "+f4+" JOIN "+a9+" ON "+f4+".seq = "+a9+".winningseq WHERE local = 1";F.executeSql(H,[],function(L,I){function K(){if(!M.length){return E(L)}var O=M.shift(),N=JSON.parse(O.data)._rev;L.executeSql("INSERT INTO "+jT+" (id, rev, json) VALUES (?,?,?)",[O.id,N,O.data],function(P){P.executeSql("DELETE FROM "+a9+" WHERE id=?",[O.id],function(Q){Q.executeSql("DELETE FROM "+f4+" WHERE seq=?",[O.seq],function(){K()})})})}for(var M=[],J=0;J<I.rows.length;J++){M.push(I.rows.item(J))}K()})})}function n(G,E){function H(J){function I(){if(!J.length){return E(G)}var L=J.shift(),P=cy(L.hex,g),M=P.lastIndexOf("::"),K=P.substring(0,M),O=P.substring(M+2),N="UPDATE "+f4+" SET doc_id=?, rev=? WHERE doc_id_rev=?";G.executeSql(N,[K,O,P],function(){I()})}I()}var F="ALTER TABLE "+f4+" ADD COLUMN doc_id";G.executeSql(F,[],function(J){var I="ALTER TABLE "+f4+" ADD COLUMN rev";J.executeSql(I,[],function(K){K.executeSql(bg,[],function(L){var M="SELECT hex(doc_id_rev) as hex FROM "+f4;L.executeSql(M,[],function(P,N){for(var O=[],Q=0;Q<N.rows.length;Q++){O.push(N.rows.item(Q))}H(O)})})})})}function C(G,E){function H(I){var J="SELECT COUNT(*) AS cnt FROM "+aH;I.executeSql(J,[],function(K,M){function P(){var Q=aV(aF+", "+a9+".id AS id",[a9,f4],cT,null,a9+".id ");Q+=" LIMIT "+N+" OFFSET "+O,O+=N,K.executeSql(Q,[],function(ai,T){function X(at,ar){var ao=V[at]=V[at]||[];-1===ao.indexOf(ar)&&ao.push(ar)}if(!T.rows.length){return E(ai)}for(var V={},an=0;an<T.rows.length;an++){for(var S=T.rows.item(an),R=aw(S.data,S.id,S.rev),W=Object.keys(R._attachments||{}),Z=0;Z<W.length;Z++){var U=R._attachments[W[Z]];X(U.digest,S.seq)}}var ae=[];if(Object.keys(V).forEach(function(ar){var ao=V[ar];ao.forEach(function(at){ae.push([ar,at])})}),!ae.length){return P()}var Y=0;ae.forEach(function(ao){var ar="INSERT INTO "+c7+" (digest, seq) VALUES (?,?)";ai.executeSql(ar,ao,function(){++Y===ae.length&&P()})})})}var L=M.rows.item(0).cnt;if(!L){return E(K)}var O=0,N=10;P()})}var F="CREATE TABLE IF NOT EXISTS "+c7+" (digest, seq INTEGER)";G.executeSql(F,[],function(I){I.executeSql(bT,[],function(J){J.executeSql(cg,[],H)})})}function s(F,E){var G="ALTER TABLE "+aH+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";F.executeSql(G,[],E)}function r(F,E){var G="ALTER TABLE "+a9+" ADD COLUMN max_seq INTEGER";F.executeSql(G,[],function(I){var H="UPDATE "+a9+" SET max_seq=(SELECT MAX(seq) FROM "+f4+" WHERE doc_id=id)";I.executeSql(H,[],function(J){var K="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+a9+" (max_seq)";J.executeSql(K,[],E)})})}function x(F,E){F.executeSql('SELECT HEX("a") AS hex',[],function(I,G){var H=G.rows.item(0).hex;g=2===H.length?"UTF-8":"UTF-16",E()})}function B(){for(;l.length>0;){var E=l.pop();E(null,k)}}function w(E,M){if(0===M){var J="CREATE TABLE IF NOT EXISTS "+bL+" (dbid, db_version INTEGER)",G="CREATE TABLE IF NOT EXISTS "+aH+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",P="CREATE TABLE IF NOT EXISTS "+c7+" (digest, seq INTEGER)",N="CREATE TABLE IF NOT EXISTS "+a9+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",O="CREATE TABLE IF NOT EXISTS "+f4+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",I="CREATE TABLE IF NOT EXISTS "+jT+" (id UNIQUE, rev, json)";E.executeSql(G),E.executeSql(I),E.executeSql(P,[],function(){E.executeSql(cg),E.executeSql(bT)}),E.executeSql(N,[],function(){E.executeSql(el),E.executeSql(O,[],function(){E.executeSql(ab),E.executeSql(bg),E.executeSql(J,[],function(){var R="INSERT INTO "+bL+" (db_version, dbid) VALUES (?,?)";k=cI();var Q=[cB,k];E.executeSql(R,Q,function(){B()})})})})}else{var K=function(){var Q=cB>M;Q&&E.executeSql("UPDATE "+bL+" SET db_version = "+cB);var R="SELECT dbid FROM "+bL;E.executeSql(R,[],function(T,S){k=S.rows.item(0).dbid,B()})},H=[j,p,n,C,s,r,K],F=M,L=function(Q){H[F-1](Q,L),F++};L(E)}}function m(){q.transaction(function(E){x(E,function(){A(E)})},dQ(h),D)}function A(F){var E="SELECT sql FROM sqlite_master WHERE tbl_name = "+bL;F.executeSql(E,[],function(H,G){G.rows.length?/db_version/.test(G.rows.item(0).sql)?H.executeSql("SELECT db_version FROM "+bL,[],function(J,I){var K=I.rows.item(0).db_version;w(J,K)}):H.executeSql("ALTER TABLE "+bL+" ADD COLUMN db_version INTEGER",[],function(){w(H,1)}):w(H,0)})}function o(F,E){if(-1!==y._docCount){return E(y._docCount)}var G=aV("COUNT("+a9+".id) AS 'num'",[a9,f4],cT,f4+".deleted=0");F.executeSql(G,[],function(I,H){y._docCount=H.rows.item(0).num,E(y._docCount)})}var g,y=this,k=null,z=aM(v),l=[];y._docCount=-1,y._name=v.name;var i=dN.extend({},v,{version:bN,description:v.name,size:z}),u=dl(i);if(u.error){return dQ(h)(u.error)}var q=u.db;"function"!=typeof q.readTransaction&&(q.readTransaction=q.transaction),m(),y.type=function(){return"websql"},y._id=f3(function(E){E(null,k)}),y._info=function(E){q.readTransaction(function(F){o(F,function(H){var G="SELECT MAX(seq) AS seq FROM "+f4;F.executeSql(G,[],function(I,J){var K=J.rows.item(0).seq||0;E(null,{doc_count:H,update_seq:K,sqlite_plugin:q._sqlitePlugin,websql_encoding:g})})})},dQ(E))},y._bulkDocs=function(E,G,F){cH(v,E,G,y,q,aW,F)},y._get=function(F,G,N){function K(){N(I,{doc:L,metadata:E,ctx:M})}var L,E,I,M=G.ctx;if(!M){return q.readTransaction(function(O){y._get(F,dN.extend({ctx:O},G),N)})}var J,H;G.rev?(J=aV(aF,[a9,f4],a9+".id="+f4+".doc_id",[f4+".doc_id=?",f4+".rev=?"]),H=[F,G.rev]):(J=aV(aF,[a9,f4],cT,a9+".id=?"),H=[F]),M.executeSql(J,H,function(O,P){if(!P.rows.length){return I=dX(d4,"missing"),K()}var Q=P.rows.item(0);return E=t(Q.metadata),Q.deleted&&!G.rev?(I=dX(d4,"deleted"),K()):(L=aw(Q.data,E.id,Q.rev),void K())})},y._allDocs=function(E,O){var P,I=[],K="startkey" in E?E.startkey:!1,F="endkey" in E?E.endkey:!1,M="key" in E?E.key:!1,Q="descending" in E?E.descending:!1,N="limit" in E?E.limit:-1,L="skip" in E?E.skip:0,H=E.inclusive_end!==!1,R=[],J=[];if(M!==!1){J.push(a9+".id = ?"),R.push(M)}else{if(K!==!1||F!==!1){if(K!==!1&&(J.push(a9+".id "+(Q?"<=":">=")+" ?"),R.push(K)),F!==!1){var G=Q?">":"<";H&&(G+="="),J.push(a9+".id "+G+" ?"),R.push(F)}M!==!1&&(J.push(a9+".id = ?"),R.push(M))}}"ok"!==E.deleted&&J.push(f4+".deleted = 0"),q.readTransaction(function(S){o(S,function(U){if(P=U,0!==N){var T=aV(aF,[a9,f4],cT,J,a9+".id "+(Q?"DESC":"ASC"));T+=" LIMIT "+N+" OFFSET "+L,S.executeSql(T,R,function(W,Z){for(var Y=0,ao=Z.rows.length;ao>Y;Y++){var V=Z.rows.item(Y),X=t(V.metadata),an=X.id,ar=aw(V.data,an,V.rev),ai=ar._rev,ae={id:an,key:an,value:{rev:ai}};if(E.include_docs&&(ae.doc=ar,ae.doc._rev=ai,E.conflicts&&(ae.doc._conflicts=d3(X)),ej(ae.doc,E,y,W)),V.deleted){if("ok"!==E.deleted){continue}ae.value.deleted=!0,ae.doc=null}I.push(ae)}})}})},dQ(O),function(){O(null,{total_rows:P,offset:E.skip,rows:I})})},y._changes=function(E){function F(){var S=a9+".json AS metadata, "+a9+".max_seq AS maxSeq, "+f4+".json AS winningDoc, "+f4+".rev AS winningRev ",T=a9+" JOIN "+f4,R=a9+".id="+f4+".doc_id AND "+a9+".winningseq="+f4+".seq",Q=["maxSeq > ?"],O=[E.since];E.doc_ids&&(Q.push(a9+".id IN "+dW(E.doc_ids.length)),O=O.concat(E.doc_ids));var U="maxSeq "+(J?"DESC":"ASC"),N=aV(S,T,R,Q,U),M=eU(E);E.view||E.filter||(N+=" LIMIT "+G);var P=E.since||0;q.readTransaction(function(V){V.executeSql(N,O,function(ai,an){function Z(a0){return function(){E.onChange(a0)}}for(var at=0,ar=an.rows.length;ar>at;at++){var ao=an.rows.item(at),W=t(ao.metadata);P=ao.maxSeq;var ae=aw(ao.winningDoc,W.id,ao.winningRev),Y=E.processChange(ae,W,E);Y.seq=ao.maxSeq;var X=M(Y);if("object"==typeof X){return E.complete(X)}if(X&&(I++,L&&K.push(Y),E.attachments&&E.include_docs?ej(ae,E,y,ai,Z(Y)):Z(Y)()),I===G){break}}})},dQ(E.complete),function(){E.continuous||E.complete(null,{results:K,last_seq:P})})}if(E=c1(E),E.continuous){var H=y._name+":"+cI();return aW.addListener(y._name,H,y,E),aW.notify(y._name),{cancel:function(){aW.removeListener(y._name,H)}}}var J=E.descending;E.since=E.since&&!J?E.since:0;var G="limit" in E?E.limit:-1;0===G&&(G=1);var L;L="return_docs" in E?E.return_docs:"returnDocs" in E?E.returnDocs:!0;var K=[],I=0;F()},y._close=function(E){E()},y._getAttachment=function(F,G,N,K,L){var E,I=K.ctx,M=N.digest,J=N.content_type,H="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+aH+" WHERE digest=?";I.executeSql(H,[M],function(P,O){var Q=O.rows.item(0),R=Q.escaped?c5(Q.body):cy(Q.body,g);E=K.binary?cO(R,J):cD(R),L(null,E)})},y._getRevisionTree=function(F,E){q.readTransaction(function(H){var G="SELECT json AS metadata FROM "+a9+" WHERE id = ?";H.executeSql(G,[F],function(J,K){if(K.rows.length){var I=t(K.rows.item(0).metadata);E(null,I.rev_tree)}else{E(dX(d4))}})})},y._doCompaction=function(F,E,G){return E.length?void q.transaction(function(H){var I="SELECT json AS metadata FROM "+a9+" WHERE id = ?";H.executeSql(I,[F],function(L,J){var K=t(J.rows.item(0).metadata);dd(K.rev_tree,function(O,Q,N,P,S){var R=Q+"-"+N;-1!==E.indexOf(R)&&(S.status="missing")});var M="UPDATE "+a9+" SET json = ? WHERE id = ?";L.executeSql(M,[dj(K),F])}),aS(E,F,H)},dQ(G),function(){G()}):G()},y._getLocal=function(F,E){q.readTransaction(function(H){var G="SELECT json, rev FROM "+jT+" WHERE id=?";H.executeSql(G,[F],function(L,J){if(J.rows.length){var K=J.rows.item(0),I=aw(K.json,F,K.rev);E(null,I)}else{E(dX(d4))}})})},y._putLocal=function(M,H,K){function I(N){var P,O;L?(P="UPDATE "+jT+" SET rev=?, json=? WHERE id=? AND rev=?",O=[J,G,F,L]):(P="INSERT INTO "+jT+" (id, rev, json) VALUES (?,?,?)",O=[F,J,G]),N.executeSql(P,O,function(R,Q){Q.rowsAffected?(E={ok:!0,id:F,rev:J},H.ctx&&K(null,E)):K(dX(cS))},function(){return K(dX(cS)),!1})}"function"==typeof H&&(K=H,H={}),delete M._revisions;var J,L=M._rev,F=M._id;J=L?M._rev="0-"+(parseInt(L.split("-")[1],10)+1):M._rev="0-1";var E,G=b5(M);H.ctx?I(H.ctx):q.transaction(I,dQ(K),function(){E&&K(null,E)})},y._removeLocal=function(H,F,E){function G(L){var K="DELETE FROM "+jT+" WHERE id=? AND rev=?",J=[H._id,H._rev];L.executeSql(K,J,function(N,M){return M.rowsAffected?(I={ok:!0,id:H._id,rev:"0-0"},void (F.ctx&&E(null,I))):E(dX(d4))})}"function"==typeof F&&(E=F,F={});var I;F.ctx?G(F.ctx):q.transaction(G,dQ(E),function(){I&&E(null,I)})},y._destroy=function(F,E){aW.removeAllListeners(y._name),q.transaction(function(H){var G=[a9,f4,aH,bL,jT,c7];G.forEach(function(I){H.executeSql("DROP TABLE IF EXISTS "+I,[])})},dQ(E),function(){eB()&&(delete window.localStorage["_pouch__websqldb_"+y._name],delete window.localStorage[y._name]),E(null,{ok:!0})})}}function aY(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(g){return !1}}function dA(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var h=eB(),g="_pouch__websqldb_valid_"+navigator.userAgent;if(h&&localStorage[g]){return"1"===localStorage[g]}var i=aY();return h&&(localStorage[g]=i?"1":"0"),i}function cm(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:dA()}function dh(g){return function(i,l,j,k){if("undefined"!=typeof sqlitePlugin){var h=dN.extend({},g,{name:i,version:l,description:j,size:k});return sqlitePlugin.openDatabase(h)}return openDatabase(i,l,j,k)}}function e1(i,g){var j=dh(i),h=dN.extend({websql:j},i);jJ.call(this,h,g)}function jZ(g){g.adapter("websql",e1,!0)}function cq(){for(var i={},g=new cf(function(k,l){i.resolve=k,i.reject=l}),j=new Array(arguments.length),h=0;h<j.length;h++){j[h]=arguments[h]}return i.promise=g,cf.resolve().then(function(){return fetch.apply(null,j)}).then(function(k){i.resolve(k)})["catch"](function(k){i.reject(k)}),i}function aj(m,k){var g,l,i,j=new Headers,h={method:m.method,credentials:"include",headers:j};return m.json&&(j.set("Accept","application/json"),j.set("Content-Type",m.headers["Content-Type"]||"application/json")),m.body&&m.body instanceof Blob?j1(m.body,function(n){h.body=n}):m.body&&m.processData&&"string"!=typeof m.body?h.body=JSON.stringify(m.body):"body" in m?h.body=m.body:h.body=null,Object.keys(m.headers).forEach(function(n){m.headers.hasOwnProperty(n)&&j.set(n,m.headers[n])}),g=cq(m.url,h),m.timeout>0&&(l=setTimeout(function(){g.reject(new Error("Load timeout for resource: "+m.url))},m.timeout)),g.promise.then(function(n){return i={statusCode:n.status},m.timeout>0&&clearTimeout(l),i.statusCode>=200&&i.statusCode<300?m.binary?n.blob():n.text():n.json()}).then(function(n){i.statusCode>=200&&i.statusCode<300?k(null,i,n):k(n,i)})["catch"](function(n){k(n,i)}),{abort:g.reject}}function eb(g,i){var l,j,m=!1,n=function(){l.abort()},h=function(){m=!0,l.abort()};l=g.xhr?new g.xhr:new XMLHttpRequest;try{l.open(g.method,g.url)}catch(k){i(k,{statusCode:413})}l.withCredentials="withCredentials" in g?g.withCredentials:!0,"GET"===g.method?delete g.headers["Content-Type"]:g.json&&(g.headers.Accept="application/json",g.headers["Content-Type"]=g.headers["Content-Type"]||"application/json",g.body&&g.processData&&"string"!=typeof g.body&&(g.body=JSON.stringify(g.body))),g.binary&&(l.responseType="arraybuffer"),"body" in g||(g.body=null);for(var o in g.headers){g.headers.hasOwnProperty(o)&&l.setRequestHeader(o,g.headers[o])}return g.timeout>0&&(j=setTimeout(h,g.timeout),l.onprogress=function(){clearTimeout(j),4!==l.readyState&&(j=setTimeout(h,g.timeout))},"undefined"!=typeof l.upload&&(l.upload.onprogress=l.onprogress)),l.onreadystatechange=function(){if(4===l.readyState){var s={statusCode:l.status};if(l.status>=200&&l.status<300){var q;q=g.binary?cp([l.response||""],{type:l.getResponseHeader("Content-Type")}):l.responseText,i(null,s,q)}else{var p={};if(m){p=new Error("ETIMEDOUT"),s.statusCode=400}else{try{p=JSON.parse(l.response)}catch(r){}}i(p,s)}}},g.body&&g.body instanceof Blob?j1(g.body,function(p){l.send(p)}):l.send(g.body),{abort:n}}function cV(){try{return new XMLHttpRequest,!0}catch(g){return !1}}function eI(h,g){return b0||h.xhr?eb(h,g):aj(h,g)}function fN(){return""}function bV(j,h){function g(l,o,m){if(!j.binary&&j.json&&"string"==typeof l){try{l=JSON.parse(l)}catch(n){return m(n)}}Array.isArray(l)&&(l=l.map(function(p){return p.error||p.missing?dC(p):p})),j.binary&&fF(l,o),m(null,l,o)}function i(o,m){var q,n;if(o.code&&o.status){var p=new Error(o.message||o.code);return p.status=o.status,m(p)}if(o.message&&"ETIMEDOUT"===o.message){return m(o)}try{q=JSON.parse(o.responseText),n=dC(q)}catch(l){n=dC(o)}m(n)}j=c1(j);var k={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return j=dN.extend(k,j),j.json&&(j.binary||(j.headers.Accept="application/json"),j.headers["Content-Type"]=j.headers["Content-Type"]||"application/json"),j.binary&&(j.encoding=null,j.json=!1),j.processData||(j.json=!1),eI(j,function(r,o,m){if(r){return r.status=o?o.statusCode:400,i(r,h)}var p,n=o.headers&&o.headers["content-type"],l=m||fN();if(!j.binary&&(j.json||!j.processData)&&"object"!=typeof l&&(/json/.test(n)||/^[\s]*\{/.test(l)&&/\}[\s]*$/.test(l))){try{l=JSON.parse(l.toString())}catch(q){}}o.statusCode>=200&&o.statusCode<300?g(l,o,h):(p=dC(l),p.status=o.statusCode,h(p))})}function eL(i,k){var g=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m=-1!==g.indexOf("safari")&&-1===g.indexOf("chrome"),o=-1!==g.indexOf("msie"),h=-1!==g.indexOf("edge"),j=m||(o||h)&&"GET"===i.method,l="cache" in i?i.cache:!0,p=/^blob:/.test(i.url);if(!p&&(j||!l)){var n=-1!==i.url.indexOf("?");i.url+=(n?"&":"?")+"_nonce="+Date.now()}return bV(i,k)}function eV(h){var g=h.doc&&h.doc._attachments;g&&Object.keys(g).forEach(function(i){var j=g[i];j.data=bR(j.data,j.content_type)})}function ad(g){return/^_design/.test(g)?"_design/"+encodeURIComponent(g.slice(8)):/^_local/.test(g)?"_local/"+encodeURIComponent(g.slice(7)):encodeURIComponent(g)}function jQ(g){return g._attachments&&Object.keys(g._attachments)?cf.all(Object.keys(g._attachments).map(function(h){var i=g._attachments[h];return i.data&&"string"!=typeof i.data?new cf(function(j){bB(i.data,j)}).then(function(j){i.data=j}):void 0})):cf.resolve()}function cj(h){var g=dE(h);(g.user||g.password)&&(g.auth={username:g.user,password:g.password});var i=g.path.replace(/(^\/|\/$)/g,"").split("/");return g.db=i.pop(),-1===g.db.indexOf("%")&&(g.db=encodeURIComponent(g.db)),g.path=i.join("/"),g}function cb(h,g){return ek(h,h.db+"/"+g)}function ek(h,g){var i=h.path?"/":"";return h.protocol+"://"+h.host+(h.port?":"+h.port:"")+"/"+h.path+i+g}function kk(g){return"?"+Object.keys(g).map(function(h){return h+"="+encodeURIComponent(g[h])}).join("&")}function ki(j,n){function p(A,y,B){var z=A.ajax||{},x=dN.extend(c1(l),z,y);return fA(x.method+" "+x.url),w._ajax(x,B)}function k(x,y){return new cf(function(z,A){p(x,y,function(C,B){return C?A(C):void z(B)})})}function v(x,y){return eX(x,cY(function(z){o().then(function(){return y.apply(this,z)})["catch"](function(A){var B=z.pop();B(A)})}))}function o(){if(j.skipSetup||j.skip_setup){return cf.resolve()}if(r){return r}var x={method:"GET",url:m};return r=k({},x)["catch"](function(y){return y&&y.status&&404===y.status?(bH(404,"PouchDB is just detecting if the remote exists."),k({},{method:"PUT",url:m})):cf.reject(y)})["catch"](function(y){return y&&y.status&&412===y.status?!0:cf.reject(y)}),r["catch"](function(){r=null}),r}function q(x){return x.split("/").map(encodeURIComponent).join("/")}var w=this,i=cj;j.getHost&&(i=j.getHost);var s=i(j.name,j),m=cb(s,"");j=c1(j);var l=j.ajax||{};if(w.getUrl=function(){return m},w.getHeaders=function(){return l.headers||{}},j.auth||s.auth){var h=j.auth||s.auth,u=h.username+":"+h.password,g=cD(unescape(encodeURIComponent(u)));l.headers=l.headers||{},l.headers.Authorization="Basic "+g}w._ajax=eL;var r;setTimeout(function(){n(null,w)}),w.type=function(){return"http"},w.id=v("id",function(x){p({},{method:"GET",url:ek(s,"")},function(y,A){var z=A&&A.uuid?A.uuid+s.db:cb(s,"");x(null,z)})}),w.request=v("request",function(x,y){x.url=cb(s,x.url),p({},x,y)}),w.compact=v("compact",function(x,y){"function"==typeof x&&(y=x,x={}),x=c1(x),p(x,{url:cb(s,"_compact"),method:"POST"},function(){function z(){w.info(function(A,B){B&&!B.compact_running?y(null,{ok:!0}):setTimeout(z,x.interval||200)})}z()})}),w.bulkGet=eX("bulkGet",function(y,C){function A(F){var E={};y.revs&&(E.revs=!0),y.attachments&&(E.attachments=!0),p({},{url:cb(s,"_bulk_get"+kk(E)),method:"POST",body:{docs:y.docs}},F)}function B(){function K(L){return function(M,N){G[L]=N.results,++E===I&&C(null,{results:fK(G)})}}for(var H=jS,I=Math.ceil(y.docs.length/H),E=0,G=new Array(I),F=0;I>F;F++){var J=eK(y,["revs","attachments"]);J.ajax=l,J.docs=y.docs.slice(F*H,Math.min(y.docs.length,(F+1)*H)),ds(D,J,K(F))}}var D=this,x=ek(s,""),z=bj[x];"boolean"!=typeof z?A(function(E,F){if(E){var G=Math.floor(E.status/100);4===G||5===G?(bj[x]=!1,bH(E.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),B()):C(E)}else{bj[x]=!0,C(null,F)}}):z?A(C):B()}),w._info=function(x){o().then(function(){p({},{method:"GET",url:cb(s,"")},function(y,z){return y?x(y):(z.host=cb(s,""),void x(null,z))})})["catch"](x)},w.get=v("get",function(C,y,A){function B(F){var G=F._attachments,E=G&&Object.keys(G);return G&&E.length?cf.all(E.map(function(J){var H=G[J],I=ad(F._id)+"/"+q(J)+"?rev="+F._rev;return k(y,{method:"GET",url:cb(s,I),binary:!0}).then(function(K){return y.binary?K:new cf(function(L){bB(K,L)})}).then(function(K){delete H.stub,delete H.length,H.data=K})})):void 0}function D(E){return Array.isArray(E)?cf.all(E.map(function(F){return F.ok?B(F.ok):void 0})):B(E)}"function"==typeof y&&(A=y,y={}),y=c1(y);var z={};y.revs&&(z.revs=!0),y.revs_info&&(z.revs_info=!0),y.open_revs&&("all"!==y.open_revs&&(y.open_revs=JSON.stringify(y.open_revs)),z.open_revs=y.open_revs),y.rev&&(z.rev=y.rev),y.conflicts&&(z.conflicts=y.conflicts),C=ad(C);var x={method:"GET",url:cb(s,C+kk(z))};k(y,x).then(function(E){return cf.resolve().then(function(){return y.attachments?D(E):void 0}).then(function(){A(null,E)})})["catch"](A)}),w.remove=v("remove",function(x,B,z,A){var C;"string"==typeof B?(C={_id:x,_rev:B},"function"==typeof z&&(A=z,z={})):(C=x,"function"==typeof B?(A=B,z={}):(A=z,z=B));var y=C._rev||z.rev;p(z,{method:"DELETE",url:cb(s,ad(C._id))+"?rev="+y},A)}),w.getAttachment=v("getAttachment",function(x,z,B,C){"function"==typeof B&&(C=B,B={});var y=B.rev?"?rev="+B.rev:"",A=cb(s,ad(x))+"/"+q(z)+y;p(B,{method:"GET",url:A,binary:!0},C)}),w.removeAttachment=v("removeAttachment",function(A,y,z,B){var x=cb(s,ad(A)+"/"+q(y))+"?rev="+z;p({},{method:"DELETE",url:x},B)}),w.putAttachment=v("putAttachment",function(B,F,H,x,z,G){"function"==typeof z&&(G=z,z=x,x=H,H=null);var E=ad(B)+"/"+q(F),D=cb(s,E);if(H&&(D+="?rev="+H),"string"==typeof x){var y;try{y=f1(x)}catch(C){return G(dX(eH,"Attachment is not a valid base64 string"))}x=y?cO(y,z):""}var A={headers:{"Content-Type":z},method:"PUT",url:D,processData:!1,body:x,timeout:l.timeout||60000};p({},A,G)}),w._bulkDocs=function(x,y,z){x.new_edits=y.new_edits,o().then(function(){return cf.all(x.docs.map(jQ))}).then(function(){p(y,{method:"POST",url:cb(s,"_bulk_docs"),body:x},function(B,A){return B?z(B):(A.forEach(function(C){C.ok=!0}),void z(null,A))})})["catch"](z)},w.allDocs=v("allDocs",function(C,y){"function"==typeof C&&(y=C,C={}),C=c1(C);var A,B={},D="GET";C.conflicts&&(B.conflicts=!0),C.descending&&(B.descending=!0),C.include_docs&&(B.include_docs=!0),C.attachments&&(B.attachments=!0),C.key&&(B.key=JSON.stringify(C.key)),C.start_key&&(C.startkey=C.start_key),C.startkey&&(B.startkey=JSON.stringify(C.startkey)),C.end_key&&(C.endkey=C.end_key),C.endkey&&(B.endkey=JSON.stringify(C.endkey)),"undefined"!=typeof C.inclusive_end&&(B.inclusive_end=!!C.inclusive_end),"undefined"!=typeof C.limit&&(B.limit=C.limit),"undefined"!=typeof C.skip&&(B.skip=C.skip);var x=kk(B);if("undefined"!=typeof C.keys){var z="keys="+encodeURIComponent(JSON.stringify(C.keys));z.length+x.length+1<=ax?x+="&"+z:(D="POST",A={keys:C.keys})}k(C,{method:D,url:cb(s,"_all_docs"+x),body:A}).then(function(E){C.include_docs&&C.attachments&&C.binary&&E.rows.forEach(eV),y(null,E)})["catch"](y)}),w._changes=function(H){var A="batch_size" in H?H.batch_size:jL;H=c1(H),H.timeout="timeout" in H?H.timeout:"timeout" in l?l.timeout:30000;var L,D=H.timeout?{timeout:H.timeout-5000}:{},J="undefined"!=typeof H.limit?H.limit:!1;L="return_docs" in H?H.return_docs:"returnDocs" in H?H.returnDocs:!0;var B=J;if(H.style&&(D.style=H.style),(H.include_docs||H.filter&&"function"==typeof H.filter)&&(D.include_docs=!0),H.attachments&&(D.attachments=!0),H.continuous&&(D.feed="longpoll"),H.conflicts&&(D.conflicts=!0),H.descending&&(D.descending=!0),"heartbeat" in H?H.heartbeat&&(D.heartbeat=H.heartbeat):D.heartbeat=10000,H.filter&&"string"==typeof H.filter&&(D.filter=H.filter),H.view&&"string"==typeof H.view&&(D.filter="_view",D.view=H.view),H.query_params&&"object"==typeof H.query_params){for(var F in H.query_params){H.query_params.hasOwnProperty(F)&&(D[F]=H.query_params[F])}}var y,K="GET";if(H.doc_ids){D.filter="_doc_ids";var x=JSON.stringify(H.doc_ids);x.length<ax?D.doc_ids=x:(K="POST",y={doc_ids:H.doc_ids})}var I,G,E=function(N,M){if(!H.aborted){D.since=N,"object"==typeof D.since&&(D.since=JSON.stringify(D.since)),H.descending?J&&(D.limit=B):D.limit=!J||B>A?A:B;var O={method:K,url:cb(s,"_changes"+kk(D)),timeout:H.timeout,body:y};G=N,H.aborted||o().then(function(){I=p(H,O,M)})["catch"](M)}},C={results:[]},z=function(O,Q){if(!H.aborted){var P=0;if(Q&&Q.results){P=Q.results.length,C.last_seq=Q.last_seq;var M={};M.query=H.query_params,Q.results=Q.results.filter(function(R){B--;var S=eU(H)(R);return S&&(H.include_docs&&H.attachments&&H.binary&&eV(R),L&&C.results.push(R),H.onChange(R)),S})}else{if(O){return H.aborted=!0,void H.complete(O)}}Q&&Q.last_seq&&(G=Q.last_seq);var N=J&&0>=B||Q&&A>P||H.descending;(!H.continuous||J&&0>=B)&&N?H.complete(null,C):setTimeout(function(){E(G,z)},0)}};return E(H.since||0,z),{cancel:function(){H.aborted=!0,I&&I.abort()}}},w.revsDiff=v("revsDiff",function(x,y,z){"function"==typeof y&&(z=y,y={}),p(y,{method:"POST",url:cb(s,"_revs_diff"),body:x},z)}),w._close=function(x){x()},w._destroy=function(x,y){p(x,{url:cb(s,""),method:"DELETE"},function(z,A){return z&&z.status&&404!==z.status?y(z):void y(null,A)})}}function bU(g){g.adapter("http",ki,!1),g.adapter("https",ki,!1)}function fQ(){this.promise=new cf(function(g){g()})}function jF(g){var h=g.db,m=g.viewName,i=g.map,k=g.reduce,l=g.temporary,j=i.toString()+(k&&k.toString())+"undefined";if(!l&&h._cachedViews){var n=h._cachedViews[j];if(n){return cf.resolve(n)}}return h.info().then(function(p){function o(u){u.views=u.views||{};var r=m;-1===r.indexOf("/")&&(r=m+"/"+m);var s=u.views[r]=u.views[r]||{};if(!s[q]){return s[q]=!0,u}}var q=p.db_name+"-mrview-"+(l?"temp":d2(j));return fE(h,"_local/mrviews",o).then(function(){return h.registerDependentDatabase(q).then(function(s){var u=s.db;u.auto_compaction=!0;var r={name:q,db:u,sourceDB:h,adapter:h.adapter,mapFun:i,reduceFun:k};return r.db.get("_local/lastSeq")["catch"](function(v){if(404!==v.status){throw v}}).then(function(v){return r.seq=v?v.seq:0,l||(h._cachedViews=h._cachedViews||{},h._cachedViews[j]=r,r.db.once("destroyed",function(){delete h._cachedViews[j]})),r})})})})}function dD(k,i,h,j,l,g){return dO("return ("+k.replace(/;\s*$/,"")+");",{emit:i,sum:h,log:j,isArray:l,toJSON:g})}function kb(g){return -1===g.indexOf("/")?[g,g]:g.split("/")}function cF(g){return 1===g.length&&/^1-/.test(g[0].rev)}function ah(h,g){try{h.emit("error",g)}catch(i){aL("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),aL("error",g)}}function ep(i,g,j){try{return{output:g.apply(null,j)}}catch(h){return ah(i,h),{error:h}}}function kj(h,g){var i=aK.collate(h.key,g.key);return 0!==i?i:aK.collate(h.value,g.value)}function j3(h,g,i){return i=i||0,"number"==typeof g?h.slice(i,g+i):i>0?h.slice(i):h}function dI(h){var g=h.value,i=g&&"object"==typeof g&&g._id||h.id;return i}function eN(g){g.rows.forEach(function(i){var h=i.doc&&i.doc._attachments;h&&Object.keys(h).forEach(function(j){var k=h[j];h[j].data=bR(k.data,k.content_type)})})}function e2(g){return function(h){return g.include_docs&&g.attachments&&g.binary&&eN(h),h}}function f9(h){var g="builtin "+h+" function requires map values to be numbers or number arrays";return new bQ(g)}function kg(g){for(var h=0,m=0,i=g.length;i>m;m++){var k=g[m];if("number"!=typeof k){if(!Array.isArray(k)){throw f9("_sum")}h="number"==typeof h?[h]:h;for(var l=0,j=k.length;j>l;l++){var n=k[l];if("number"!=typeof n){throw f9("_sum")}"undefined"==typeof h[l]?h.push(n):h[l]+=n}}else{"number"==typeof h?h+=k:h[0]+=k}}return h}function ef(j,h,g,i){var k=h[j];"undefined"!=typeof k&&(i&&(k=encodeURIComponent(JSON.stringify(k))),g.push(j+"="+k))}function f6(h){if("undefined"!=typeof h){var g=Number(h);return isNaN(g)||g!==parseInt(h,10)?h:g}}function cx(g){return g.group_level=f6(g.group_level),g.limit=f6(g.limit),g.skip=f6(g.skip),g}function jP(g){if(g){if("number"!=typeof g){return new km('Invalid value for integer: "'+g+'"')}if(0>g){return new km('Invalid value for positive integer: "'+g+'"')}}}function dR(i,g){var j=i.descending?"endkey":"startkey",h=i.descending?"startkey":"endkey";if("undefined"!=typeof i[j]&&"undefined"!=typeof i[h]&&aK.collate(i[j],i[h])>0){throw new km("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(g.reduce&&i.reduce!==!1){if(i.include_docs){throw new km("{include_docs:true} is invalid for reduce")}if(i.keys&&i.keys.length>1&&!i.group&&!i.group_level){throw new km("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(k){var l=jP(i[k]);if(l){throw l}})}function jU(g,i,l){var j,m=[],n="GET";if(ef("reduce",l,m),ef("include_docs",l,m),ef("attachments",l,m),ef("limit",l,m),ef("descending",l,m),ef("group",l,m),ef("group_level",l,m),ef("skip",l,m),ef("stale",l,m),ef("conflicts",l,m),ef("startkey",l,m,!0),ef("start_key",l,m,!0),ef("endkey",l,m,!0),ef("end_key",l,m,!0),ef("inclusive_end",l,m),ef("key",l,m,!0),m=m.join("&"),m=""===m?"":"?"+m,"undefined"!=typeof l.keys){var h=2000,k="keys="+encodeURIComponent(JSON.stringify(l.keys));k.length+m.length+1<=h?m+=("?"===m[0]?"&":"?")+k:(n="POST","string"==typeof i?j={keys:l.keys}:i.keys=l.keys)}if("string"==typeof i){var o=kb(i);return g.request({method:n,url:"_design/"+o[0]+"/_view/"+o[1]+m,body:j}).then(e2(l))}return j=j||{},Object.keys(i).forEach(function(p){Array.isArray(i[p])?j[p]=i[p]:j[p]=i[p].toString()}),g.request({method:"POST",url:"_temp_view"+m,body:j}).then(e2(l))}function jX(h,g,i){return new cf(function(j,k){h._query(g,i,function(m,l){return m?k(m):void j(l)})})}function eF(g){return new cf(function(h,i){g._viewCleanup(function(k,j){return k?i(k):void h(j)})})}function eT(g){return function(h){if(404===h.status){return g}throw h}}function bO(m,h,l){function j(){return cF(q)?cf.resolve(g):h.db.get(n)["catch"](eT(g))}function i(r){return r.keys.length?h.db.allDocs({keys:r.keys,include_docs:!0}):cf.resolve({rows:[]})}function k(y,A){for(var u=[],r={},v=0,x=A.rows.length;x>v;v++){var z=A.rows[v],s=z.doc;if(s&&(u.push(s),r[s._id]=!0,s._deleted=!o[s._id],!s._deleted)){var B=o[s._id];"value" in B&&(s.value=B.value)}}var w=Object.keys(o);return w.forEach(function(C){if(!r[C]){var E={_id:C},D=o[C];"value" in D&&(E.value=D.value),u.push(E)}}),y.keys=ak(w.concat(y.keys)),u.push(y),u}var n="_local/doc_"+m,g={_id:n,keys:[]},p=l[m],o=p.indexableKeysToKeyValues,q=p.changes;return j().then(function(r){return i(r).then(function(s){return k(r,s)})})}function cc(i,g,j){var h="_local/lastSeq";return i.db.get(h)["catch"](eT({_id:h,seq:0})).then(function(k){var l=Object.keys(g);return cf.all(l.map(function(m){return bO(m,i,g)})).then(function(m){var n=fK(m);return k.seq=j,n.push(k),i.db.bulkDocs({docs:n})})})}function em(h){var g="string"==typeof h?h:h.name,i=dx[g];return i||(i=dx[g]=new fQ),i}function cl(g){return dB(em(g),function(){return eZ(g)})()}function eZ(g){function i(p,r){var q={id:m._id,key:aK.normalizeKey(p)};"undefined"!=typeof r&&null!==r&&(q.value=aK.normalizeKey(r)),j.push(q)}function l(q,p){return function(){return cc(g,q,p)}}var j,m,n;if("function"==typeof g.mapFun&&2===g.mapFun.length){var h=g.mapFun;n=function(p){return h(p,i)}}else{n=dD(g.mapFun.toString(),i,kg,az,Array.isArray,JSON.parse)}var k=g.seq||0,o=new fQ;return new cf(function(p,s){function r(){o.finish().then(function(){g.seq=k,p()})}function q(){function u(v){s(v)}g.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:k,limit:jK}).on("complete",function(F){var A=F.results;if(!A.length){return r()}for(var H={},x=0,v=A.length;v>x;x++){var C=A[x];if("_"!==C.doc._id[0]){j=[],m=C.doc,m._deleted||ep(g.sourceDB,n,[m]),j.sort(kj);for(var D,z={},B=0,G=j.length;G>B;B++){var w=j[B],y=[w.key,w.id];0===aK.collate(w.key,D)&&y.push(B);var E=aK.toIndexableString(y);z[E]=w,D=w.key}H[C.doc._id]={indexableKeysToKeyValues:z,changes:C.changes}}k=C.seq}return o.add(l(H,k)),A.length<jK?r():q()}).on("error",u)}q()})}function jI(m,h,l){0===l.group_level&&delete l.group_level;var j,i=l.group||l.group_level;j=f2[m.reduceFun]?f2[m.reduceFun]:dD(m.reduceFun.toString(),null,kg,az,Array.isArray,JSON.parse);var k=[],n=isNaN(l.group_level)?Number.POSITIVE_INFINITY:l.group_level;h.forEach(function(r){var u=k[k.length-1],s=i?r.key:null;return i&&Array.isArray(s)&&(s=s.slice(0,n)),u&&0===aK.collate(u.groupKey,s)?(u.keys.push([r.key,r.id]),void u.values.push(r.value)):void k.push({keys:[[r.key,r.id]],values:[r.value],groupKey:s})}),h=[];for(var g=0,p=k.length;p>g;g++){var o=k[g],q=ep(m.sourceDB,j,[o.keys,o.values,!1]);if(q.error&&q.error instanceof bQ){throw q.error}h.push({value:q.error?null:q.output,key:o.groupKey})}return{rows:j3(h,l.limit,l.skip)}}function eq(h,g){return dB(em(h),function(){return c0(h,g)})()}function c0(r,j){function m(u){return u.include_docs=!0,r.db.allDocs(u).then(function(v){return l=v.total_rows,v.rows.map(function(x){if("value" in x.doc&&"object"==typeof x.doc.value&&null!==x.doc.value){var z=Object.keys(x.doc.value).sort(),y=["id","key","value"];if(!(y>z||z>y)){return x.doc.value}}var w=aK.parseIndexableString(x.doc._id);return{key:w[0],id:w[1],value:"value" in x.doc?x.doc.value:null}})})}function k(u){var w;if(w=o?jI(r,u,j):{total_rows:l,offset:h,rows:u},j.include_docs){var v=ak(u.map(dI));return r.sourceDB.allDocs({keys:v,include_docs:!0,conflicts:j.conflicts,attachments:j.attachments,binary:j.binary}).then(function(x){var y={};return x.rows.forEach(function(z){z.doc&&(y["$"+z.id]=z.doc)}),u.forEach(function(A){var B=dI(A),z=y["$"+B];z&&(A.doc=z)}),w})}return w}var l,o=r.reduceFun&&j.reduce!==!1,h=j.skip||0;if("undefined"==typeof j.keys||j.keys.length||(j.limit=0,delete j.keys),"undefined"!=typeof j.keys){var p=j.keys,i=p.map(function(v){var u={startkey:aK.toIndexableString([v]),endkey:aK.toIndexableString([v,{}])};return m(u)});return cf.all(i).then(fK).then(k)}var g={descending:j.descending};if(j.start_key&&(j.startkey=j.start_key),j.end_key&&(j.endkey=j.end_key),"undefined"!=typeof j.startkey&&(g.startkey=j.descending?aK.toIndexableString([j.startkey,{}]):aK.toIndexableString([j.startkey])),"undefined"!=typeof j.endkey){var q=j.inclusive_end!==!1;j.descending&&(q=!q),g.endkey=aK.toIndexableString(q?[j.endkey,{}]:[j.endkey])}if("undefined"!=typeof j.key){var n=aK.toIndexableString([j.key]),s=aK.toIndexableString([j.key,{}]);g.descending?(g.endkey=n,g.startkey=s):(g.startkey=n,g.endkey=s)}return o||("number"==typeof j.limit&&(g.limit=j.limit),g.skip=h),m(g).then(k)}function bv(g){return g.request({method:"POST",url:"_view_cleanup"})}function b9(g){return g.get("_local/mrviews").then(function(h){var j={};Object.keys(h.views).forEach(function(m){var k=kb(m),l="_design/"+k[0],n=k[1];j[l]=j[l]||{},j[l][n]=!0});var i={keys:Object.keys(j),include_docs:!0};return g.allDocs(i).then(function(m){var n={};m.rows.forEach(function(p){var o=p.key.substring(8);Object.keys(j[p.key]).forEach(function(u){var r=o+"/"+u;h.views[r]||(r=u);var q=Object.keys(h.views[r]),s=p.doc&&p.doc.views&&p.doc.views[u];q.forEach(function(v){n[v]=n[v]||s})})});var l=Object.keys(n).filter(function(o){return !n[o]}),k=l.map(function(o){return dB(em(o),function(){return new g.constructor(o,g.__opts).destroy()})()});return cf.all(k).then(function(){return{ok:!0}})})},eT({ok:!0}))}function eJ(k,n,g){if("http"===k.type()){return jU(k,n,g)}if("function"==typeof k._query){return jX(k,n,g)}if("string"!=typeof n){dR(g,n);var m={db:k,viewName:"temp_view/temp_view",map:n.map,reduce:n.reduce,temporary:!0};return aN.add(function(){return jF(m).then(function(o){function p(){return o.db.destroy()}return b3(cl(o).then(function(){return eq(o,g)}),p)})}),aN.finish()}var h=n,j=kb(h),i=j[0],l=j[1];return k.get("_design/"+i).then(function(o){var p=o.views&&o.views[l];if(!p||"string"!=typeof p.map){throw new cC("ddoc "+i+" has no view named "+l)}dR(g,p);var q={db:k,viewName:h,map:p.map,reduce:p.reduce};return jF(q).then(function(r){return"ok"===g.stale||"update_after"===g.stale?("update_after"===g.stale&&dY.nextTick(function(){cl(r)}),eq(r,g)):cl(r).then(function(){return eq(r,g)})})})}function km(h){this.status=400,this.name="query_parse_error",this.message=h,this.error=!0;try{Error.captureStackTrace(this,km)}catch(g){}}function cC(h){this.status=404,this.name="not_found",this.message=h,this.error=!0;try{Error.captureStackTrace(this,cC)}catch(g){}}function bQ(h){this.status=500,this.name="invalid_value",this.message=h,this.error=!0;try{Error.captureStackTrace(this,bQ)}catch(g){}}function eD(g){return/^1-/.test(g)}function ac(h,g,i){return !h._attachments||!h._attachments[i]||h._attachments[i].digest!==g._attachments[i].digest}function j2(h,g){var i=Object.keys(g._attachments);return cf.all(i.map(function(j){return h.getAttachment(g._id,j,{rev:g._rev})}))}function j9(j,h,g){var i="http"===h.type()&&"http"!==j.type(),k=Object.keys(g._attachments);return i?j.get(g._id).then(function(l){return cf.all(k.map(function(m){return ac(l,g,m)?h.getAttachment(g._id,m):j.getAttachment(l._id,m)}))})["catch"](function(l){if(404!==l.status){throw l}return j2(h,g)}):j2(h,g)}function fR(h){var g=[];return Object.keys(h).forEach(function(j){var i=h[j].missing;i.forEach(function(k){g.push({id:j,rev:k})})}),{docs:g,revs:!0}}function dS(l,g,k,i){function j(){var r=fR(k);if(r.docs.length){return l.bulkGet(r).then(function(s){if(i.cancelled){throw new Error("cancelled")}return cf.all(s.results.map(function(u){return cf.all(u.docs.map(function(w){var v=w.ok;return w.error&&(q=!1),v&&v._attachments?j9(g,l,v).then(function(x){var y=Object.keys(v._attachments);return x.forEach(function(z,B){var A=v._attachments[y[B]];delete A.stub,delete A.length,A.data=z}),v}):v}))})).then(function(u){o=o.concat(fK(u).filter(Boolean))})})}}function m(r){return r._attachments&&Object.keys(r._attachments).length>0}function n(r){return l.allDocs({keys:r,include_docs:!0}).then(function(s){if(i.cancelled){throw new Error("cancelled")}s.rows.forEach(function(u){!u.deleted&&u.doc&&eD(u.value.rev)&&!m(u.doc)&&(o.push(u.doc),delete k[u.id])})})}function h(){var r=Object.keys(k).filter(function(s){var u=k[s].missing;return 1===u.length&&eD(u[0])});return r.length>0?n(r):void 0}function p(){return{ok:q,docs:o}}k=c1(k);var o=[],q=!0;return cf.resolve().then(h).then(j).then(p)}function fL(j,h,g,i,k){return j.get(h)["catch"](function(l){if(404===l.status){return"http"===j.type()&&bH(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:i,_id:h,history:[],replicator:dK,version:d7}}throw l}).then(function(l){return k.cancelled?void 0:(l.history=(l.history||[]).filter(function(m){return m.session_id!==i}),l.history.unshift({last_seq:g,session_id:i}),l.history=l.history.slice(0,bp),l.version=d7,l.replicator=dK,l.session_id=i,l.last_seq=g,j.put(l)["catch"](function(m){if(409===m.status){return fL(j,h,g,i,k)}throw m}))})}function jH(i,g,j,h){this.src=i,this.target=g,this.id=j,this.returnValue=h}function aZ(h,g){return h.session_id===g.session_id?{last_seq:h.last_seq,history:h.history}:dU(h.history,g.history)}function dU(g,h){var m=g[0],i=g.slice(1),k=h[0],l=h.slice(1);if(!m||0===h.length){return{last_seq:j5,history:[]}}var j=m.session_id;if(dq(j,h)){return{last_seq:m.last_seq,history:g}}var n=k.session_id;return dq(n,i)?{last_seq:k.last_seq,history:l}:dU(i,l)}function dq(i,g){var j=g[0],h=g.slice(1);return i&&0!==g.length?i===j.session_id?!0:dq(i,h):!1}function d0(g){return"number"==typeof g.status&&4===Math.floor(g.status/100)}function jO(i,g,j,h){return i.retry===!1?(g.emit("error",j),void g.removeAllListeners()):("function"!=typeof i.back_off_function&&(i.back_off_function=ch),g.emit("requestError",j),"active"!==g.state&&"pending"!==g.state||(g.emit("paused",j),g.state="stopped",g.once("active",function(){i.current_back_off=d9})),i.current_back_off=i.current_back_off||d9,i.current_back_off=i.back_off_function(i.current_back_off),void setTimeout(h,i.current_back_off))}function dm(g){return Object.keys(g).sort(aK.collate).reduce(function(h,i){return h[i]=g[i],h},{})}function kl(m,k,g){var l=g.doc_ids?g.doc_ids.sort(aK.collate):"",i=g.filter?g.filter.toString():"",j="",h="";return g.filter&&g.query_params&&(j=JSON.stringify(dm(g.query_params))),g.filter&&"_view"===g.filter&&(h=g.view.toString()),cf.all([m.id(),k.id()]).then(function(n){var o=n[0]+n[1]+i+h+j+l;return new cf(function(p){jG(o,p)})}).then(function(n){return n=n.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+n})}function da(j,s,F,A,E){function L(){return R?cf.resolve():kl(j,s,F).then(function(T){q=T,R=new jH(j,s,q,A)})}function z(){if(x=[],0!==h.docs.length){var T=h.docs;return s.bulkDocs({docs:T,new_edits:!1}).then(function(W){if(A.cancelled){throw D(),new Error("cancelled")}var Y=[],V={};W.forEach(function(Z){Z.error&&(E.doc_write_failures++,Y.push(Z),V[Z.id]=Z)}),i=i.concat(Y),E.docs_written+=h.docs.length-Y.length;var U=Y.filter(function(Z){return"unauthorized"!==Z.name&&"forbidden"!==Z.name});if(T.forEach(function(Z){var ae=V[Z._id];ae?A.emit("denied",c1(ae)):x.push(Z)}),U.length>0){var X=new Error("bulkDocs error");throw X.other_errors=Y,M("target.bulkDocs failed to write docs",X),new Error("bulkWrite partial failure")}},function(U){throw E.doc_write_failures+=T.length,U})}}function u(){if(h.error){throw new Error("There was a problem getting docs.")}E.last_seq=K=h.seq;var T=c1(E);return x.length&&(T.docs=x,A.emit("change",T)),O=!0,R.writeCheckpoint(h.seq,k).then(function(){if(O=!1,A.cancelled){throw D(),new Error("cancelled")}h=void 0,H()})["catch"](r)}function m(){var T={};return h.changes.forEach(function(U){"_user/"!==U.id&&(T[U.id]=U.changes.map(function(V){return V.rev}))}),s.revsDiff(T).then(function(U){if(A.cancelled){throw D(),new Error("cancelled")}h.diffs=U})}function Q(){return dS(j,s,h.diffs,A).then(function(T){h.error=!T.ok,T.docs.forEach(function(U){delete h.diffs[U._id],E.docs_read++,h.docs.push(U)})})}function I(){if(!A.cancelled&&!h){if(0===J.length){return void o(!0)}h=J.shift(),m().then(Q).then(z).then(u).then(I)["catch"](function(T){M("batch processing terminated with error",T)})}}function o(T){return 0===C.changes.length?void (0!==J.length||h||((w&&G.live||y)&&(A.state="pending",A.emit("paused")),y&&D())):void ((T||y||C.changes.length>=n)&&(J.push(C),C={seq:0,changes:[],docs:[]},"pending"!==A.state&&"stopped"!==A.state||(A.state="active",A.emit("active")),I()))}function M(U,T){P||(T.message||(T.message=U),E.ok=!1,E.status="aborting",E.errors.push(T),i=i.concat(T),J=[],C={seq:0,changes:[],docs:[]},D())}function D(){if(!(P||A.cancelled&&(E.status="cancelled",O))){E.status=E.status||"complete",E.end_time=new Date,E.last_seq=K,P=!0;var U=i.filter(function(V){return"unauthorized"!==V.name&&"forbidden"!==V.name});if(U.length>0){var T=i.pop();i.length>0&&(T.other_errors=i),T.result=E,jO(F,A,T,function(){da(j,s,F,A)})}else{E.errors=i,A.emit("complete",E),A.removeAllListeners()}}}function l(U){if(A.cancelled){return D()}var T=eU(F)(U);T&&(C.seq=U.seq,C.changes.push(U),o(0===J.length&&G.live))}function S(U){if(v=!1,A.cancelled){return D()}if(U.results.length>0){G.since=U.last_seq,H(),o(!0)}else{var T=function(){w?(G.live=!0,H()):y=!0,o(!0)};h||0!==U.results.length?T():(O=!0,R.writeCheckpoint(U.last_seq,k).then(function(){O=!1,E.last_seq=K=U.last_seq,T()})["catch"](r))}}function B(T){return v=!1,A.cancelled?D():void M("changes rejected",T)}function H(){function U(){T.cancel()}function V(){A.removeListener("cancel",U)}if(!v&&!y&&J.length<p){v=!0,A._changes&&(A.removeListener("cancel",A._abortChanges),A._changes.cancel()),A.once("cancel",U);var T=j.changes(G).on("change",l);T.then(V,V),T.then(S)["catch"](B),F.retry&&(A._changes=T,A._abortChanges=U)}}function N(){L().then(function(){return A.cancelled?void D():R.getCheckpoint().then(function(T){K=T,G={since:K,limit:n,batch_size:n,style:"all_docs",doc_ids:g,return_docs:!0},F.filter&&("string"!=typeof F.filter?G.include_docs=!0:G.filter=F.filter),"heartbeat" in F&&(G.heartbeat=F.heartbeat),"timeout" in F&&(G.timeout=F.timeout),F.query_params&&(G.query_params=F.query_params),F.view&&(G.view=F.view),H()})})["catch"](function(T){M("getCheckpoint rejected with ",T)})}function r(T){throw O=!1,M("writeCheckpoint completed with error",T),T}var h,q,R,J=[],C={seq:0,changes:[],docs:[]},O=!1,y=!1,P=!1,K=0,w=F.continuous||F.live||!1,n=F.batch_size||100,p=F.batches_limit||10,v=!1,g=F.doc_ids,i=[],x=[],k=cI();E=E||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var G={};return A.ready(j,s),A.cancelled?void D():(A._addedListeners||(A.once("cancel",D),"function"==typeof F.complete&&(A.once("error",F.complete),A.once("complete",function(T){F.complete(null,T)})),A._addedListeners=!0),void ("undefined"==typeof F.since?N():L().then(function(){return O=!0,R.writeCheckpoint(F.since,k)}).then(function(){return O=!1,A.cancelled?void D():(K=F.since,void N())})["catch"](r)))}function cJ(){c6.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var h=this,g=new cf(function(i,j){h.once("complete",i),h.once("error",j)});h.then=function(i,j){return g.then(i,j)},h["catch"]=function(i){return g["catch"](i)},h["catch"](function(){})}function ec(h,g){var i=g.PouchConstructor;return"string"==typeof h?new i(h,g):h}function e9(m,k,g,l){if("function"==typeof g&&(l=g,g={}),"undefined"==typeof g&&(g={}),g.doc_ids&&!Array.isArray(g.doc_ids)){throw dX(dF,"`doc_ids` filter parameter is not a list.")}g.complete=l,g=c1(g),g.continuous=g.continuous||g.live,g.retry="retry" in g?g.retry:!1,g.PouchConstructor=g.PouchConstructor||this;var i=new cJ(g),j=ec(m,g),h=ec(k,g);return da(j,h,g,i),i}function b2(i,g,j,h){return"function"==typeof j&&(h=j,j={}),"undefined"==typeof j&&(j={}),j=c1(j),j.PouchConstructor=j.PouchConstructor||this,i=ec(i,j),g=ec(g,j),new dc(i,g,j,h)}function dc(k,r,s,m){function q(z){x.emit("change",{direction:"pull",change:z})}function w(z){x.emit("change",{direction:"push",change:z})}function p(z){x.emit("denied",{direction:"push",doc:z})}function u(z){x.emit("denied",{direction:"pull",doc:z})}function i(){x.pushPaused=!0,x.pullPaused&&x.emit("paused")}function n(){x.pullPaused=!0,x.pushPaused&&x.emit("paused")}function y(){x.pushPaused=!1,x.pullPaused&&x.emit("active",{direction:"push"})}function v(){x.pullPaused=!1,x.pushPaused&&x.emit("active",{direction:"pull"})}function l(z){return function(D,B){var C="change"===D&&(B===q||B===w),F="denied"===D&&(B===u||B===p),A="paused"===D&&(B===n||B===i),E="active"===D&&(B===v||B===y);(C||F||A||E)&&(D in g||(g[D]={}),g[D][z]=!0,2===Object.keys(g[D]).length&&x.removeAllListeners(D))}}var x=this;this.canceled=!1;var o=s.push?dN.extend({},s,s.push):s,h=s.pull?dN.extend({},s,s.pull):s;this.push=e9(k,r,o),this.pull=e9(r,k,h),this.pushPaused=!0,this.pullPaused=!0;var g={};s.live&&(this.push.on("complete",x.pull.cancel.bind(x.pull)),this.pull.on("complete",x.push.cancel.bind(x.push))),this.on("newListener",function(z){"change"===z?(x.pull.on("change",q),x.push.on("change",w)):"denied"===z?(x.pull.on("denied",u),x.push.on("denied",p)):"active"===z?(x.pull.on("active",v),x.push.on("active",y)):"paused"===z&&(x.pull.on("paused",n),x.push.on("paused",i))}),this.on("removeListener",function(z){"change"===z?(x.pull.removeListener("change",q),x.push.removeListener("change",w)):"denied"===z?(x.pull.removeListener("denied",u),x.push.removeListener("denied",p)):"active"===z?(x.pull.removeListener("active",v),x.push.removeListener("active",y)):"paused"===z&&(x.pull.removeListener("paused",n),x.push.removeListener("paused",i))}),this.pull.on("removeListener",l("pull")),this.push.on("removeListener",l("push"));var j=cf.all([this.push,this.pull]).then(function(A){var z={push:A[0],pull:A[1]};return x.emit("complete",z),m&&m(null,z),x.removeAllListeners(),z},function(z){if(x.cancel(),m?m(z):x.emit("error",z),x.removeAllListeners(),m){throw z}});this.then=function(A,z){return j.then(A,z)},this["catch"]=function(z){return j["catch"](z)}}function bm(g){g.replicate=e9,g.sync=b2}var f7,dN=d(9),bb=eC(d(5)),au=eC(d(8)),b6=eC(d(10)),d5=d(14),cY=eC(d(4)),c6=d(1),dO=eC(d(15)),cL=eC(d(16)),ca=eC(d(17)),aK=d(12),cf="function"==typeof Promise?Promise:b6,ka=Function.prototype.toString,by=ka.call(Object),eW=bb("pouchdb:api"),c8=6;if(fB()){f7=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),f7=!!localStorage.getItem("_pouch_check_localstorage")}catch(bz){f7=!1}}au(ed,c6.EventEmitter),ed.prototype.addListener=function(m,k,g,l){function i(){function n(){h=!1}if(j._listeners[k]){if(h){return void (h="waiting")}h=!0;var o=eK(l,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);g.changes(o).on("change",function(p){p.seq>l.since&&!l.cancelled&&(l.since=p.seq,l.onChange(p))}).on("complete",function(){"waiting"===h&&setTimeout(function(){i()},0),h=!1}).on("error",n)}}if(!this._listeners[k]){var j=this,h=!1;this._listeners[k]=i,this.on(m,i)}},ed.prototype.removeListener=function(h,g){g in this._listeners&&c6.EventEmitter.prototype.removeListener.call(this,h,this._listeners[g])},ed.prototype.notifyLocalWindows=function(g){fB()?chrome.storage.local.set({dbName:g}):eB()&&(localStorage[g]="a"===localStorage[g]?"b":"a")},ed.prototype.notify=function(g){this.emit(g),this.notifyLocalWindows(g)},au(e0,Error),e0.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var e6=new e0({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),aX=new e0({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),d4=new e0({status:404,error:"not_found",reason:"missing"}),cS=new e0({status:409,error:"conflict",reason:"Document update conflict"}),cz=new e0({status:400,error:"invalid_id",reason:"_id field must contain a string"}),ba=new e0({status:412,error:"missing_id",reason:"_id is required for puts"}),fC=new e0({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),aC=new e0({status:412,error:"precondition_failed",reason:"Database not open"}),dJ=new e0({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),eH=new e0({status:500,error:"badarg",reason:"Some query argument is invalid"}),cs=new e0({status:400,error:"invalid_request",reason:"Request was invalid"}),bW=new e0({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),fI=new e0({status:500,error:"doc_validation",reason:"Bad special document member"}),dF=new e0({status:400,error:"bad_request",reason:"Something wrong with the request"}),eP=new e0({status:400,error:"bad_request",reason:"Document must be a JSON object"}),d6=new e0({status:404,error:"not_found",reason:"Database not found"}),bw=new e0({status:500,error:"indexed_db_went_bad",reason:"unknown"}),dP=new e0({status:500,error:"web_sql_went_bad",reason:"unknown"}),jR=new e0({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),bF=new e0({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),c2=new e0({status:400,error:"bad_request",reason:"Invalid rev format"}),fG=new e0({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),bA=new e0({status:412,error:"missing_stub"}),eQ=new e0({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),cu=[e6,aX,d4,cS,cz,ba,fC,aC,dJ,eH,cs,bW,fI,dF,eP,d6,dP,jR,bF,c2,fG,bA,bw,eQ],dV=function(i,g,j){var h=cu.filter(function(k){return k[i]===g});return j&&h.filter(function(k){return k.message===j})[0]||h[0]},kd=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],d1="queryKey",dw=/(?:^|&)([^&=]*)=?([^&]*)/g,fO=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,df="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");au(c4,c6.EventEmitter),c4.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},c4.prototype.doChanges=function(j){var h=this,g=j.complete;if(j=c1(j),"live" in j&&!("continuous" in j)&&(j.continuous=j.live),j.processChange=aT,"latest"===j.since&&(j.since="now"),j.since||(j.since=0),"now"===j.since){return void this.db.info().then(function(l){return h.isCancelled?void g(null,{status:"cancelled"}):(j.since=l.update_seq,void h.doChanges(j))},g)}if(j.continuous&&"now"!==j.since&&this.db.info().then(function(l){h.startSeq=l.update_seq},function(l){if("idbNull"!==l.id){throw l}}),j.view&&!j.filter&&(j.filter="_view"),j.filter&&"string"==typeof j.filter&&("_view"===j.filter?j.view=av(j.view):j.filter=av(j.filter),"http"!==this.db.type()&&!j.doc_ids)){return this.filterChanges(j)}"descending" in j||(j.descending=!1),j.limit=0===j.limit?1:j.limit,j.complete=g;var i=this.db._changes(j);if(i&&"function"==typeof i.cancel){var k=h.cancel;h.cancel=cY(function(l){i.cancel(),k.apply(this,l)})}},c4.prototype.filterChanges=function(k){var i=this,h=k.complete;if("_view"===k.filter){if(!k.view||"string"!=typeof k.view){var j=dX(dF,"`view` filter parameter not found or invalid.");return h(j)}var l=bd(k.view);this.db.get("_design/"+l[0],function(m,o){if(i.isCancelled){return h(null,{status:"cancelled"})}if(m){return h(dC(m))}var n=o&&o.views&&o.views[l[1]]&&o.views[l[1]].map;return n?(k.filter=aP(n),void i.doChanges(k)):h(dX(d4,o.views?"missing json key: "+l[1]:"missing json key: views"))})}else{var g=bd(k.filter);if(!g){return i.doChanges(k)}this.db.get("_design/"+g[0],function(n,o){if(i.isCancelled){return h(null,{status:"cancelled"})}if(n){return h(dC(n))}var m=o&&o.filters&&o.filters[g[1]];return m?(k.filter=du(m),void i.doChanges(k)):h(dX(d4,o&&o.filters?"missing json key: "+g[1]:"missing json key: filters"))})}},au(dv,c6.EventEmitter),dv.prototype.post=eX("post",function(h,g,i){return"function"==typeof g&&(i=g,g={}),"object"!=typeof h||Array.isArray(h)?i(dX(eP)):void this.bulkDocs({docs:[h]},g,f0(i))}),dv.prototype.put=eX("put",cY(function(g){function i(){h||(aL("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),h=!0)}var l,j,m,n,h=!1,k=g.shift(),o="_id" in k;if("object"!=typeof k||Array.isArray(k)){return(n=g.pop())(dX(eP))}for(;;){if(l=g.shift(),j=typeof l,"string"!==j||o?"string"!==j||!o||"_rev" in k?"object"===j?m=l:"function"===j&&(n=l):(i(),k._rev=l):(i(),k._id=l,o=!0),!g.length){break}}return m=m||{},bJ(k._id),e8(k._id)&&"function"==typeof this._putLocal?k._deleted?this._removeLocal(k,n):this._putLocal(k,n):void this.bulkDocs({docs:[k]},m,f0(n))})),dv.prototype.putAttachment=eX("putAttachment",function(m,k,g,l,i){function j(o){var n="_rev" in o?parseInt(o._rev,10):0;return o._attachments=o._attachments||{},o._attachments[k]={content_type:i,data:l,revpos:++n},h.put(o)}var h=this;return"function"==typeof i&&(i=l,l=g,g=null),"undefined"==typeof i&&(i=l,l=g,g=null),h.get(m).then(function(n){if(n._rev!==g){throw dX(cS)}return j(n)},function(n){if(n.reason===d4.message){return j({_id:m})}throw n})}),dv.prototype.removeAttachment=eX("removeAttachment",function(j,h,g,i){var k=this;k.get(j,function(m,l){return m?void i(m):l._rev!==g?void i(dX(cS)):l._attachments?(delete l._attachments[h],0===Object.keys(l._attachments).length&&delete l._attachments,void k.put(l,i)):i()})}),dv.prototype.remove=eX("remove",function(k,i,h,j){var l;"string"==typeof i?(l={_id:k,_rev:i},"function"==typeof h&&(j=h,h={})):(l=k,"function"==typeof i?(j=i,h={}):(j=h,h=i)),h=h||{},h.was_delete=!0;var g={_id:l._id,_rev:l._rev||h.rev};return g._deleted=!0,e8(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(l,j):void this.bulkDocs({docs:[g]},h,f0(j))}),dv.prototype.revsDiff=eX("revsDiff",function(g,h,m){function i(o,p){n.has(o)||n.set(o,{missing:[]}),n.get(o).missing.push(p)}function k(q,p){var o=g[q].slice(0);dd(p,function(v,s,r,w,x){var y=s+"-"+r,u=o.indexOf(y);-1!==u&&(o.splice(u,1),"available"!==x.status&&i(q,y))}),o.forEach(function(r){i(q,r)})}"function"==typeof h&&(m=h,h={});var l=Object.keys(g);if(!l.length){return m(null,{})}var j=0,n=new d5.Map;l.map(function(o){this._getRevisionTree(o,function(q,p){if(q&&404===q.status&&"missing"===q.message){n.set(o,{missing:g[o]})}else{if(q){return m(q)}k(o,p)}if(++j===l.length){var r={};return n.forEach(function(u,s){r[s]=u}),m(null,r)}})},this)}),dv.prototype.bulkGet=eX("bulkGet",function(h,g){ds(this,h,g)}),dv.prototype.compactDocument=eX("compactDocument",function(i,g,j){var h=this;this._getRevisionTree(i,function(k,n){if(k){return j(k)}var l=e5(n),o=[],m=[];Object.keys(l).forEach(function(p){l[p]>g&&o.push(p)}),dd(n,function(s,q,v,r,u){var p=q+"-"+v;"available"===u.status&&-1!==o.indexOf(p)&&m.push(p)}),h._doCompaction(i,m,j)})}),dv.prototype.compact=eX("compact",function(h,g){"function"==typeof h&&(g=h,h={});var i=this;h=h||{},i._compactionQueue=i._compactionQueue||[],i._compactionQueue.push({opts:h,callback:g}),1===i._compactionQueue.length&&bC(i)}),dv.prototype._compact=function(m,k){function g(n){h.push(i.compactDocument(n.id,0))}function l(o){var n=o.last_seq;cf.all(h).then(function(){return fE(i,"_local/compaction",function(p){return !p.last_seq||p.last_seq<n?(p.last_seq=n,p):!1})}).then(function(){k(null,{ok:!0})})["catch"](k)}var i=this,j={return_docs:!1,last_seq:m.last_seq||0},h=[];i.changes(j).on("change",g).on("complete",l).on("error",k)},dv.prototype.get=eX("get",function(g,h,m){function i(){var o=[],p=k.length;return p?void k.forEach(function(q){l.get(g,{rev:q,revs:h.revs,attachments:h.attachments},function(s,r){s?o.push({missing:q}):o.push({ok:r}),p--,p||m(null,o)})}):m(null,o)}if("function"==typeof h&&(m=h,h={}),"string"!=typeof g){return m(dX(cz))}if(e8(g)&&"function"==typeof this._getLocal){return this._getLocal(g,m)}var k=[],l=this;if(!h.open_revs){return this._get(g,h,function(p,B){if(p){return m(p)}var x=B.doc,C=B.metadata,v=B.ctx;if(h.conflicts){var w=d3(C);w.length&&(x._conflicts=w)}if(fH(C,x._rev)&&(x._deleted=!0),h.revs||h.revs_info){var r=eY(C.rev_tree),A=f8(r,function(D){return -1!==D.ids.map(function(E){return E.id}).indexOf(x._rev.split("-")[1])}),y=A.ids.map(function(D){return D.id}).indexOf(x._rev.split("-")[1])+1,u=A.ids.length-y;if(A.ids.splice(y,u),A.ids.reverse(),h.revs&&(x._revisions={start:A.pos+A.ids.length-1,ids:A.ids.map(function(D){return D.id})}),h.revs_info){var o=A.pos+A.ids.length;x._revs_info=A.ids.map(function(D){return o--,{rev:o+"-"+D.id,status:D.opts.status}})}}if(h.attachments&&x._attachments){var q=x._attachments,s=Object.keys(q).length;if(0===s){return m(null,x)}Object.keys(q).forEach(function(D){this._getAttachment(x._id,D,q[D],{rev:x._rev,binary:h.binary,ctx:v},function(F,G){var E=x._attachments[D];E.data=G,delete E.stub,delete E.length,--s||m(null,x)})},l)}else{if(x._attachments){for(var z in x._attachments){x._attachments.hasOwnProperty(z)&&(x._attachments[z].stub=!0)}}m(null,x)}})}if("all"===h.open_revs){this._getRevisionTree(g,function(o,p){return o?m(o):(k=bK(p).map(function(q){return q.rev}),void i())})}else{if(!Array.isArray(h.open_revs)){return m(dX(dJ,"function_clause"))}k=h.open_revs;for(var j=0;j<k.length;j++){var n=k[j];if("string"!=typeof n||!/^\d+-/.test(n)){return m(dX(c2))}}i()}}),dv.prototype.getAttachment=eX("getAttachment",function(j,h,g,i){var k=this;g instanceof Function&&(i=g,g={}),this._get(j,g,function(m,l){return m?i(m):l.doc._attachments&&l.doc._attachments[h]?(g.ctx=l.ctx,g.binary=!0,k._getAttachment(j,h,l.doc._attachments[h],g,i),void 0):i(dX(d4))})}),dv.prototype.allDocs=eX("allDocs",function(h,g){if("function"==typeof h&&(g=h,h={}),h.skip="undefined"!=typeof h.skip?h.skip:0,h.start_key&&(h.startkey=h.start_key),h.end_key&&(h.endkey=h.end_key),"keys" in h){if(!Array.isArray(h.keys)){return g(new TypeError("options.keys must be an array"))}var i=["startkey","endkey","key"].filter(function(j){return j in h})[0];if(i){return void g(dX(bW,"Query parameter `"+i+"` is not compatible with multi-get"))}if("http"!==this.type()){return dT(this,h,g)}}return this._allDocs(h,g)}),dv.prototype.changes=function(h,g){return"function"==typeof h&&(g=h,h={}),new c4(this,h,g)},dv.prototype.close=eX("close",function(g){return this._closed=!0,this._close(g)}),dv.prototype.info=eX("info",function(h){var g=this;this._info(function(j,i){return j?h(j):(i.db_name=i.db_name||g._db_name,i.auto_compaction=!(!g.auto_compaction||"http"===g.type()),i.adapter=g.type(),void h(null,i))})}),dv.prototype.id=eX("id",function(g){return this._id(g)}),dv.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},dv.prototype.bulkDocs=eX("bulkDocs",function(j,h,g){if("function"==typeof h&&(g=h,h={}),h=h||{},Array.isArray(j)&&(j={docs:j}),!j||!j.docs||!Array.isArray(j.docs)){return g(dX(aX))}for(var i=0;i<j.docs.length;++i){if("object"!=typeof j.docs[i]||Array.isArray(j.docs[i])){return g(dX(eP))}}var k;return j.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(m){k=k||cU(m)})}),k?g(dX(dF,k)):("new_edits" in h||("new_edits" in j?h.new_edits=j.new_edits:h.new_edits=!0),h.new_edits||"http"===this.type()||j.docs.sort(eS),fP(j.docs),this._bulkDocs(j,h,function(m,l){return m?g(m):(h.new_edits||(l=l.filter(function(n){return n.error})),void g(null,l))}))}),dv.prototype.registerDependentDatabase=eX("registerDependentDatabase",function(i,g){function j(k){return k.dependentDbs=k.dependentDbs||{},k.dependentDbs[i]?!1:(k.dependentDbs[i]=!0,k)}var h=new this.constructor(i,this.__opts);fE(this,"_local/_pouch_dependentDbs",j).then(function(){g(null,{db:h})})["catch"](g)}),dv.prototype.destroy=eX("destroy",function(j,h){function g(){i._destroy(j,function(l,m){return l?h(l):(i._destroyed=!0,i.emit("destroyed"),void h(null,m||{ok:!0}))})}"function"==typeof j&&(h=j,j={});var i=this,k="use_prefix" in i?i.use_prefix:!0;return"http"===i.type()?g():void i.get("_local/_pouch_dependentDbs",function(l,o){if(l){return 404!==l.status?h(l):g()}var m=o.dependentDbs,p=i.constructor,n=Object.keys(m).map(function(r){var q=k?r.replace(new RegExp("^"+p.prefix),""):r;return new p(q,i.__opts).destroy()});cf.all(n).then(g,h)})}),d8.prototype.execute=function(){var g;if(this.failed){for(;g=this.queue.shift();){g(this.failed)}}else{for(;g=this.queue.shift();){g()}}},d8.prototype.fail=function(g){this.failed=g,this.execute()},d8.prototype.ready=function(g){this.isReady=!0,this.db=g,this.execute()},d8.prototype.addTask=function(g){this.queue.push(g),this.failed&&this.execute()},au(eA,dv),eA.debug=bb,eA.adapters={},eA.preferredAdapters=[],eA.prefix="_pouch_";var cM=new c6.EventEmitter;eG(eA),eA.parseAdapter=function(g,h){var m,i,k=g.match(/([a-z\-]*):\/\/(.*)/);if(k){if(g=/http(s?)/.test(k[1])?k[1]+"://"+k[2]:k[2],m=k[1],!eA.adapters[m].valid()){throw"Invalid adapter"}return{name:g,adapter:k[1]}}var l="idb" in eA.adapters&&"websql" in eA.adapters&&eB()&&localStorage["_pouch__websqldb_"+eA.prefix+g];if(h.adapter){i=h.adapter}else{if("undefined"!=typeof h&&h.db){i="leveldb"}else{for(var j=0;j<eA.preferredAdapters.length;++j){if(i=eA.preferredAdapters[j],i in eA.adapters){if(l&&"idb"===i){aL("log",'PouchDB is downgrading "'+g+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}m=eA.adapters[i];var n=m&&"use_prefix" in m?m.use_prefix:!0;return{name:n?eA.prefix+g:g,adapter:i}},eA.adapter=function(h,g,i){g.valid()&&(eA.adapters[h]=g,i&&eA.preferredAdapters.push(h))},eA.plugin=function(g){return"function"==typeof g?g(eA):Object.keys(g).forEach(function(h){eA.prototype[h]=g[h]}),eA},eA.defaults=function(h){function g(k,i,j){return this instanceof g?("function"!=typeof i&&"undefined"!=typeof i||(j=i,i={}),k&&"object"==typeof k&&(i=k,k=void 0),i=dN.extend({},h,i),void eA.call(this,k,i,j)):new g(k,i,j)}return au(g,eA),g.preferredAdapters=eA.preferredAdapters.slice(),Object.keys(eA).forEach(function(i){i in g||(g[i]=eA[i])}),g};var kh="5.4.4";eA.version=kh;var bE,ea=e(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),cG=e(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),f1=function(g){return atob(g)},cD=function(g){return btoa(g)},ck=bc.setImmediate||bc.setTimeout,bG=32768,cA=5,e7="document-store",dG="by-sequence",cQ="attach-store",cW="attach-seq-store",cN="meta-store",bD="local-store",aJ="detect-blob-support",dM={running:!1,queue:[]},dL=new d5.Map,bX=new ed,ag=new d5.Map;eg.valid=function(){var g="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !g&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var cB=7,a9=bY("document-store"),f4=bY("by-sequence"),aH=bY("attach-store"),jT=bY("local-store"),bL=bY("metadata-store"),c7=bY("attach-seq-store"),kf=new d5.Map,aW=new ed,bN=1,ab="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+f4+" (seq, deleted)",bg="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+f4+" (doc_id, rev)",el="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+a9+" (winningseq)",cg="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+c7+" (seq)",bT="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+c7+" (digest, seq)",cT=f4+".seq = "+a9+".winningseq",aF=f4+".seq AS seq, "+f4+".deleted AS deleted, "+f4+".json AS data, "+f4+".rev AS rev, "+a9+".json AS metadata";e1.valid=cm,e1.use_prefix=!0;var b0=cV(),fF=function(){},jL=25,jS=50,bj={},ax=1800,fA=bb("pouchdb:http");ki.valid=function(){return !0},fQ.prototype.add=function(g){return this.promise=this.promise["catch"](function(){}).then(function(){return g()}),this.promise},fQ.prototype.finish=function(){return this.promise};var bx=function(h,g){return g&&h.then(function(i){dY.nextTick(function(){g(null,i)})},function(i){dY.nextTick(function(){g(i)})}),h},cv=function(g){return cY(function(h){var j=h.pop(),i=g.apply(this,h);return"function"==typeof j&&bx(i,j),i})},b3=function(h,g){return h.then(function(i){return g().then(function(){return i})},function(i){return g().then(function(){throw i})})},dB=function(h,g){return function(){var j=arguments,i=this;return h.add(function(){return g.apply(i,j)})}},ak=function(k){for(var i={},h=0,j=k.length;j>h;h++){i["$"+k[h]]=!0}var l=Object.keys(i),g=new Array(l.length);for(h=0,j=l.length;j>h;h++){g[h]=l[h].substring(1)}return g},dx={},aN=new fQ,jK=50,az=aL.bind(null,"log"),f2={_sum:function(h,g){return kg(g)},_count:function(h,g){return g.length},_stats:function(h,g){function i(m){for(var k=0,j=0,l=m.length;l>j;j++){var n=m[j];k+=n*n}return k}return{sum:kg(g),min:Math.min.apply(null,g),max:Math.max.apply(null,g),count:g.length,sumsqr:i(g)}}},b7=cv(function(){var g=this;return"http"===g.type()?bv(g):"function"==typeof g._viewCleanup?eF(g):b9(g)}),ke=function(j,h,g){"function"==typeof h&&(g=h,h={}),h=h?cx(h):{},"function"==typeof j&&(j={map:j});var i=this,k=cf.resolve().then(function(){return eJ(i,j,h)});return bx(k,g),k};au(km,Error),au(cC,Error),au(bQ,Error);var dp={query:ke,viewCleanup:b7},d7=1,dK="pouchdb",bp=5,j5=0;jH.prototype.writeCheckpoint=function(h,g){var i=this;return this.updateTarget(h,g).then(function(){return i.updateSource(h,g)})},jH.prototype.updateTarget=function(h,g){return fL(this.target,this.id,h,g,this.returnValue)},jH.prototype.updateSource=function(h,g){var i=this;return this.readOnlySource?cf.resolve(!0):fL(this.src,this.id,h,g,this.returnValue)["catch"](function(j){if(d0(j)){return i.readOnlySource=!0,!0}throw j})};var bZ={undefined:function(h,g){return 0===aK.collate(h.last_seq,g.last_seq)?g.last_seq:0},1:function(h,g){return aZ(g,h).last_seq}};jH.prototype.getCheckpoint=function(){var g=this;return g.target.get(g.id).then(function(h){return g.readOnlySource?cf.resolve(h.last_seq):g.src.get(g.id).then(function(i){if(h.version!==i.version){return j5}var j;return j=h.version?h.version.toString():"undefined",j in bZ?bZ[j](h,i):j5},function(i){if(404===i.status&&h.last_seq){return g.src.put({_id:g.id,last_seq:j5}).then(function(){return j5},function(j){return d0(j)?(g.readOnlySource=!0,h.last_seq):j5})}throw i})})["catch"](function(h){if(404!==h.status){throw h}return j5})};var d9=0;au(cJ,c6.EventEmitter),cJ.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},cJ.prototype.ready=function(j,h){function g(){k.cancel()}function i(){j.removeListener("destroyed",g),h.removeListener("destroyed",g)}var k=this;k._readyCalled||(k._readyCalled=!0,j.once("destroyed",g),h.once("destroyed",g),k.once("complete",i))},au(dc,c6.EventEmitter),dc.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},eA.plugin(al).plugin(jZ).plugin(bU).plugin(dp).plugin(bm),c.exports=eA}).call(this,d(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(f,c,g){function d(e){return function(){var h=arguments.length;if(h){for(var j=[],i=-1;++i<h;){j[i]=arguments[i]}return e.call(this,j)}return e.call(this,[])}}c.exports=d},{}],5:[function(h,l,f){function c(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function d(){var n=arguments,e=this.useColors;if(n[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+n[0]+(e?"%c ":" ")+"+"+f.humanize(this.diff),!e){return n}var o="color: "+this.color;n=[n[0],o,"color: inherit"].concat(Array.prototype.slice.call(n,1));var p=0,i=0;return n[0].replace(/%[a-z%]/g,function(q){"%%"!==q&&(p++,"%c"===q&&(i=p))}),n.splice(i,0,o),n}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function j(e){try{null==e?f.storage.removeItem("debug"):f.storage.debug=e}catch(i){}}function m(){var e;try{e=f.storage.debug}catch(i){}return e}function k(){try{return window.localStorage}catch(e){}}f=l.exports=h(6),f.log=g,f.formatArgs=d,f.save=j,f.load=m,f.useColors=c,f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:k(),f.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],f.formatters.j=function(e){return JSON.stringify(e)},f.enable(m())},{6:6}],6:[function(c,j,p){function l(){return p.colors[v++%p.colors.length]}function m(n){function f(){}function i(){var o=i,s=+new Date,r=s-(d||s);o.diff=r,o.prev=d,o.curr=s,d=s,null==o.useColors&&(o.useColors=p.useColors()),null==o.color&&o.useColors&&(o.color=l());var u=Array.prototype.slice.call(arguments);u[0]=p.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var t=0;u[0]=u[0].replace(/%([a-z%])/g,function(D,B){if("%%"===D){return D}t++;var w=p.formatters[B];if("function"==typeof w){var C=u[t];D=w.call(o,C),u.splice(t,1),t--}return D}),"function"==typeof p.formatArgs&&(u=p.formatArgs.apply(o,u));var x=i.log||p.log||console.log.bind(console);x.apply(o,u)}f.enabled=!1,i.enabled=!0;var e=p.enabled(n)?i:f;return e.namespace=n,e}function q(i){p.save(i);for(var n=(i||"").split(/[\s,]+/),f=n.length,e=0;f>e;e++){n[e]&&(i=n[e].replace(/\*/g,".*?"),"-"===i[0]?p.skips.push(new RegExp("^"+i.substr(1)+"$")):p.names.push(new RegExp("^"+i+"$")))}}function g(){p.enable("")}function k(i){var e,f;for(e=0,f=p.skips.length;f>e;e++){if(p.skips[e].test(i)){return !1}}for(e=0,f=p.names.length;f>e;e++){if(p.names[e].test(i)){return !0}}return !1}function h(e){return e instanceof Error?e.stack||e.message:e}p=j.exports=m,p.coerce=h,p.disable=g,p.enable=q,p.enabled=k,p.humanize=c(11),p.names=[],p.skips=[],p.formatters={};var d,v=0},{11:11}],7:[function(d,c,f){(function(h){function v(){g=!0;for(var l,i,n=w.length;n;){for(i=w,w=[],l=-1;++l<n;){i[l]()}n=w.length}g=!1}function p(i){1!==w.push(i)||g||q()}var q,e=h.MutationObserver||h.WebKitMutationObserver;if(e){var j=0,m=new e(v),k=h.document.createTextNode("");m.observe(k,{characterData:!0}),q=function(){k.data=j=++j%2}}else{if(h.setImmediate||"undefined"==typeof h.MessageChannel){q="document" in h&&"onreadystatechange" in h.document.createElement("script")?function(){var i=h.document.createElement("script");i.onreadystatechange=function(){v(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},h.document.documentElement.appendChild(i)}:function(){setTimeout(v,0)}}else{var t=new h.MessageChannel;t.port1.onmessage=v,q=function(){t.port2.postMessage(0)}}}var g,w=[];c.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(d,c,f){"function"==typeof Object.create?c.exports=function(g,e){g.super_=e,g.prototype=Object.create(e.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(g,e){g.super_=e;var h=function(){};h.prototype=e.prototype,g.prototype=new h,g.prototype.constructor=g}},{}],9:[function(d,c,f){(function(){var g=Array.prototype.slice,e=Array.prototype.forEach,h=function(i){if("object"!=typeof i){throw i+" is not an object"}var j=g.call(arguments,1);return e.call(j,function(k){if(k){for(var l in k){"object"==typeof k[l]&&i[l]?h.call(i,i[l],k[l]):i[l]=k[l]}}}),i};this.extend=h}).call(this)},{}],10:[function(w,k,B){function G(){}function j(e){if("function"!=typeof e){throw new TypeError("resolver must be a function")}this.state=I,this.queue=[],this.outcome=void 0,e!==G&&g(this,e)}function C(f,e,h){this.promise=f,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof h&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function J(f,e,h){x(function(){var i;try{i=e(h)}catch(l){return d.reject(f,l)}i===f?d.reject(f,new TypeError("Cannot resolve promise with itself")):d.resolve(f,i)})}function F(f){var e=f&&f.then;return f&&"object"==typeof f&&"function"==typeof e?function(){e.apply(f,arguments)}:void 0}function g(l,h){function f(o){e||(e=!0,d.reject(l,o))}function i(o){e||(e=!0,d.resolve(l,o))}function m(){h(i,f)}var e=!1,n=q(m);"error"===n.status&&f(n.value)}function q(h,e){var i={};try{i.value=h(e),i.status="success"}catch(f){i.status="error",i.value=f}return i}function D(e){return e instanceof this?e:d.resolve(new this(G),e)}function A(f){var e=new this(G);return d.reject(e,f)}function H(m){function e(r,s){function t(u){o[s]=u,++f!==h||l||(l=!0,d.resolve(n,o))}i.resolve(r).then(t,function(u){l||(l=!0,d.reject(n,u))})}var i=this;if("[object Array]"!==Object.prototype.toString.call(m)){return this.reject(new TypeError("must be an array"))}var h=m.length,l=!1;if(!h){return this.resolve([])}for(var o=new Array(h),f=0,p=-1,n=new this(G);++p<h;){e(m[p],p)}return n}function E(l){function h(o){f.resolve(o).then(function(p){e||(e=!0,d.resolve(i,p))},function(p){e||(e=!0,d.reject(i,p))})}var f=this;if("[object Array]"!==Object.prototype.toString.call(l)){return this.reject(new TypeError("must be an array"))}var m=l.length,e=!1;if(!m){return this.resolve([])}for(var n=-1,i=new this(G);++n<m;){h(l[n])}return i}var x=w(7),d={},c=["REJECTED"],z=["FULFILLED"],I=["PENDING"];k.exports=j,j.prototype["catch"]=function(e){return this.then(null,e)},j.prototype.then=function(f,e){if("function"!=typeof f&&this.state===z||"function"!=typeof e&&this.state===c){return this}var i=new this.constructor(G);if(this.state!==I){var h=this.state===z?f:e;J(i,h,this.outcome)}else{this.queue.push(new C(i,f,e))}return i},C.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},C.prototype.otherCallFulfilled=function(e){J(this.promise,this.onFulfilled,e)},C.prototype.callRejected=function(e){d.reject(this.promise,e)},C.prototype.otherCallRejected=function(e){J(this.promise,this.onRejected,e)},d.resolve=function(i,f){var m=q(F,f);if("error"===m.status){return d.reject(i,m.value)}var h=m.value;if(h){g(i,h)}else{i.state=z,i.outcome=f;for(var l=-1,e=i.queue.length;++l<e;){i.queue[l].callFulfilled(f)}}return i},d.reject=function(h,e){h.state=c,h.outcome=e;for(var i=-1,f=h.queue.length;++i<f;){h.queue[i].callRejected(e)}return h},j.resolve=D,j.reject=A,j.all=H,j.race=E},{7:7}],11:[function(p,x,h){function d(i){if(i=""+i,!(i.length>10000)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(e){var l=parseFloat(e[1]),f=(e[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*j;case"days":case"day":case"d":return l*m;case"hours":case"hour":case"hrs":case"hr":case"h":return l*q;case"minutes":case"minute":case"mins":case"min":case"m":return l*w;case"seconds":case"second":case"secs":case"sec":case"s":return l*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l}}}}function g(e){return e>=m?Math.round(e/m)+"d":e>=q?Math.round(e/q)+"h":e>=w?Math.round(e/w)+"m":e>=c?Math.round(e/c)+"s":e+"ms"}function k(e){return v(e,m,"day")||v(e,q,"hour")||v(e,w,"minute")||v(e,c,"second")||e+" ms"}function v(f,e,i){return e>f?void 0:1.5*e>f?Math.floor(f/e)+" "+i:Math.ceil(f/e)+" "+i+"s"}var c=1000,w=60*c,q=60*w,m=24*q,j=365.25*m;x.exports=function(f,e){return e=e||{},"string"==typeof f?d(f):e["long"]?k(f):g(f)}},{}],12:[function(v,m,c){function y(n){if(null!==n){switch(typeof n){case"boolean":return n?1:0;case"number":return k(n);case"string":return n.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var o=Array.isArray(n),l=o?n:Object.keys(n),f=-1,e=l.length,i="";if(o){for(;++f<e;){i+=c.toIndexableString(l[f])}}else{for(;++f<e;){var h=l[f];i+=c.toIndexableString(h)+c.toIndexableString(n[h])}}return i}}return""}function j(l,r){var h,e=r,f="1"===l[r];if(f){h=0,r++}else{var i="0"===l[r];r++;var o="",s=l.substring(r,r+q),p=parseInt(s,10)+B;for(i&&(p=-p),r+=q;;){var n=l[r];if("\x00"===n){break}o+=n,r++}o=o.split("."),h=1===o.length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(h-=10),0!==p&&(h=parseFloat(h+"e"+p))}return{num:h,length:r-e}}function d(l,f){var o=l.pop();if(f.length){var i=f[f.length-1];o===i.element&&(f.pop(),i=f[f.length-1]);var e=i.element,n=i.index;if(Array.isArray(e)){e.push(o)}else{if(n===l.length-2){var h=l.pop();e[h]=o}else{l.push(o)}}}}function C(h,e){for(var f=Math.min(h.length,e.length),i=0;f>i;i++){var l=c.collate(h[i],e[i]);if(0!==l){return l}}return h.length===e.length?0:h.length>e.length?1:-1}function x(f,e){return f===e?0:f>e?1:-1}function A(n,o){for(var l=Object.keys(n),f=Object.keys(o),e=Math.min(l.length,f.length),i=0;e>i;i++){var h=c.collate(l[i],f[i]);if(0!==h){return h}if(h=c.collate(n[l[i]],o[f[i]]),0!==h){return h}}return l.length===f.length?0:l.length>f.length?1:-1}function g(f){var e=["boolean","number","string","object"],h=e.indexOf(typeof f);return ~h?null===f?1:Array.isArray(f)?5:3>h?h+2:h+3:Array.isArray(f)?5:void 0}function k(p){if(0===p){return"1"}var f=p.toExponential().split(/e\+?/),n=parseInt(f[1],10),i=0>p,l=i?"0":"2",o=(i?-n:n)-B,r=z.padLeft(o.toString(),"0",q);l+=w+r;var h=Math.abs(parseFloat(f[0]));i&&(h=10-h);var e=h.toFixed(20);return e=e.replace(/\.?0+$/,""),l+=w+e}var B=-324,q=3,w="",z=v(13);c.collate=function(h,e){if(h===e){return 0}h=c.normalizeKey(h),e=c.normalizeKey(e);var f=g(h),i=g(e);if(f-i!==0){return f-i}if(null===h){return 0}switch(typeof h){case"number":return h-e;case"boolean":return h===e?0:e>h?-1:1;case"string":return x(h,e)}return Array.isArray(h)?C(h,e):A(h,e)},c.normalizeKey=function(l){switch(typeof l){case"undefined":return null;case"number":return l===1/0||l===-(1/0)||isNaN(l)?null:l;case"object":var h=l;if(Array.isArray(l)){var i=l.length;l=new Array(i);for(var n=0;i>n;n++){l[n]=c.normalizeKey(h[n])}}else{if(l instanceof Date){return l.toJSON()}if(null!==l){l={};for(var f in h){if(h.hasOwnProperty(f)){var e=h[f];"undefined"!=typeof e&&(l[f]=c.normalizeKey(e))}}}}}return l},c.toIndexableString=function(f){var e="\x00";return f=c.normalizeKey(f),g(f)+w+y(f)+e},c.parseIndexableString=function(l){for(var r=[],f=[],e=0;;){var o=l[e++];if("\x00"!==o){switch(o){case"1":r.push(null);break;case"2":r.push("1"===l[e]),e++;break;case"3":var s=j(l,e);r.push(s.num),e+=s.length;break;case"4":for(var p="";;){var n=l[e];if("\x00"===n){break}p+=n,e++}p=p.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),r.push(p);break;case"5":var i={element:[],index:r.length};r.push(i.element),f.push(i);break;case"6":var h={element:{},index:r.length};r.push(h.element),f.push(h);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}}else{if(1===r.length){return r.pop()}d(r,f)}}}},{13:13}],13:[function(f,c,g){function d(e,j,i){for(var k="",h=i-e.length;k.length<h;){k+=j}return k}g.padLeft=function(h,e,j){var i=d(h,e,j);return i+h},g.padRight=function(h,e,j){var i=d(h,e,j);return h+i},g.stringLexCompare=function(j,p){var m,l=j.length,h=p.length;for(m=0;l>m;m++){if(m===h){return 1}var e=j.charAt(m),k=p.charAt(m);if(e!==k){return k>e?-1:1}}return h>l?-1:0},g.intToDecimalForm=function(i){var e=0>i,j="";do{var h=e?-Math.ceil(i%10):Math.floor(i%10);j=h+j,i=e?Math.ceil(i/10):Math.floor(i/10)}while(i);return e&&"0"!==j&&(j="-"+j),j}},{}],14:[function(h,f,d){function g(){this.store={}}function c(i){if(this.store=new g,i&&Array.isArray(i)){for(var e=0,j=i.length;j>e;e++){this.add(i[e])}}}d.Map=g,d.Set=c,g.prototype.mangle=function(e){if("string"!=typeof e){throw new TypeError("key must be a string but Got "+e)}return"$"+e},g.prototype.unmangle=function(e){return e.substring(1)},g.prototype.get=function(i){var e=this.mangle(i);return e in this.store?this.store[e]:void 0},g.prototype.set=function(i,e){var j=this.mangle(i);return this.store[j]=e,!0},g.prototype.has=function(i){var e=this.mangle(i);return e in this.store},g.prototype["delete"]=function(i){var e=this.mangle(i);return e in this.store?(delete this.store[e],!0):!1},g.prototype.forEach=function(e){for(var k=Object.keys(this.store),i=0,m=k.length;m>i;i++){var l=k[i],j=this.store[l];l=this.unmangle(l),e(j,l)}},c.prototype.add=function(e){return this.store.set(e,!0)},c.prototype.has=function(e){return this.store.has(e)},c.prototype["delete"]=function(e){return this.store["delete"](e)}},{}],15:[function(d,c,f){(function(){var e={}.hasOwnProperty,g=[].slice;c.exports=function(l,k){var j,i,m,h;i=[],h=[];for(j in k){e.call(k,j)&&(m=k[j],"this"!==j&&(i.push(j),h.push(m)))}return Function.apply(null,g.call(i).concat([l])).apply(k["this"],h)}}).call(this)},{}],16:[function(c,e,d){!function(g){if("object"==typeof d){e.exports=g()}else{if("function"==typeof b&&b.amd){b(g)}else{var h;try{h=window}catch(f){h=self}h.SparkMD5=g()}}}(function(I){function w(l,h,n,i,m,g){return h=K(K(h,l),K(i,g)),K(h<<m|h>>>32-m,n)}function A(m,i,l,n,h,o,g){return w(i&l|~i&n,m,i,h,o,g)}function J(m,i,l,n,h,o,g){return w(i&n|l&~n,m,i,h,o,g)}function x(m,i,l,n,h,o,g){return w(i^l^n,m,i,h,o,g)}function D(m,i,l,n,h,o,g){return w(l^(i|~n),m,i,h,o,g)}function M(l,h){var n=l[0],i=l[1],g=l[2],m=l[3];n=A(n,i,g,m,h[0],7,-680876936),m=A(m,n,i,g,h[1],12,-389564586),g=A(g,m,n,i,h[2],17,606105819),i=A(i,g,m,n,h[3],22,-1044525330),n=A(n,i,g,m,h[4],7,-176418897),m=A(m,n,i,g,h[5],12,1200080426),g=A(g,m,n,i,h[6],17,-1473231341),i=A(i,g,m,n,h[7],22,-45705983),n=A(n,i,g,m,h[8],7,1770035416),m=A(m,n,i,g,h[9],12,-1958414417),g=A(g,m,n,i,h[10],17,-42063),i=A(i,g,m,n,h[11],22,-1990404162),n=A(n,i,g,m,h[12],7,1804603682),m=A(m,n,i,g,h[13],12,-40341101),g=A(g,m,n,i,h[14],17,-1502002290),i=A(i,g,m,n,h[15],22,1236535329),n=J(n,i,g,m,h[1],5,-165796510),m=J(m,n,i,g,h[6],9,-1069501632),g=J(g,m,n,i,h[11],14,643717713),i=J(i,g,m,n,h[0],20,-373897302),n=J(n,i,g,m,h[5],5,-701558691),m=J(m,n,i,g,h[10],9,38016083),g=J(g,m,n,i,h[15],14,-660478335),i=J(i,g,m,n,h[4],20,-405537848),n=J(n,i,g,m,h[9],5,568446438),m=J(m,n,i,g,h[14],9,-1019803690),g=J(g,m,n,i,h[3],14,-187363961),i=J(i,g,m,n,h[8],20,1163531501),n=J(n,i,g,m,h[13],5,-1444681467),m=J(m,n,i,g,h[2],9,-51403784),g=J(g,m,n,i,h[7],14,1735328473),i=J(i,g,m,n,h[12],20,-1926607734),n=x(n,i,g,m,h[5],4,-378558),m=x(m,n,i,g,h[8],11,-2022574463),g=x(g,m,n,i,h[11],16,1839030562),i=x(i,g,m,n,h[14],23,-35309556),n=x(n,i,g,m,h[1],4,-1530992060),m=x(m,n,i,g,h[4],11,1272893353),g=x(g,m,n,i,h[7],16,-155497632),i=x(i,g,m,n,h[10],23,-1094730640),n=x(n,i,g,m,h[13],4,681279174),m=x(m,n,i,g,h[0],11,-358537222),g=x(g,m,n,i,h[3],16,-722521979),i=x(i,g,m,n,h[6],23,76029189),n=x(n,i,g,m,h[9],4,-640364487),m=x(m,n,i,g,h[12],11,-421815835),g=x(g,m,n,i,h[15],16,530742520),i=x(i,g,m,n,h[2],23,-995338651),n=D(n,i,g,m,h[0],6,-198630844),m=D(m,n,i,g,h[7],10,1126891415),g=D(g,m,n,i,h[14],15,-1416354905),i=D(i,g,m,n,h[5],21,-57434055),n=D(n,i,g,m,h[12],6,1700485571),m=D(m,n,i,g,h[3],10,-1894986606),g=D(g,m,n,i,h[10],15,-1051523),i=D(i,g,m,n,h[1],21,-2054922799),n=D(n,i,g,m,h[8],6,1873313359),m=D(m,n,i,g,h[15],10,-30611744),g=D(g,m,n,i,h[6],15,-1560198380),i=D(i,g,m,n,h[13],21,1309151649),n=D(n,i,g,m,h[4],6,-145523070),m=D(m,n,i,g,h[11],10,-1120210379),g=D(g,m,n,i,h[2],15,718787259),i=D(i,g,m,n,h[9],21,-343485551),l[0]=K(n,l[0]),l[1]=K(i,l[1]),l[2]=K(g,l[2]),l[3]=K(m,l[3])}function H(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h.charCodeAt(g)+(h.charCodeAt(g+1)<<8)+(h.charCodeAt(g+2)<<16)+(h.charCodeAt(g+3)<<24)}return i}function B(h){var g,i=[];for(g=0;64>g;g+=4){i[g>>2]=h[g]+(h[g+1]<<8)+(h[g+2]<<16)+(h[g+3]<<24)}return i}function G(g){var m,o,l,n,p,i,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(m=64;h>=m;m+=64){M(r,H(g.substring(m-64,m)))}for(g=g.substring(m-64),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0;o>m;m+=1){l[m>>2]|=g.charCodeAt(m)<<(m%4<<3)}if(l[m>>2]|=128<<(m%4<<3),m>55){for(M(r,l),m=0;16>m;m+=1){l[m]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),i=parseInt(n[1],16)||0,l[14]=p,l[15]=i,M(r,l),r}function q(g){var i,o,l,n,p,m,h=g.length,r=[1732584193,-271733879,-1732584194,271733878];for(i=64;h>=i;i+=64){M(r,B(g.subarray(i-64,i)))}for(g=h>i-64?g.subarray(i-64):new Uint8Array(0),o=g.length,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;o>i;i+=1){l[i>>2]|=g[i]<<(i%4<<3)}if(l[i>>2]|=128<<(i%4<<3),i>55){for(M(r,l),i=0;16>i;i+=1){l[i]=0}}return n=8*h,n=n.toString(16).match(/(.*?)(.{0,8})$/),p=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=p,l[15]=m,M(r,l),r}function E(h){var g,i="";for(g=0;4>g;g+=1){i+=L[h>>8*g+4&15]+L[h>>8*g&15]}return i}function z(h){var g;for(g=0;g<h.length;g+=1){h[g]=E(h[g])}return h.join("")}function F(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function k(l,h){var n,i=l.length,m=new ArrayBuffer(i),g=new Uint8Array(m);for(n=0;i>n;n+=1){g[n]=l.charCodeAt(n)}return h?g:m}function j(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function f(i,g,l){var h=new Uint8Array(i.byteLength+g.byteLength);return h.set(new Uint8Array(i)),h.set(new Uint8Array(g),i.byteLength),l?h:h.buffer}function N(i){var g,l=[],h=i.length;for(g=0;h-1>g;g+=2){l.push(parseInt(i.substr(g,2),16))}return String.fromCharCode.apply(String,l)}function C(){this.reset()}var K=function(h,g){return h+g&4294967295},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==z(G("hello"))&&(K=function(i,g){var l=(65535&i)+(65535&g),h=(i>>16)+(g>>16)+(l>>16);return h<<16|65535&l}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function g(i,h){return i=0|i||0,0>i?Math.max(i+h,0):Math.min(i,h)}ArrayBuffer.prototype.slice=function(o,l){var n,h,r,m,i=this.byteLength,s=g(o,i),p=i;return l!==I&&(p=g(l,i)),s>p?new ArrayBuffer(0):(n=p-s,h=new ArrayBuffer(n),r=new Uint8Array(h),m=new Uint8Array(this,s,n),r.set(m),h)}}(),C.prototype.append=function(g){return this.appendBinary(F(g)),this},C.prototype.appendBinary=function(h){this._buff+=h,this._length+=h.length;var g,i=this._buff.length;for(g=64;i>=g;g+=64){M(this._hash,H(this._buff.substring(g-64,g)))}return this._buff=this._buff.substring(g-64),this},C.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i.charCodeAt(h)<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},C.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},C.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},C.prototype._finish=function(l,h){var n,i,m,g=h;if(l[g>>2]|=128<<(g%4<<3),g>55){for(M(this._hash,l),g=0;16>g;g+=1){l[g]=0}}n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),m=parseInt(n[1],16)||0,l[14]=i,l[15]=m,M(this._hash,l)},C.hash=function(h,g){return C.hashBinary(F(h),g)},C.hashBinary=function(i,g){var l=G(i),h=z(l);return g?N(h):h},C.ArrayBuffer=function(){this.reset()},C.ArrayBuffer.prototype.append=function(i){var g,l=f(this._buff.buffer,i,!0),h=l.length;for(this._length+=i.byteLength,g=64;h>=g;g+=64){M(this._hash,B(l.subarray(g-64,g)))}return this._buff=h>g-64?new Uint8Array(l.buffer.slice(g-64)):new Uint8Array(0),this},C.ArrayBuffer.prototype.end=function(l){var h,n,i=this._buff,m=i.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;m>h;h+=1){g[h>>2]|=i[h]<<(h%4<<3)}return this._finish(g,m),n=z(this._hash),l&&(n=N(n)),this.reset(),n},C.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},C.ArrayBuffer.prototype.getState=function(){var g=C.prototype.getState.call(this);return g.buff=j(g.buff),g},C.ArrayBuffer.prototype.setState=function(g){return g.buff=k(g.buff,!0),C.prototype.setState.call(this,g)},C.ArrayBuffer.prototype.destroy=C.prototype.destroy,C.ArrayBuffer.prototype._finish=C.prototype._finish,C.ArrayBuffer.hash=function(i,g){var l=q(new Uint8Array(i)),h=z(l);return g?N(h):h},C})},{}],17:[function(f,c,g){function d(j,p,m){var l=m[m.length-1];j===l.element&&(m.pop(),l=m[m.length-1]);var h=l.element,e=l.index;if(Array.isArray(h)){h.push(j)}else{if(e===p.length-2){var k=p.pop();h[k]=j}else{p.push(j)}}}g.stringify=function(B){var p=[];p.push({obj:B});for(var h,A,q,m,v,w,z,y,x,k,e,j="";h=p.pop();){if(A=h.obj,q=h.prefix||"",m=h.val||"",j+=q,m){j+=m}else{if("object"!=typeof A){j+="undefined"==typeof A?null:JSON.stringify(A)}else{if(null===A){j+="null"}else{if(Array.isArray(A)){for(p.push({val:"]"}),v=A.length-1;v>=0;v--){w=0===v?"":",",p.push({obj:A[v],prefix:w})}p.push({val:"["})}else{z=[];for(y in A){A.hasOwnProperty(y)&&z.push(y)}for(p.push({val:"}"}),v=z.length-1;v>=0;v--){x=z[v],k=A[x],e=v>0?",":"",e+=JSON.stringify(x)+":",p.push({obj:k,prefix:e})}p.push({val:"{"})}}}}}return j},g.parse=function(x){for(var w,y,e,m,q,h,v,p,k,z=[],r=[],j=0;;){if(w=x[j++],"}"!==w&&"]"!==w&&"undefined"!=typeof w){switch(w){case" ":case"	":case"\n":case":":case",":break;case"n":j+=3,d(null,z,r);break;case"t":j+=3,d(!0,z,r);break;case"f":j+=4,d(!1,z,r);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(y="",j--;;){if(e=x[j++],!/[\d\.\-e\+]/.test(e)){j--;break}y+=e}d(parseFloat(y),z,r);break;case'"':for(m="",q=void 0,h=0;;){if(v=x[j++],'"'===v&&("\\"!==q||h%2!==1)){break}m+=v,q=v,"\\"===q?h++:h=0}d(JSON.parse('"'+m+'"'),z,r);break;case"[":p={element:[],index:z.length},z.push(p.element),r.push(p);break;case"{":k={element:{},index:z.length},z.push(k.element),r.push(k);break;default:throw new Error("unexpectedly reached end of input: "+w)}}else{if(1===z.length){return z.pop()}d(z.pop(),z,r)}}}},{}]},{},[3])(3)});