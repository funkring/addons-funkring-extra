!function(c){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=c()}else{if("function"==typeof define&&define.amd){define([],c)}else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.PouchDB=c()}}}(function(){var c;return function d(b,l,i){function e(n,h){if(!l[n]){if(!b[n]){var j="function"==typeof require&&require;if(!h&&j){return j(n,!0)}if(k){return k(n,!0)}var f=new Error("Cannot find module '"+n+"'");throw f.code="MODULE_NOT_FOUND",f}var g=l[n]={exports:{}};b[n][0].call(g.exports,function(p){var m=b[n][1][p];return e(m?m:p)},g,g.exports,d,b,l,i)}return l[n].exports}for(var k="function"==typeof require&&require,a=0;a<i.length;a++){e(i[a])}return e}({1:[function(e,n,a){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function b(f){return"function"==typeof f}function i(f){return"number"==typeof f}function p(f){return"object"==typeof f&&null!==f}function m(f){return void 0===f}n.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(f){if(!i(f)||0>f||isNaN(f)){throw TypeError("n must be a positive number")}return this._maxListeners=f,this},o.prototype.emit=function(k){var g,l,j,r,f,h;if(this._events||(this._events={}),"error"===k&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){if(g=arguments[1],g instanceof Error){throw g}throw TypeError('Uncaught, unspecified "error" event.')}if(l=this._events[k],m(l)){return !1}if(b(l)){switch(arguments.length){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),l.apply(this,r)}}else{if(p(l)){for(r=Array.prototype.slice.call(arguments,1),h=l.slice(),j=h.length,f=0;j>f;f++){h[f].apply(this,r)}}}return !0},o.prototype.addListener=function(f,g){var h;if(!b(g)){throw TypeError("listener must be a function")}return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,b(g.listener)?g.listener:g),this._events[f]?p(this._events[f])?this._events[f].push(g):this._events[f]=[this._events[f],g]:this._events[f]=g,p(this._events[f])&&!this._events[f].warned&&(h=m(this._maxListeners)?o.defaultMaxListeners:this._maxListeners,h&&h>0&&this._events[f].length>h&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"==typeof console.trace&&console.trace())),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(g,j){function f(){this.removeListener(g,f),h||(h=!0,j.apply(this,arguments))}if(!b(j)){throw TypeError("listener must be a function")}var h=!1;return f.listener=j,this.on(g,f),this},o.prototype.removeListener=function(j,f){var g,h,l,k;if(!b(f)){throw TypeError("listener must be a function")}if(!this._events||!this._events[j]){return this}if(g=this._events[j],l=g.length,h=-1,g===f||b(g.listener)&&g.listener===f){delete this._events[j],this._events.removeListener&&this.emit("removeListener",j,f)}else{if(p(g)){for(k=l;k-->0;){if(g[k]===f||g[k].listener&&g[k].listener===f){h=k;break}}if(0>h){return this}1===g.length?(g.length=0,delete this._events[j]):g.splice(h,1),this._events.removeListener&&this.emit("removeListener",j,f)}}return this},o.prototype.removeAllListeners=function(f){var g,h;if(!this._events){return this}if(!this._events.removeListener){return 0===arguments.length?this._events={}:this._events[f]&&delete this._events[f],this}if(0===arguments.length){for(g in this._events){"removeListener"!==g&&this.removeAllListeners(g)}return this.removeAllListeners("removeListener"),this._events={},this}if(h=this._events[f],b(h)){this.removeListener(f,h)}else{if(h){for(;h.length;){this.removeListener(f,h[h.length-1])}}}return delete this._events[f],this},o.prototype.listeners=function(f){var g;return g=this._events&&this._events[f]?b(this._events[f])?[this._events[f]]:this._events[f].slice():[]},o.prototype.listenerCount=function(f){if(this._events){var g=this._events[f];if(b(g)){return 1}if(g){return g.length}}return 0},o.listenerCount=function(f,g){return f.listenerCount(g)}},{}],2:[function(s,B,r){function t(){b&&l&&(b=!1,l.length?o=l.concat(o):h=-1,o.length&&f())}function f(){if(!b){var g=u(t);b=!0;for(var j=o.length;j;){for(l=o,o=[];++h<j;){l&&l[h].run()}h=-1,j=o.length}l=null,b=!1,e(g)}}function a(g,j){this.fun=g,this.array=j}function n(){}var u,e,i=B.exports={};!function(){try{u=setTimeout}catch(g){u=function(){throw new Error("setTimeout is not defined")}}try{e=clearTimeout}catch(g){e=function(){throw new Error("clearTimeout is not defined")}}}();var l,o=[],b=!1,h=-1;i.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1){for(var g=1;g<arguments.length;g++){k[g-1]=arguments[g]}}o.push(new a(j,k)),1!==o.length||b||u(f,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=n,i.addListener=n,i.once=n,i.off=n,i.removeListener=n,i.removeAllListeners=n,i.emit=n,i.binding=function(g){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(g){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],3:[function(b,e,a){(function(fp,gM){function fy(t){return t&&"object"==typeof t&&"default" in t?t["default"]:t}function ee(t){return t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function ge(ac){if("function"==typeof ac.slice){return ac.slice(0)}var aa=new ArrayBuffer(ac.byteLength),ab=new Uint8Array(aa),t=new Uint8Array(ac);return ab.set(t),aa}function h2(aa){if(aa instanceof ArrayBuffer){return ge(aa)}var ab=aa.size,t=aa.type;return"function"==typeof aa.slice?aa.slice(0,ab,t):aa.webkitSlice(0,ab,t)}function hE(aa){var ab=Object.getPrototypeOf(aa);if(null===ab){return !0}var t=ab.constructor;return"function"==typeof t&&t instanceof t&&ez.call(t)==hw}function gl(ab){var ad,t,ac;if(!ab||"object"!=typeof ab){return ab}if(Array.isArray(ab)){for(ad=[],t=0,ac=ab.length;ac>t;t++){ad[t]=gl(ab[t])}return ad}if(ab instanceof Date){return ab.toISOString()}if(ee(ab)){return h2(ab)}if(!hE(ab)){return ab}ad={};for(t in ab){if(Object.prototype.hasOwnProperty.call(ab,t)){var aa=gl(ab[t]);"undefined"!=typeof aa&&(ad[t]=aa)}}return ad}function fZ(t){var aa=!1;return je(function(ab){if(aa){throw new Error("once called more than once")}aa=!0,t.apply(this,ab)})}function er(t){return je(function(ac){ac=gl(ac);var ab,aa=this,ad="function"==typeof ac[ac.length-1]?ac.pop():!1;ad&&(ab=function(ah,ag){fp.nextTick(function(){ad(ah,ag)})});var af=new ij(function(ag,ah){var ak;try{var al=fZ(function(ap,am){ap?ah(ap):ag(am)});ac.push(al),ak=t.apply(aa,ac),ak&&"function"==typeof ak.then&&ag(ak)}catch(aj){ah(aj)}});return ab&&af.then(function(ag){ab(null,ag)},ab),af})}function gz(aa,ab){function t(ac,af,ah){if(h7.enabled){for(var ad=[ac._db_name,af],aj=0;aj<ah.length-1;aj++){ad.push(ah[aj])}h7.apply(null,ad);var ag=ah[ah.length-1];ah[ah.length-1]=function(ak,am){var al=[ac._db_name,af];al=al.concat(ak?["error",ak]:["success",am]),h7.apply(null,al),ag(ak,am)}}}return er(je(function(ad){if(this._closed){return ij.reject(new Error("database is closed"))}if(this._destroyed){return ij.reject(new Error("database is destroyed"))}var ac=this;return t(ac,aa,ad),this.taskqueue.isReady?ab.apply(this,ad):new ij(function(ag,af){ac.taskqueue.addTask(function(ah){ah?af(ah):ag(ac[aa].apply(ac,ad))})})}))}function fc(ab,ad){for(var t={},ac=0,aa=ad.length;aa>ac;ac++){var af=ad[ac];af in ab&&(t[af]=ab[af])}return t}function fU(t){return t}function ii(t){return[{ok:t}]}function co(aa,am,ac){function ak(){var av=[];ad.forEach(function(aw){aw.docs.forEach(function(ax){av.push({id:aw.id,docs:[ax]})})}),ac(null,{results:av})}function af(){++ap===aj&&ak()}function ab(av,aw,ax){ad[av]={id:aw,docs:ax},af()}function ah(){if(!(al>=ag.length)){var av=Math.min(al+jm,ag.length),aw=ag.slice(al,av);aq(aw,al),al+=aw.length}}function aq(av,aw){av.forEach(function(aA,ay){var aC=aw+ay,aB=t[aA],ax=fc(aB[0],["atts_since","attachments"]);ax.open_revs=aB.map(function(aD){return aD.rev}),ax.open_revs=ax.open_revs.filter(fU);var az=fU;0===ax.open_revs.length&&(delete ax.open_revs,az=ii),["revs","attachments","binary","ajax"].forEach(function(aD){aD in am&&(ax[aD]=am[aD])}),aa.get(aA,ax,function(aD,aF){var aE;aE=aD?[{error:aD}]:az(aF),ab(aC,aA,aE),ah()})})}var au=am.docs,t={};au.forEach(function(av){av.id in t?t[av.id].push(av):t[av.id]=[av]});var aj=Object.keys(t).length,ap=0,ad=new Array(aj),ag=Object.keys(t),al=0;ah()}function fd(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function gf(){return ei}function cn(t){fd()?chrome.storage.onChanged.addListener(function(aa){null!=aa.db_name&&t.emit(aa.dbName.newValue)}):gf()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(aa){t.emit(aa.key)}):window.attachEvent("storage",function(aa){t.emit(aa.key)}))}function gC(){hS.EventEmitter.call(this),this._listeners={},cn(this)}function go(t){if("undefined"!==console&&t in console){var aa=Array.prototype.slice.call(arguments,1);console[t].apply(console,aa)}}function fi(ab,ad){var t=600000;ab=parseInt(ab,10)||0,ad=parseInt(ad,10),ad!==ad||ab>=ad?ad=(ab||1)<<1:ad+=1,ad>t&&(ab=t>>1,ad=t);var ac=Math.random(),aa=ad-ab;return ~~(aa*ac+ab)}function iC(t){var aa=0;return t||(aa=2000),fi(t,aa)}function jd(t,aa){go("info","The above "+t+" is totally normal. "+aa)}function a7(t){Error.call(this,t.reason),this.status=t.status,this.name=t.error,this.message=t.reason,this.error=!0}function hn(ac,aa,ab){function t(af){for(var ad in ac){"function"!=typeof ac[ad]&&(this[ad]=ac[ad])}void 0!==ab&&(this.name=ab),void 0!==af&&(this.reason=af)}return t.prototype=a7.prototype,new t(aa)}function jt(ab){var ad,t,ac,aa,af;return t=ab.error===!0&&"string"==typeof ab.name?ab.name:ab.error,af=ab.reason,ac=gu("name",t,af),ab.missing||"missing"===af||"deleted"===af||"not_found"===t?ac=g3:"doc_validation"===t?(ac=m,aa=af):"bad_request"===t&&ac.message!==af&&(ac=fn),ac||(ac=gu("status",ab.status,af)||q),ad=hn(ac,af,t),aa&&(ad.message=aa),ab.id&&(ad.id=ab.id),ab.status&&(ad.status=ab.status),ab.missing&&(ad.missing=ab.missing),ad}function g9(ab,ad,t){try{return !ab(ad,t)}catch(ac){var aa="Filter function threw: "+ac.toString();return hn(fn,aa)}}function iO(aa){var ab={},t=aa.filter&&"function"==typeof aa.filter;return ab.query=aa.query_params,function(ad){ad.doc||(ad.doc={});var ac=t&&g9(aa.filter,ad.doc,ab);if("object"==typeof ac){return ac}if(ac){return !1}if(aa.include_docs){if(!aa.attachments){for(var af in ad.doc._attachments){ad.doc._attachments.hasOwnProperty(af)&&(ad.doc._attachments[af].stub=!0)}}}else{delete ad.doc}return !0}}function ci(ac){for(var aa=[],ab=0,t=ac.length;t>ab;ab++){aa=aa.concat(ac[ab])}return aa}function gX(t){var aa;if(t?"string"!=typeof t?aa=hn(hi):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(aa=hn(at)):aa=hn(fV),aa){throw aa}}function fv(t,aa){return"listenerCount" in t?t.listenerCount(aa):hS.EventEmitter.listenerCount(t,aa)}function fh(t){if(!t){return null}var aa=t.split("/");return 2===aa.length?aa:1===aa.length?[t,t]:null}function hs(t){var aa=fh(t);return aa?aa.join("/"):null}function y(aa){for(var ac=fz.exec(aa),ag={},ab=14;ab--;){var t=iB[ab],ad=ac[ab]||"",af=-1!==["user","password"].indexOf(t);ag[t]=af?decodeURIComponent(ad):ad}return ag[gL]={},ag[iB[12]].replace(be,function(aj,ah,ak){ah&&(ag[gL][ah]=ak)}),ag}function gh(aa,ab,t){return new ij(function(ad,ac){aa.get(ab,function(ag,aj){if(ag){if(404!==ag.status){return ac(ag)}aj={}}var af=aj._rev,ah=t(aj);return ah?(ah._id=ab,ah._rev=af,void ad(fu(aa,ah,t))):ad({updated:!1,rev:af})})})}function fu(aa,ab,t){return aa.put(ab).then(function(ac){return{updated:!0,rev:ac.rev}},function(ac){if(409!==ac.status){throw ac}return gh(aa,ab._id,t)})}function gs(t){return 0|Math.random()*t}function iT(ac,aa){aa=aa||dn.length;var ab="",t=-1;if(ac){for(;++t<ac;){ab+=dn[gs(aa)]}return ab}for(;++t<36;){switch(t){case 8:case 13:case 18:case 23:ab+="-";break;case 19:ab+=dn[3&gs(16)|8];break;default:ab+=dn[gs(16)]}}return ab}function iP(t){for(var aj,af,ah,ag,ac=t.rev_tree.slice();ag=ac.pop();){var al=ag.ids,ab=al[2],ak=ag.pos;if(ab.length){for(var am=0,aa=ab.length;aa>am;am++){ac.push({pos:ak+1,ids:ab[am]})}}else{var ad=!!al[1].deleted,ap=al[0];aj&&!(ah!==ad?ah:af!==ak?ak>af:ap>aj)||(aj=ap,af=ak,ah=ad)}}return af+"-"+aj}function ga(af,ac){for(var ah,ak=af.slice();ah=ak.pop();){for(var aj=ah.pos,ag=ah.ids,ad=ag[2],aa=ac(0===ad.length,aj,ag[0],ah.ctx,ag[1]),t=0,ab=ad.length;ab>t;t++){ak.push({pos:aj+1,ids:ad[t],ctx:aa})}}}function i1(t,aa){return t.pos-aa.pos}function ev(ac){var aa=[];ga(ac,function(ad,ah,af,aj,ag){ad&&aa.push({rev:ah+"-"+af,pos:ah,opts:ag})}),aa.sort(i1).reverse();for(var ab=0,t=aa.length;t>ab;ab++){delete aa[ab].pos}return aa}function jE(aa){for(var ac=iP(aa),ag=ev(aa.rev_tree),ab=[],t=0,ad=ag.length;ad>t;t++){var af=ag[t];af.rev===ac||af.opts.deleted||ab.push(af.rev)}return ab}function iv(t){var aa=[];return ga(t.rev_tree,function(ac,ag,ad,ab,af){"available"!==af.status||ac||(aa.push(ag+"-"+ad),af.status="missing")}),aa}function w(t){for(var aj,af=[],ah=t.slice();aj=ah.pop();){var ag=aj.pos,ac=aj.ids,al=ac[0],ab=ac[1],ak=ac[2],am=0===ak.length,aa=aj.history?aj.history.slice():[];aa.push({id:al,opts:ab}),am&&af.push({pos:ag+1-aa.length,ids:aa});for(var ad=0,ap=ak.length;ap>ad;ad++){ah.push({pos:ag+1,ids:ak[ad],history:aa})}}return af.reverse()}function g0(t,aa){return t.pos-aa.pos}function gk(ab,ad,t){for(var ac,aa=0,af=ab.length;af>aa;){ac=aa+af>>>1,t(ab[ac],ad)<0?aa=ac+1:af=ac}return aa}function a4(ac,aa,ab){var t=gk(ac,aa,ab);ac.splice(t,0,aa)}function ex(ad,ab){for(var aa,t,ac=ab,ag=ad.length;ag>ac;ac++){var ah=ad[ac],af=[ah.id,ah.opts,[]];t?(t[2].push(af),t=af):aa=t=af}return aa}function iD(t,aa){return t[0]<aa[0]?-1:1}function iM(af,ac){for(var ah=[{tree1:af,tree2:ac}],ak=!1;ah.length>0;){var aj=ah.pop(),ag=aj.tree1,ad=aj.tree2;(ag[1].status||ad[1].status)&&(ag[1].status="available"===ag[1].status||"available"===ad[1].status?"available":"missing");for(var aa=0;aa<ad[2].length;aa++){if(ag[2][0]){for(var t=!1,ab=0;ab<ag[2].length;ab++){ag[2][ab][0]===ad[2][aa][0]&&(ah.push({tree1:ag[2][ab],tree2:ad[2][aa]}),t=!0)}t||(ak="new_branch",a4(ag[2],ad[2][aa],iD))}else{ak="new_leaf",ag[2][0]=ad[2][aa]}}}return{conflicts:ak,tree:af}}function hU(al,ak,am){var aq,av=[],ag=!1,aa=!1;if(!al.length){return{tree:[ak],conflicts:"new_leaf"}}for(var ah=0,aw=al.length;aw>ah;ah++){var ap=al[ah];if(ap.pos===ak.pos&&ap.ids[0]===ak.ids[0]){aq=iM(ap.ids,ak.ids),av.push({pos:ap.pos,ids:aq.tree}),ag=ag||aq.conflicts,aa=!0}else{if(am!==!0){var t=ap.pos<ak.pos?ap:ak,aj=ap.pos<ak.pos?ak:ap,ab=aj.pos-t.pos,ad=[],ax=[];for(ax.push({ids:t.ids,diff:ab,parent:null,parentIdx:null});ax.length>0;){var ay=ax.pop();if(0!==ay.diff){for(var az=ay.ids[2],ac=0,af=az.length;af>ac;ac++){ax.push({ids:az[ac],diff:ay.diff-1,parent:ay.ids,parentIdx:ac})}}else{ay.ids[0]===aj.ids[0]&&ad.push(ay)}}var au=ad[0];au?(aq=iM(au.ids,aj.ids),au.parent[2][au.parentIdx]=aq.tree,av.push({pos:t.pos,ids:t.ids}),ag=ag||aq.conflicts,aa=!0):av.push(ap)}else{av.push(ap)}}}return aa||av.push(ak),av.sort(g0),{tree:av,conflicts:ag||"internal_node"}}function hB(t,aj){for(var af,ah=w(t),ag={},ac=0,al=ah.length;al>ac;ac++){for(var ab=ah[ac],ak=ab.ids,am=Math.max(0,ak.length-aj),aa={pos:ab.pos+am,ids:ex(ak,am)},ad=0;am>ad;ad++){var ap=ab.pos+ad+"-"+ak[ad].id;ag[ap]=!0}af=af?hU(af,aa,!0).tree:[aa]}return ga(af,function(aq,au,av){delete ag[au+"-"+av]}),{tree:af,revs:Object.keys(ag)}}function jg(ab,ad,t){var ac=hU(ab,ad),aa=hB(ac.tree,t);return{tree:aa.tree,stemmedRevs:aa.revs,conflicts:ac.conflicts}}function hF(af,ac){for(var ah,ak=af.slice(),aj=ac.split("-"),ag=parseInt(aj[0],10),ad=aj[1];ah=ak.pop();){if(ah.pos===ag&&ah.ids[0]===ad){return !0}for(var aa=ah.ids[2],t=0,ab=aa.length;ab>t;t++){ak.push({pos:ah.pos+1,ids:aa[t]})}}return !1}function di(t){return t.ids}function gO(ab,ad){ad||(ad=iP(ab));for(var t,ac=ad.substring(ad.indexOf("-")+1),aa=ab.rev_tree.map(di);t=aa.pop();){if(t[0]===ac){return !!t[1].deleted}aa=aa.concat(t[2])}}function a3(t){return/^_local/.test(t)}function hR(t){return hK("return "+t+";",{})}function h1(t){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+t+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function fS(aa,ab){try{aa.emit("change",ab)}catch(t){go("error",'Error in .on("change", function):',t)}}function g6(aa,ac,ag){function ab(){t.cancel()}hS.EventEmitter.call(this);var t=this;this.db=aa,ac=ac?gl(ac):{};var ad=ac.complete=fZ(function(ah,aj){ah?fv(t,"error")>0&&t.emit("error",ah):t.emit("complete",aj),t.removeAllListeners(),aa.removeListener("destroyed",ab)});ag&&(t.on("complete",function(ah){ag(null,ah)}),t.on("error",ag)),aa.once("destroyed",ab),ac.onChange=function(ah){ac.isCancelled||(fS(t,ah),t.startSeq&&t.startSeq<=ah.seq&&(t.startSeq=!1))};var af=new ij(function(ah,aj){ac.complete=function(al,ak){al?aj(al):ah(ak)}});t.once("cancel",function(){aa.removeListener("destroyed",ab),ac.complete(null,{status:"cancelled"})}),this.then=af.then.bind(af),this["catch"]=af["catch"].bind(af),this.then(function(ah){ad(null,ah)},ad),aa.taskqueue.isReady?t.doChanges(ac):aa.taskqueue.addTask(function(){t.isCancelled?t.emit("cancel"):t.doChanges(ac)})}function eo(ab,ad,t){var ac=[{rev:ab._rev}];"all_docs"===t.style&&(ac=ev(ad.rev_tree).map(function(af){return{rev:af.rev}}));var aa={id:ad.id,changes:ac,doc:ab};return gO(ad,ab._rev)&&(aa.deleted=!0),t.conflicts&&(aa.doc._conflicts=jE(ad),aa.doc._conflicts.length||delete aa.doc._conflicts),aa}function bo(t,aa){return aa>t?-1:t>aa?1:0}function gA(aa,ab){for(var t=0;t<aa.length;t++){if(ab(aa[t],t)===!0){return aa[t]}}}function im(t){return function(ab,aa){ab||aa[0]&&aa[0].error?t(ab||aa[0]):t(null,aa.length?aa[0]:aa)}}function r(ab){for(var ad=0;ad<ab.length;ad++){var t=ab[ad];if(t._deleted){delete t._attachments}else{if(t._attachments){for(var ac=Object.keys(t._attachments),aa=0;aa<ac.length;aa++){var af=ac[aa];t._attachments[af]=fc(t._attachments[af],["data","digest","content_type","length","revpos","stub"])}}}}}function fT(ab,ad){var t=bo(ab._id,ad._id);if(0!==t){return t}var ac=ab._revisions?ab._revisions.start:0,aa=ad._revisions?ad._revisions.start:0;return bo(ac,aa)}function iz(aa){var ab={},t=[];return ga(aa,function(ac,ad,ah,af){var ag=ad+"-"+ah;return ac&&(ab[ag]=0),void 0!==af&&t.push({from:af,to:ag}),ag}),t.reverse(),t.forEach(function(ac){void 0===ab[ac.from]?ab[ac.from]=1+ab[ac.to]:ab[ac.from]=Math.min(ab[ac.from],1+ab[ac.to])}),ab}function g(ab,ad,t){var ac="limit" in ad?ad.keys.slice(ad.skip,ad.limit+ad.skip):ad.skip>0?ad.keys.slice(ad.skip):ad.keys;if(ad.descending&&ac.reverse(),!ac.length){return ab._allDocs({limit:0},t)}var aa={offset:ad.skip};return ij.all(ac.map(function(af){var ag=iF.extend({key:af,deleted:"ok"},ad);return["limit","skip","keys"].forEach(function(ah){delete ag[ah]}),new ij(function(ah,aj){ab._allDocs(ag,function(ak,al){return ak?aj(ak):(aa.total_rows=al.total_rows,void ah(al.rows[0]||{key:af,error:"not_found"}))})})})).then(function(af){return aa.rows=af,aa})}function ar(ac){var aa=ac._compactionQueue[0],t=aa.opts,ab=aa.callback;ac.get("_local/compaction")["catch"](function(){return !1}).then(function(ad){ad&&ad.last_seq&&(t.last_seq=ad.last_seq),ac._compact(t,function(ag,af){ag?ab(ag):ab(null,af),fp.nextTick(function(){ac._compactionQueue.shift(),ac._compactionQueue.length&&ar(ac)})})})}function iu(t){return"_"===t.charAt(0)?t+"is not a valid attachment name, attachment names cannot start with '_'":!1}function iS(){hS.EventEmitter.call(this)}function ih(){this.isReady=!1,this.failed=!1,this.queue=[]}function jl(t){t&&gM.debug&&go("error",t)}function fW(aa,ac){function ag(){ad.emit("destroyed",t)}function ab(){aa.removeListener("destroyed",ag),aa.emit("destroyed",aa)}var t=ac.originalName,ad=aa.constructor,af=ad._destructionListeners;aa.once("destroyed",ag),af.has(t)||af.set(t,[]),af.get(t).push(ab)}function fa(aa,ac,ag){if(!(this instanceof fa)){return new fa(aa,ac,ag)}var ab=this;if("function"!=typeof ac&&"undefined"!=typeof ac||(ag=ac,ac={}),aa&&"object"==typeof aa&&(ac=aa,aa=void 0),"undefined"==typeof ag){ag=jl}else{var t=ag;ag=function(){return go("warn","Using a callback for new PouchDB()is deprecated."),t.apply(null,arguments)}}aa=aa||ac.name,ac=gl(ac),delete ac.name,this.__opts=ac;var ad=ag;ab.auto_compaction=ac.auto_compaction,ab.prefix=fa.prefix,iS.call(ab),ab.taskqueue=new ih;var af=new ij(function(ak,ah){ag=function(ap,am){return ap?ah(ap):(delete am.then,void ak(am))},ac=gl(ac);var aj,al;return function(){try{if("string"!=typeof aa){throw al=new Error("Missing/invalid DB name"),al.code=400,al}var ap=(ac.prefix||"")+aa;if(aj=fa.parseAdapter(ap,ac),ac.originalName=aa,ac.name=aj.name,ac.adapter=ac.adapter||aj.adapter,ab._adapter=ac.adapter,jC("pouchdb:adapter")("Picked adapter: "+ac.adapter),ab._db_name=aa,!fa.adapters[ac.adapter]){throw al=new Error("Adapter is missing"),al.code=404,al}if(!fa.adapters[ac.adapter].valid()){throw al=new Error("Invalid Adapter"),al.code=404,al}}catch(am){ab.taskqueue.fail(am)}}(),al?ah(al):(ab.adapter=ac.adapter,ab.replicate={},ab.replicate.from=function(aq,am,ap){return ab.constructor.replicate(aq,ab,am,ap)},ab.replicate.to=function(aq,am,ap){return ab.constructor.replicate(ab,aq,am,ap)},ab.sync=function(aq,am,ap){return ab.constructor.sync(ab,aq,am,ap)},ab.replicate.sync=ab.sync,void fa.adapters[ac.adapter].call(ab,ac,function(am){return am?(ab.taskqueue.fail(am),void ag(am)):(fW(ab,ac),ab.emit("created",ab),fa.emit("created",ac.originalName),ab.taskqueue.ready(ab),void ag(null,ab))}))});af.then(function(ah){ad(null,ah)},ad),ab.then=af.then.bind(af),ab["catch"]=af["catch"].bind(af)}function iy(t){Object.keys(hS.EventEmitter.prototype).forEach(function(ab){"function"==typeof hS.EventEmitter.prototype[ab]&&(t[ab]=fX[ab].bind(fX))});var aa=t._destructionListeners=new iq.Map;t.on("destroyed",function(ab){aa.get(ab).forEach(function(ac){ac()}),aa["delete"](ab)})}function hA(t){return t.reduce(function(aa,ab){return aa[ab]=!0,aa},{})}function H(ac){if(!/^\d+\-./.test(ac)){return hn(fm)}var aa=ac.indexOf("-"),ab=ac.substring(0,aa),t=ac.substring(aa+1);return{prefix:parseInt(ab,10),id:t}}function g4(aa,ac){for(var ag=aa.start-aa.ids.length+1,ab=aa.ids,t=[ab[0],ac,[]],ad=1,af=ab.length;af>ad;ad++){t=[ab[ad],{status:"missing"},[t]]}return[{pos:ag,ids:t}]}function g5(af,ac){var ah,ak,aj,ag={status:"available"};if(af._deleted&&(ag.deleted=!0),ac){if(af._id||(af._id=iT()),ak=iT(32,16).toLowerCase(),af._rev){if(aj=H(af._rev),aj.error){return aj}af._rev_tree=[{pos:aj.prefix,ids:[aj.id,{status:"missing"},[[ak,ag,[]]]]}],ah=aj.prefix+1}else{af._rev_tree=[{pos:1,ids:[ak,ag,[]]}],ah=1}}else{if(af._revisions&&(af._rev_tree=g4(af._revisions,ag),ah=af._revisions.start,ak=af._revisions.ids[0]),!af._rev_tree){if(aj=H(af._rev),aj.error){return aj}ah=aj.prefix,ak=aj.id,af._rev_tree=[{pos:ah,ids:[ak,ag,[]]}]}}gX(af._id),af._rev=ah+"-"+ak;var ad={metadata:{},data:{}};for(var aa in af){if(Object.prototype.hasOwnProperty.call(af,aa)){var t="_"===aa[0];if(t&&!iX[aa]){var ab=hn(m,aa);throw ab.message=m.message+": "+aa,ab}t&&!hY[aa]?ad.metadata[aa.slice(1)]=af[aa]:ad.data[aa]=af[aa]}}return ad}function fx(ab){for(var ad="",t=new Uint8Array(ab),ac=t.byteLength,aa=0;ac>aa;aa++){ad+=String.fromCharCode(t[aa])}return ad}function hv(t){return h3(fx(t))}function Z(ab,ad){ab=ab||[],ad=ad||{};try{return new Blob(ab,ad)}catch(t){if("TypeError"!==t.name){throw t}for(var ac="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,aa=new ac,af=0;af<ab.length;af+=1){aa.append(ab[af])}return aa.getBlob(ad.type)}}function O(ab){for(var ad=ab.length,t=new ArrayBuffer(ad),ac=new Uint8Array(t),aa=0;ad>aa;aa++){ac[aa]=ab.charCodeAt(aa)}return t}function Y(t,aa){return Z([O(t)],{type:aa})}function h0(t,aa){return Y(gT(t),aa)}function gI(ac,aa){if("undefined"==typeof FileReader){return aa(fx((new FileReaderSync).readAsArrayBuffer(ac)))}var ab=new FileReader,t="function"==typeof ab.readAsBinaryString;ab.onloadend=function(af){var ad=af.target.result||"";return t?aa(ad):void aa(fx(ad))},t?ab.readAsBinaryString(ac):ab.readAsArrayBuffer(ac)}function ib(t,aa){gI(t,function(ab){aa(h3(ab))})}function hH(aa,ab){if("undefined"==typeof FileReader){return ab((new FileReaderSync).readAsArrayBuffer(aa))}var t=new FileReader;t.onloadend=function(ad){var ac=ad.target.result||new ArrayBuffer(0);ab(ac)},t.readAsArrayBuffer(aa)}function dt(t){return h3(t)}function gd(ac,aa,ab,t){(ab>0||t<aa.byteLength)&&(aa=new Uint8Array(aa,ab,Math.min(t,aa.byteLength)-ab)),ac.append(aa)}function eu(ac,aa,ab,t){(ab>0||t<aa.length)&&(aa=aa.substring(ab,t)),ac.appendBinary(aa)}function i3(af,ac){function ah(){var aq=aa*ag,al=aq+ag;if(aa++,ad>aa){ab(t,af,aq,al),ht(ah)}else{ab(t,af,aq,al);var ap=t.end(!0),am=dt(ap);ac(am),t.destroy()}}var ak="string"==typeof af,aj=ak?af.length:af.byteLength,ag=Math.min(iU,aj),ad=Math.ceil(aj/ag),aa=0,t=ak?new hg:new hg.ArrayBuffer,ab=ak?eu:gd;ah()}function a9(t){return hg.hash(t)}function gy(ad,ab,aa){function t(al){try{return gT(al)}catch(aj){var ak=hn(ik,"Attachment is not a valid base64 string");return{error:ak}}}function ac(aj,ak){if(aj.stub){return ak()}if("string"==typeof aj.data){var al=t(aj.data);if(al.error){return ak(al.error)}aj.length=al.length,"blob"===ab?aj.data=Y(al,aj.content_type):"base64"===ab?aj.data=h3(al):aj.data=al,i3(al,function(am){aj.digest="md5-"+am,ak()})}else{hH(aj.data,function(am){"binary"===ab?aj.data=fx(am):"base64"===ab&&(aj.data=hv(am)),i3(am,function(ap){aj.digest="md5-"+ap,aj.length=am.byteLength,ak()})})}}function ag(){af++,ad.length===af&&(ah?aa(ah):aa())}if(!ad.length){return aa()}var ah,af=0;ad.forEach(function(ak){function am(aq){ah=aq,al++,al===aj.length&&ag()}var aj=ak.data&&ak.data._attachments?Object.keys(ak.data._attachments):[],al=0;if(!aj.length){return ag()}for(var ap in ak.data._attachments){ak.data._attachments.hasOwnProperty(ap)&&ac(ak.data._attachments[ap],am)}})}function ix(aA,ad,ak,al,ag,ax,af,az){if(hF(ad.rev_tree,ak.metadata.rev)){return al[ag]=ak,ax()}var ac=ad.winningRev||iP(ad),au="deleted" in ad?ad.deleted:gO(ad,ac),aa="deleted" in ak.metadata?ak.metadata.deleted:gO(ak.metadata),aq=/^1-/.test(ak.metadata.rev);if(au&&!aa&&az&&aq){var am=ak.data;am._rev=ac,am._id=ak.metadata.id,ak=g5(am,az)}var ay=jg(ad.rev_tree,ak.metadata.rev_tree[0],aA),t=az&&(au&&aa||!au&&"new_leaf"!==ay.conflicts||au&&!aa&&"new_branch"===ay.conflicts);if(t){var av=hn(gN);return al[ag]=av,ax()}var aw=ak.metadata.rev;ak.metadata.rev_tree=ay.tree,ak.stemmedRevs=ay.stemmedRevs||[],ad.rev_map&&(ak.metadata.rev_map=ad.rev_map);var aj,ab=iP(ak.metadata),ap=gO(ak.metadata,ab),ah=au===ap?0:ap>au?-1:1;aj=aw===ab?ap:gO(ak.metadata,aw),af(ak,ab,ap,aj,!0,ah,ag,ax)}function z(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function jD(af,t,am,ad,aa,ak,ac,aq,al){function ah(aA,aC,aw){var az=iP(aA.metadata),ax=gO(aA.metadata,az);if("was_delete" in aq&&ax){return ak[aC]=hn(g3,"deleted"),aw()}var ay=ab&&z(aA);if(ay){var av=hn(gN);return ak[aC]=av,aw()}var aB=ax?0:1;ac(aA,az,ax,ax,!1,aB,aC,aw)}function aj(){++ag===ap&&al&&al()}af=af||1000;var ab=aq.new_edits,au=new iq.Map,ag=0,ap=t.length;t.forEach(function(ay,aw){if(ay._id&&a3(ay._id)){var av=ay._deleted?"_removeLocal":"_putLocal";return void am[av](ay,{ctx:aa},function(aA,az){ak[aw]=aA||az,aj()})}var ax=ay.metadata.id;au.has(ax)?(ap--,au.get(ax).push([ay,aw])):au.set(ax,[[ay,aw]])}),au.forEach(function(aw,ay){function az(){++ax<aw.length?av():aj()}function av(){var aC=aw[ax],aA=aC[0],aB=aC[1];if(ad.has(ay)){ix(af,ad.get(ay),aA,ak,aB,az,ac,ab)}else{var aD=jg([],aA.metadata.rev_tree[0],af);aA.metadata.rev_tree=aD.tree,aA.stemmedRevs=aD.stemmedRevs||[],ah(aA,aB,az)}}var ax=0;av()})}function js(t){try{return JSON.parse(t)}catch(aa){return gi.parse(t)}}function bn(t){return t.length<50000?JSON.parse(t):js(t)}function R(t){try{return JSON.stringify(t)}catch(aa){return gi.stringify(t)}}function a8(ab,ad,t,ac){try{ab.apply(ad,t)}catch(aa){ac.emit("error",aa)}}function jn(t){if(!a2.running&&a2.queue.length){a2.running=!0;var aa=a2.queue.shift();aa.action(function(ac,ab){a8(aa.callback,this,[ac,ab],t),a2.running=!1,fp.nextTick(function(){jn(t)})})}}function jB(t){return function(ab){var aa="unknown_error";ab.target&&ab.target.error&&(aa=ab.target.error.name||ab.target.error.message),t(hn(gx,aa,ab.type))}}function hz(aa,ab,t){return{data:R(aa),winningRev:ab,deletedOrLocal:t?"1":"0",seq:aa.seq,id:aa.id}}function hq(t){if(!t){return null}var aa=bn(t.data);return aa.winningRev=t.winningRev,aa.deleted="1"===t.deletedOrLocal,aa.seq=t.seq,aa}function S(t){if(!t){return t}var aa=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,aa-1),t._rev=t._doc_id_rev.substring(aa+1),delete t._doc_id_rev,t}function gE(ac,aa,ab,t){ab?t(ac?"string"!=typeof ac?ac:h0(ac,aa):Z([""],{type:aa})):ac?"string"!=typeof ac?gI(ac,function(ad){t(h3(ad))}):t(ac):t("")}function i2(ad,ab,aa,t){function ac(){++af===ah.length&&t&&t()}function ag(aj,al){var ak=aj._attachments[al],am=ak.digest,ap=aa.objectStore(hQ).get(am);ap.onsuccess=function(aq){ak.body=aq.target.result.body,ac()}}var ah=Object.keys(ad._attachments||{});if(!ah.length){return t&&t()}var af=0;ah.forEach(function(aj){ab.attachments&&ab.include_docs?ag(ad,aj):(ad._attachments[aj].stub=!0,ac())})}function jk(t,aa){return ij.all(t.map(function(ac){if(ac.doc&&ac.doc._attachments){var ab=Object.keys(ac.doc._attachments);return ij.all(ab.map(function(af){var ah=ac.doc._attachments[af];if("body" in ah){var ag=ah.body,ad=ah.content_type;return new ij(function(aj){gE(ag,ad,aa,function(ak){ac.doc._attachments[af]=iF.extend(fc(ah,["digest","content_type"]),{data:ak}),aj()})})}}))}}))}function hN(af,ac,ah){function ak(){ab--,ab||aj()}function aj(){ag.length&&ag.forEach(function(am){var al=t.index("digestSeq").count(IDBKeyRange.bound(am+"::",am+"::￿",!1,!1));al.onsuccess=function(aq){var ap=aq.target.result;ap||aa["delete"](am)}})}var ag=[],ad=ah.objectStore(g2),aa=ah.objectStore(hQ),t=ah.objectStore(hD),ab=af.length;af.forEach(function(al){var am=ad.index("_doc_id_rev"),ap=ac+"::"+al;am.getKey(ap).onsuccess=function(au){var av=au.target.result;if("number"!=typeof av){return ak()}ad["delete"](av);var aq=t.index("seq").openCursor(IDBKeyRange.only(av));aq.onsuccess=function(ax){var ay=ax.target.result;if(ay){var aw=ay.value.digestSeq.split("::")[0];ag.push(aw),t["delete"](ay.primaryKey),ay["continue"]()}else{ak()}}}})}function ja(ac,aa,ab){try{return{txn:ac.transaction(aa,ab)}}catch(t){return{error:t}}}function hf(am,aF,ap,au,az,ay,aJ){function aH(){var aN=[gv,g2,hQ,iG,hD],aO=ja(az,aN,"readwrite");return aO.error?aJ(aO.error):(aB=aO.txn,aB.onabort=jB(aJ),aB.ontimeout=jB(aJ),aB.oncomplete=aC,al=aB.objectStore(gv),av=aB.objectStore(g2),ag=aB.objectStore(hQ),aq=aB.objectStore(hD),void aM(function(aP){return aP?(aE=!0,aJ(aP)):void aL()}))}function ax(){jD(am.revs_limit,ab,au,aw,aB,aa,aI,ap)}function aL(){function aQ(){++aO===ab.length&&ax()}function aS(aU){var aV=hq(aU.target.result);aV&&aw.set(aV.id,aV),aQ()}if(ab.length){for(var aO=0,aR=0,aP=ab.length;aP>aR;aR++){var aT=ab[aR];if(aT._id&&a3(aT._id)){aQ()}else{var aN=al.get(aT.metadata.id);aN.onsuccess=aS}}}}function aC(){aE||(ay.notify(au._meta.name),au._meta.docCount+=aA,aJ(null,aa))}function aG(aO,aP){var aN=ag.get(aO);aN.onsuccess=function(aQ){if(aQ.target.result){aP()}else{var aR=hn(hG,"unknown stub attachment with digest "+aO);aR.status=412,aP(aR)}}}function aM(aP){function aR(){++aO===aN.length&&aP(aQ)}var aN=[];if(ab.forEach(function(aS){aS.data&&aS.data._attachments&&Object.keys(aS.data._attachments).forEach(function(aT){var aU=aS.data._attachments[aT];aU.stub&&aN.push(aU.digest)})}),!aN.length){return aP()}var aQ,aO=0;aN.forEach(function(aS){aG(aS,function(aT){aT&&!aQ&&(aQ=aT),aR()})})}function aI(aQ,aW,aS,aU,aT,aR,aO,aV){aA+=aR,aQ.metadata.winningRev=aW,aQ.metadata.deleted=aS;var aN=aQ.data;aN._id=aQ.metadata.id,aN._rev=aQ.metadata.rev,aU&&(aN._deleted=!0);var aP=aN._attachments&&Object.keys(aN._attachments).length;return aP?aD(aQ,aW,aS,aT,aO,aV):void ad(aQ,aW,aS,aT,aO,aV)}function ad(aP,aW,aU,aV,aS,aY){function aQ(aZ){var bb=aP.stemmedRevs||[];aV&&au.auto_compaction&&(bb=bb.concat(iv(aP.metadata))),bb&&bb.length&&hN(bb,aP.metadata.id,aB),aT.seq=aZ.target.result,delete aT.rev;var bc=hz(aT,aW,aU),ba=al.put(bc);ba.onsuccess=aN}function aX(aZ){aZ.preventDefault(),aZ.stopPropagation();var ba=av.index("_doc_id_rev"),bb=ba.getKey(aR._doc_id_rev);bb.onsuccess=function(bc){var bd=av.put(aR,bc.target.result);bd.onsuccess=aQ}}function aN(){aa[aS]={ok:!0,id:aT.id,rev:aW},aw.set(aP.metadata.id,aP.metadata),aj(aP,aT.seq,aY)}var aR=aP.data,aT=aP.metadata;aR._doc_id_rev=aT.id+"::"+aT.rev,delete aR._id,delete aR._rev;var aO=av.put(aR);aO.onsuccess=aQ,aO.onerror=aX}function aD(aP,aW,aS,aU,aT,aR){function aN(){aO===aQ.length&&ad(aP,aW,aS,aU,aT,aR)}function aV(){aO++,aN()}var aX=aP.data,aO=0,aQ=Object.keys(aX._attachments);aQ.forEach(function(bb){var aZ=aP.data._attachments[bb];if(aZ.stub){aO++,aN()}else{var aY=aZ.data;delete aZ.data,aZ.revpos=parseInt(aW,10);var ba=aZ.digest;ah(ba,aY,aV)}})}function aj(aR,aU,aP){function aS(){++aN===aO.length&&aP()}function aQ(aV){var aW=aR.data._attachments[aV].digest,aX=aq.put({seq:aU,digestSeq:aW+"::"+aU});aX.onsuccess=aS,aX.onerror=function(aY){aY.preventDefault(),aY.stopPropagation(),aS()}}var aN=0,aO=Object.keys(aR.data._attachments||{});if(!aO.length){return aP()}for(var aT=0;aT<aO.length;aT++){aQ(aO[aT])}}function ah(aO,aQ,aN){var aP=ag.count(aO);aP.onsuccess=function(aR){var aU=aR.target.result;if(aU){return aN()}var aS={digest:aO,body:aQ},aT=ag.put(aS);aT.onsuccess=aN}}for(var aB,al,av,ag,aq,ak,ab=aF.docs,aA=0,ac=0,af=ab.length;af>ac;ac++){var t=ab[ac];t._id&&a3(t._id)||(t=ab[ac]=g5(t,ap.new_edits),t.error&&!ak&&(ak=t))}if(ak){return aJ(ak)}var aa=new Array(ab.length),aw=new iq.Map,aE=!1,aK=au._meta.blobSupport?"blob":"base64";gy(ab,aK,function(aN){return aN?aJ(aN):void aH()})}function hW(ab,ad,t,ac,aa){try{if(ab&&ad){return aa?IDBKeyRange.bound(ad,ab,!t,!1):IDBKeyRange.bound(ab,ad,!1,!t)}if(ab){return aa?IDBKeyRange.upperBound(ab):IDBKeyRange.lowerBound(ab)}if(ad){return aa?IDBKeyRange.lowerBound(ad,!t):IDBKeyRange.upperBound(ad,!t)}if(ac){return IDBKeyRange.only(ac)}}catch(af){return{error:af}}return null}function jA(ac,aa,ab,t){return"DataError"===ab.name&&0===ab.code?t(null,{total_rows:ac._meta.docCount,offset:aa.skip,rows:[]}):void t(hn(gx,ab.name,ab.message))}function jq(ab,ad,t,ac){function aa(aG,aE){function au(aM,aN,aL){var aK=aM.id+"::"+aL;aJ.get(aK).onsuccess=function(aO){aN.doc=S(aO.target.result),aG.conflicts&&(aN.doc._conflicts=jE(aM)),i2(aN.doc,aG,al)}}function av(aM,aK,aL){var aN={id:aL.id,key:aL.id,value:{rev:aK}},aO=aL.deleted;if("ok"===aG.deleted){aI.push(aN),aO?(aN.value.deleted=!0,aN.doc=null):aG.include_docs&&au(aL,aN,aK)}else{if(!aO&&aB--<=0&&(aI.push(aN),aG.include_docs&&au(aL,aN,aK),0===--aj)){return}}aM["continue"]()}function ak(aL){ag=ad._meta.docCount;var aN=aL.target.result;if(aN){var aM=hq(aN.value),aK=aM.winningRev;av(aN,aK,aM)}}function aH(){aE(null,{total_rows:ag,offset:aG.skip,rows:aI})}function ax(){aG.attachments?jk(aI,aG.binary).then(aH):aH()}var am="startkey" in aG?aG.startkey:!1,aw="endkey" in aG?aG.endkey:!1,ah="key" in aG?aG.key:!1,aB=aG.skip||0,aj="number"==typeof aG.limit?aG.limit:-1,ay=aG.inclusive_end!==!1,aC="descending" in aG&&aG.descending?"prev":null,aA=hW(am,aw,ay,ah,aC);if(aA&&aA.error){return jA(ad,aG,aA.error,aE)}var aD=[gv,g2];aG.attachments&&aD.push(hQ);var aq=ja(t,aD,"readonly");if(aq.error){return aE(aq.error)}var al=aq.txn,aF=al.objectStore(gv),az=al.objectStore(g2),ap=aC?aF.openCursor(aA,aC):aF.openCursor(aA),aJ=az.index("_doc_id_rev"),aI=[],ag=0;al.oncomplete=ax,ap.onsuccess=ak}function af(ag,ah){return 0===ag.limit?ah(null,{total_rows:ad._meta.docCount,offset:ag.skip,rows:[]}):void aa(ag,ah)}af(ab,ac)}function hL(t){return new ij(function(ab){var aa=Z([""]);t.objectStore(jv).put(aa,"key"),t.onabort=function(ac){ac.preventDefault(),ac.stopPropagation(),ab(!1)},t.oncomplete=function(){var ad=navigator.userAgent.match(/Chrome\/(\d+)/),ac=navigator.userAgent.match(/Edge\//);ab(ac||!ad||parseInt(ad[1],10)>=43)}})["catch"](function(){return !1})}function I(aa,ab){var t=this;a2.queue.push({action:function(ac){iJ(t,aa,ac)},callback:ab}),jn(t.constructor)}function iJ(ac,ab,am){function ak(au){var av=au.createObjectStore(gv,{keyPath:"id"});au.createObjectStore(g2,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),au.createObjectStore(hQ,{keyPath:"digest"}),au.createObjectStore(a6,{keyPath:"id",autoIncrement:!1}),au.createObjectStore(jv),av.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),au.createObjectStore(iG,{keyPath:"_id"});var aw=au.createObjectStore(hD,{autoIncrement:!0});aw.createIndex("seq","seq"),aw.createIndex("digestSeq","digestSeq",{unique:!0})}function aj(au,av){var aw=au.objectStore(gv);aw.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),aw.openCursor().onsuccess=function(ay){var aA=ay.target.result;if(aA){var az=aA.value,ax=gO(az);az.deletedOrLocal=ax?"1":"0",aw.put(az),aA["continue"]()}else{av()}}}function ap(au){au.createObjectStore(iG,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function ad(av,ay){var az=av.objectStore(iG),ax=av.objectStore(gv),aw=av.objectStore(g2),au=ax.openCursor();au.onsuccess=function(aC){var aF=aC.target.result;if(aF){var aL=aF.value,aI=aL.id,aJ=a3(aI),aA=iP(aL);if(aJ){var aD=aI+"::"+aA,aG=aI+"::",aB=aI+"::~",aE=aw.index("_doc_id_rev"),aH=IDBKeyRange.bound(aG,aB,!1,!1),aK=aE.openCursor(aH);aK.onsuccess=function(aN){if(aK=aN.target.result){var aM=aK.value;aM._doc_id_rev===aD&&az.put(aM),aw["delete"](aK.primaryKey),aK["continue"]()}else{ax["delete"](aF.primaryKey),aF["continue"]()}}}else{aF["continue"]()}}else{ay&&ay()}}}function ah(au){var av=au.createObjectStore(hD,{autoIncrement:!0});av.createIndex("seq","seq"),av.createIndex("digestSeq","digestSeq",{unique:!0})}function ag(av,ay){var az=av.objectStore(g2),ax=av.objectStore(hQ),aw=av.objectStore(hD),au=ax.count();au.onsuccess=function(aB){var aA=aB.target.result;return aA?void (az.openCursor().onsuccess=function(aG){var aK=aG.target.result;if(!aK){return ay()}for(var aL=aK.value,aI=aK.primaryKey,aE=Object.keys(aL._attachments||{}),aC={},aD=0;aD<aE.length;aD++){var aF=aL._attachments[aE[aD]];aC[aF.digest]=!0}var aH=Object.keys(aC);for(aD=0;aD<aH.length;aD++){var aJ=aH[aD];aw.put({seq:aI,digestSeq:aJ+"::"+aI})}aK["continue"]()}):ay()}}function aa(ay){function ax(az){return az.data?hq(az):(az.deleted="1"===az.deletedOrLocal,az)}var au=ay.objectStore(g2),av=ay.objectStore(gv),aw=av.openCursor();aw.onsuccess=function(aC){function aB(){var aF=aD.id+"::",aH=aD.id+"::￿",aG=au.index("_doc_id_rev").openCursor(IDBKeyRange.bound(aF,aH)),aE=0;aG.onsuccess=function(aJ){var aK=aJ.target.result;if(!aK){return aD.seq=aE,az()}var aI=aK.primaryKey;aI>aE&&(aE=aI),aK["continue"]()}}function az(){var aE=hz(aD,aD.winningRev,aD.deleted),aF=av.put(aE);aF.onsuccess=function(){aA["continue"]()}}var aA=aC.target.result;if(aA){var aD=ax(aA.value);return aD.winningRev=aD.winningRev||iP(aD),aD.seq?az():void aB()}}}var al=ab.name,aq=null;ac._meta=null,ac.type=function(){return"idb"},ac._id=er(function(au){au(null,ac._meta.instanceId)}),ac._bulkDocs=function(aw,av,au){hf(ab,aw,av,ac,aq,B,au)},ac._get=function(az,av,aw){function aB(){aw(ay,{doc:aA,metadata:aC,ctx:au})}var aA,aC,ay,au=av.ctx;if(!au){var ax=ja(aq,[gv,g2,hQ],"readonly");if(ax.error){return aw(ax.error)}au=ax.txn}au.objectStore(gv).get(az).onsuccess=function(aG){if(aC=hq(aG.target.result),!aC){return ay=hn(g3,"missing"),aB()}if(gO(aC)&&!av.rev){return ay=hn(g3,"deleted"),aB()}var aE=au.objectStore(g2),aD=av.rev||aC.winningRev,aF=aC.id+"::"+aD;aE.index("_doc_id_rev").get(aF).onsuccess=function(aH){return aA=aH.target.result,aA&&(aA=S(aA)),aA?void aB():(ay=hn(g3,"missing"),aB())}}},ac._getAttachment=function(az,av,aw,aB,aA){var aC;if(aB.ctx){aC=aB.ctx}else{var ay=ja(aq,[gv,g2,hQ],"readonly");if(ay.error){return aA(ay.error)}aC=ay.txn}var au=aw.digest,ax=aw.content_type;aC.objectStore(hQ).get(au).onsuccess=function(aE){var aD=aE.target.result.body;gE(aD,ax,aB.binary,function(aF){aA(null,aF)})}},ac._info=function(av){if(null===aq||!ft.has(al)){var aA=new Error("db isn't open");return aA.id="idbNull",av(aA)}var ax,ay,az=ja(aq,[g2],"readonly");if(az.error){return av(az.error)}var aw=az.txn,au=aw.objectStore(g2).openCursor(null,"prev");au.onsuccess=function(aB){var aC=aB.target.result;ax=aC?aC.key:0,ay=ac._meta.docCount},aw.oncomplete=function(){av(null,{doc_count:ay,update_seq:ax,idb_attachment_format:ac._meta.blobSupport?"binary":"base64"})}},ac._allDocs=function(av,au){jq(av,ac,aq,au)},ac._changes=function(aK){function aB(aS){function aM(){return aN.seq!==aR?aS["continue"]():(aC=aR,aN.winningRev===aQ._rev?aO(aQ):void aP())}function aP(){var aU=aQ._id+"::"+aN.winningRev,aT=az.get(aU);aT.onsuccess=function(aV){aO(S(aV.target.result))}}function aO(aU){var aT=aK.processChange(aU,aN,aK);aT.seq=aN.seq;var aV=au(aT);return"object"==typeof aV?aK.complete(aV):(aV&&(aG++,aH&&aA.push(aT),aK.attachments&&aK.include_docs?i2(aU,aK,aJ,function(){jk([aT],aK.binary).then(function(){aK.onChange(aT)})}):aK.onChange(aT)),void (aG!==av&&aS["continue"]()))}var aQ=S(aS.value),aR=aS.key;if(ax&&!ax.has(aQ._id)){return aS["continue"]()}var aN;return(aN=ay.get(aQ._id))?aM():void (aw.get(aQ._id).onsuccess=function(aT){aN=hq(aT.target.result),ay.set(aQ._id,aN),aM()})}function aI(aN){var aM=aN.target.result;aM&&aB(aM)}function aL(){var aM=[gv,g2];aK.attachments&&aM.push(hQ);var aN=ja(aq,aM,"readonly");if(aN.error){return aK.complete(aN.error)}aJ=aN.txn,aJ.onabort=jB(aK.complete),aJ.oncomplete=aF,aD=aJ.objectStore(g2),aw=aJ.objectStore(gv),az=aD.index("_doc_id_rev");var aO;aO=aK.descending?aD.openCursor(null,"prev"):aD.openCursor(IDBKeyRange.lowerBound(aK.since,!0)),aO.onsuccess=aI}function aF(){function aM(){aK.complete(null,{results:aA,last_seq:aC})}!aK.continuous&&aK.attachments?jk(aA).then(aM):aM()}if(aK=gl(aK),aK.continuous){var aE=al+":"+iT();return B.addListener(al,aE,ac,aK),B.notify(al),{cancel:function(){B.removeListener(al,aE)}}}var ax=aK.doc_ids&&new iq.Set(aK.doc_ids);aK.since=aK.since||0;var aC=aK.since,av="limit" in aK?aK.limit:-1;0===av&&(av=1);var aH;aH="return_docs" in aK?aK.return_docs:"returnDocs" in aK?aK.returnDocs:!0;var aJ,aD,aw,az,aA=[],aG=0,au=iO(aK),ay=new iq.Map;aL()},ac._close=function(au){return null===aq?au(hn(io)):(aq.close(),ft["delete"](al),aq=null,void au())},ac._getRevisionTree=function(ay,ax){var au=ja(aq,[gv],"readonly");if(au.error){return ax(au.error)}var av=au.txn,aw=av.objectStore(gv).get(ay);aw.onsuccess=function(aA){var az=hq(aA.target.result);az?ax(null,az.rev_tree):ax(hn(g3))}},ac._doCompaction=function(aA,av,ay){var au=[gv,g2,hQ,hD],ax=ja(aq,au,"readwrite");if(ax.error){return ay(ax.error)}var az=ax.txn,aw=az.objectStore(gv);aw.get(aA).onsuccess=function(aC){var aE=hq(aC.target.result);ga(aE.rev_tree,function(aF,aJ,aG,aK,aH){var aI=aJ+"-"+aG;-1!==av.indexOf(aI)&&(aH.status="missing")}),hN(av,aA,az);var aD=aE.winningRev,aB=aE.deleted;az.objectStore(gv).put(hz(aE,aD,aB))},az.onabort=jB(ay),az.oncomplete=function(){ay()}},ac._getLocal=function(ay,ax){var au=ja(aq,[iG],"readonly");if(au.error){return ax(au.error)}var av=au.txn,aw=av.objectStore(iG).get(ay);aw.onerror=jB(ax),aw.onsuccess=function(aA){var az=aA.target.result;az?(delete az._doc_id_rev,ax(null,az)):ax(hn(g3))}},ac._putLocal=function(aD,ay,aA){"function"==typeof ay&&(aA=ay,ay={}),delete aD._revisions;var av=aD._rev,au=aD._id;av?aD._rev="0-"+(parseInt(av.split("-")[1],10)+1):aD._rev="0-1";var aw,aB=ay.ctx;if(!aB){var ax=ja(aq,[iG],"readwrite");if(ax.error){return aA(ax.error)}aB=ax.txn,aB.onerror=jB(aA),aB.oncomplete=function(){aw&&aA(null,aw)}}var az,aC=aB.objectStore(iG);av?(az=aC.get(au),az.onsuccess=function(aE){var aF=aE.target.result;if(aF&&aF._rev===av){var aG=aC.put(aD);aG.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)}}else{aA(hn(gN))}}):(az=aC.add(aD),az.onerror=function(aE){aA(hn(gN)),aE.preventDefault(),aE.stopPropagation()},az.onsuccess=function(){aw={ok:!0,id:aD._id,rev:aD._rev},ay.ctx&&aA(null,aw)})},ac._removeLocal=function(az,av,aw){"function"==typeof av&&(aw=av,av={});var aB=av.ctx;if(!aB){var aA=ja(aq,[iG],"readwrite");if(aA.error){return aw(aA.error)}aB=aA.txn,aB.oncomplete=function(){aC&&aw(null,aC)}}var aC,ay=az._id,au=aB.objectStore(iG),ax=au.get(ay);ax.onerror=jB(aw),ax.onsuccess=function(aD){var aE=aD.target.result;aE&&aE._rev===az._rev?(au["delete"](ay),aC={ok:!0,id:ay,rev:"0-0"},av.ctx&&aw(null,aC)):aw(hn(g3))}},ac._destroy=function(av,ax){B.removeAllListeners(al);var au=J.get(al);au&&au.result&&(au.result.close(),ft["delete"](al));var aw=indexedDB.deleteDatabase(al);aw.onsuccess=function(){J["delete"](al),gf()&&al in localStorage&&delete localStorage[al],ax(null,{ok:!0})},aw.onerror=jB(ax)};var af=ft.get(al);if(af){return aq=af.idb,ac._meta=af.global,void fp.nextTick(function(){am(null,ac)})}var t;t=ab.storage?ji(al,ab.storage):indexedDB.open(al,h8),J.set(al,t),t.onupgradeneeded=function(ay){function av(){var aA=aw[au-1];au++,aA&&aA(az,av)}var ax=ay.target.result;if(ay.oldVersion<1){return ak(ax)}var az=ay.currentTarget.transaction;ay.oldVersion<3&&ap(ax),ay.oldVersion<4&&ah(ax);var aw=[aj,ad,ag,aa],au=ay.oldVersion;av()},t.onsuccess=function(ax){aq=ax.target.result,aq.onversionchange=function(){aq.close(),ft["delete"](al)},aq.onabort=function(aA){go("error","Database has a global failure",aA.target.error),aq.close(),ft["delete"](al)};var az=aq.transaction([a6,jv,gv],"readwrite"),aw=az.objectStore(a6).get(a6),ay=null,av=null,au=null;aw.onsuccess=function(aB){var aD=function(){null!==ay&&null!==av&&null!==au&&(ac._meta={name:al,instanceId:au,blobSupport:ay,docCount:av},ft.set(al,{idb:aq,global:ac._meta}),am(null,ac))},aA=aB.target.result||{id:a6};al+"_id" in aA?(au=aA[al+"_id"],aD()):(au=iT(),aA[al+"_id"]=au,az.objectStore(a6).put(aA).onsuccess=function(){aD()}),fo||(fo=hL(az)),fo.then(function(aE){ay=aE,aD()});var aC=az.objectStore(gv).index("deletedOrLocal");aC.count(IDBKeyRange.only("0")).onsuccess=function(aE){av=aE.target.result,aD()}}},t.onerror=function(){var au="Failed to open indexedDB, are you in private browsing mode?";go("error",au),am(hn(gx,au))}}function ji(aa,ab){try{return indexedDB.open(aa,{version:h8,storage:ab})}catch(t){return indexedDB.open(aa,h8)}}function iw(t){t.adapter("idb",I,!0)}function iH(t){return decodeURIComponent(escape(t))}function gj(t){return 65>t?t-48:t-55}function jy(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(gj(ac.charCodeAt(aa++))<<4|gj(ac.charCodeAt(aa++)))}return t}function it(ac,aa,ab){for(var t="";ab>aa;){t+=String.fromCharCode(gj(ac.charCodeAt(aa+2))<<12|gj(ac.charCodeAt(aa+3))<<8|gj(ac.charCodeAt(aa))<<4|gj(ac.charCodeAt(aa+1))),aa+=4}return t}function hX(t,aa){return"UTF-8"===aa?iH(jy(t,0,t.length)):it(t,0,t.length)}function jc(t){return"'"+t+"'"}function iI(t){return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function gn(t){return t.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function jf(t){return delete t._id,delete t._rev,JSON.stringify(t)}function hT(aa,ab,t){return aa=JSON.parse(aa),aa._id=ab,aa._rev=t,aa}function gQ(t){for(var aa="(";t--;){aa+="?",t&&(aa+=",")}return aa+")"}function iL(ab,ad,t,ac,aa){return"SELECT "+ab+" FROM "+("string"==typeof ad?ad:ad.join(" JOIN "))+(t?" ON "+t:"")+(ac?" WHERE "+("string"==typeof ac?ac:ac.join(" AND ")):"")+(aa?" ORDER BY "+aa:"")}function jh(aa,ac,ag){function ab(){++ad===aa.length&&t()}function t(){if(af.length){var ah="SELECT DISTINCT digest AS digest FROM "+i0+" WHERE seq IN "+gQ(af.length);ag.executeSql(ah,af,function(al,ap){for(var aj=[],am=0;am<ap.rows.length;am++){aj.push(ap.rows.item(am).digest)}if(aj.length){var ak="DELETE FROM "+i0+" WHERE seq IN ("+af.map(function(){return"?"}).join(",")+")";al.executeSql(ak,af,function(aq){var au="SELECT digest FROM "+i0+" WHERE digest IN ("+aj.map(function(){return"?"}).join(",")+")";aq.executeSql(au,aj,function(ax,aw){for(var ay=new iq.Set,av=0;av<aw.rows.length;av++){ay.add(aw.rows.item(av).digest)}aj.forEach(function(az){ay.has(az)||(ax.executeSql("DELETE FROM "+i0+" WHERE digest=?",[az]),ax.executeSql("DELETE FROM "+hp+" WHERE digest=?",[az]))})})})}})}}if(aa.length){var ad=0,af=[];aa.forEach(function(ah){var aj="SELECT seq FROM "+il+" WHERE doc_id=? AND rev=?";ag.executeSql(aj,[ac,ah],function(al,am){if(!am.rows.length){return ab()}var ak=am.rows.item(0).seq;af.push(ak),al.executeSql("DELETE FROM "+il+" WHERE seq=?",[ak],ab)})})}}function iR(t){return function(ad){go("error","WebSQL threw an error",ad);var aa=ad&&ad.constructor.toString().match(/function ([^\(]+)/),ac=aa&&aa[1]||ad.type,ab=ad.target||ad.message;t(hn(iV,ab,ac))}}function hk(t){if("size" in t){return 1000000*t.size}var aa="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return aa?5000000:1}function ig(ad,aw,au,ax,av,aA,t){function az(){return ah?t(ah):(aA.notify(ax._name),ax._docCount=-1,void t(null,am))}function aj(aD,aE){var aC="SELECT count(*) as cnt FROM "+hp+" WHERE digest=?";ap.executeSql(aC,[aD],function(aH,aG){if(0===aG.rows.item(0).cnt){var aF=hn(hG,"unknown stub attachment with digest "+aD);aE(aF)}else{aE()}})}function ag(aE){function aG(){++aD===aC.length&&aE(aF)}var aC=[];if(aq.forEach(function(aH){aH.data&&aH.data._attachments&&Object.keys(aH.data._attachments).forEach(function(aJ){var aI=aH.data._attachments[aJ];aI.stub&&aC.push(aI.digest)})}),!aC.length){return aE()}var aF,aD=0;aC.forEach(function(aH){aj(aH,function(aI){aI&&!aF&&(aF=aI),aG()})})}function af(aL,aD,aI,aN,aP,aG,aQ,aE){function aJ(){function aV(bc,ba){function bb(){return ++bd===bf.length&&ba(),!1}function aZ(bi){var bh="INSERT INTO "+i0+" (digest, seq) VALUES (?,?)",bj=[aW._attachments[bi].digest,bc];ap.executeSql(bh,bj,bb,bb)}var bd=0,bf=Object.keys(aW._attachments||{});if(!bf.length){return ba()}for(var bg=0;bg<bf.length;bg++){aZ(bf[bg])}}var aW=aL.data,aT=aN?1:0,aY=aW._id,aU=aW._rev,aS=jf(aW),aR="INSERT INTO "+il+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",aX=[aY,aU,aS,aT];ap.executeSql(aR,aX,function(bb,aZ){var ba=aZ.insertId;aV(ba,function(){aK(bb,ba)})},function(){var aZ=iL("seq",il,null,"doc_id=? AND rev=?");return ap.executeSql(aZ,[aY,aU],function(bd,bc){var bb=bc.rows.item(0).seq,bf="UPDATE "+il+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",ba=[aS,aT,aY,aU];bd.executeSql(bf,ba,function(bg){aV(bb,function(){aK(bg,bb)})})}),!1})}function aM(aR){aO||(aR?(aO=aR,aE(aO)):aF===aH.length&&aJ())}function aC(aR){aF++,aM(aR)}function aK(aX,aR){var aV=aL.metadata.id,aW=aL.stemmedRevs||[];aP&&ax.auto_compaction&&(aW=iv(aL.metadata).concat(aW)),aW.length&&jh(aW,aV,aX),aL.metadata.seq=aR,delete aL.metadata.rev;var aU=aP?"UPDATE "+hm+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+il+" WHERE doc_id="+hm+".id AND rev=?) WHERE id=?":"INSERT INTO "+hm+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",aT=R(aL.metadata),aS=aP?[aT,aR,aD,aV]:[aV,aR,aR,aT];aX.executeSql(aU,aS,function(){am[aQ]={ok:!0,id:aL.metadata.id,rev:aD},ac.set(aV,aL.metadata),aE()})}var aO=null,aF=0;aL.data._id=aL.metadata.id,aL.data._rev=aL.metadata.rev;var aH=Object.keys(aL.data._attachments||{});aN&&(aL.data._deleted=!0),aH.forEach(function(aS){var aU=aL.data._attachments[aS];if(aU.stub){aF++,aM()}else{var aT=aU.data;delete aU.data,aU.revpos=parseInt(aD,10);var aR=aU.digest;al(aR,aT,aC)}}),aH.length||aJ()}function aa(){jD(ad.revs_limit,aq,ax,ac,ap,am,af,au)}function aB(aD){function aE(){++aC===aq.length&&aD()}if(!aq.length){return aD()}var aC=0;aq.forEach(function(aG){if(aG._id&&a3(aG._id)){return aE()}var aF=aG.metadata.id;ap.executeSql("SELECT json FROM "+hm+" WHERE id = ?",[aF],function(aI,aJ){if(aJ.rows.length){var aH=bn(aJ.rows.item(0).json);ac.set(aF,aH)}aE()})})}function al(aD,aF,aC){var aE="SELECT digest FROM "+hp+" WHERE digest=?";ap.executeSql(aE,[aD],function(aH,aG){return aG.rows.length?aC():(aE="INSERT INTO "+hp+" (digest, body, escaped) VALUES (?,?,1)",void aH.executeSql(aE,[aD,iI(aF)],function(){aC()},function(){return aC(),!1}))})}var ab=au.new_edits,ak=aw.docs,aq=ak.map(function(aC){if(aC._id&&a3(aC._id)){return aC}var aD=g5(aC,ab);return aD}),ay=aq.filter(function(aC){return aC.error});if(ay.length){return t(ay[0])}var ap,ah,am=new Array(aq.length),ac=new iq.Map;gy(aq,"binary",function(aC){return aC?t(aC):void av.transaction(function(aD){ap=aD,ag(function(aE){aE?ah=aE:aB(aa)})},iR(t),az)})}function gr(t){return t.websql(t.name,t.version,t.description,t.size)}function i9(t){try{return{db:gr(t)}}catch(aa){return{error:aa}}}function hV(t){var aa=hJ.get(t.name);return aa||(aa=i9(t),hJ.set(t.name,aa),aa.db&&(aa.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),aa}function id(ah,af,aa,ab,aj){function ag(){++t===ac.length&&aj&&aj()}function ad(am,ak){var al=am._attachments[ak],ap={binary:af.binary,ctx:ab};aa._getAttachment(am._id,ak,al,ap,function(au,aq){am._attachments[ak]=iF.extend(fc(al,["digest","content_type"]),{data:aq}),ag()})}var ac=Object.keys(ah._attachments||{});if(!ac.length){return aj&&aj()}var t=0;ac.forEach(function(ak){af.attachments&&af.include_docs?ad(ah,ak):(ah._attachments[ak].stub=!0,ag())})}function iW(ad,au){function ab(){gf()&&(window.localStorage["_pouch__websqldb_"+ah._name]=!0),au(null,ah)}function aC(aD,aE){aD.executeSql(f),aD.executeSql("ALTER TABLE "+il+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){aD.executeSql(ie),aD.executeSql("ALTER TABLE "+hm+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){aD.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+hm+" (local, id)");var aF="SELECT "+hm+".winningseq AS seq, "+hm+".json AS metadata FROM "+il+" JOIN "+hm+" ON "+il+".seq = "+hm+".winningseq";aD.executeSql(aF,[],function(aH,aL){for(var aI=[],aN=[],aM=0;aM<aL.rows.length;aM++){var aK=aL.rows.item(aM),aJ=aK.seq,aG=JSON.parse(aK.metadata);gO(aG)&&aI.push(aJ),a3(aG.id)&&aN.push(aG.id)}aH.executeSql("UPDATE "+hm+"SET local = 1 WHERE id IN "+gQ(aN.length),aN,function(){aH.executeSql("UPDATE "+il+" SET deleted = 1 WHERE seq IN "+gQ(aI.length),aI,aE)})})})})}function aq(aE,aF){var aD="CREATE TABLE IF NOT EXISTS "+gq+" (id UNIQUE, rev, json)";aE.executeSql(aD,[],function(){var aG="SELECT "+hm+".id AS id, "+il+".json AS data FROM "+il+" JOIN "+hm+" ON "+il+".seq = "+hm+".winningseq WHERE local = 1";aE.executeSql(aG,[],function(aJ,aH){function aK(){if(!aI.length){return aF(aJ)}var aM=aI.shift(),aN=JSON.parse(aM.data)._rev;aJ.executeSql("INSERT INTO "+gq+" (id, rev, json) VALUES (?,?,?)",[aM.id,aN,aM.data],function(aO){aO.executeSql("DELETE FROM "+hm+" WHERE id=?",[aM.id],function(aP){aP.executeSql("DELETE FROM "+il+" WHERE seq=?",[aM.seq],function(){aK()})})})}for(var aI=[],aL=0;aL<aH.rows.length;aL++){aI.push(aH.rows.item(aL))}aK()})})}function ay(aE,aG){function aD(aH){function aI(){if(!aH.length){return aG(aE)}var aJ=aH.shift(),aL=hX(aJ.hex,av),aO=aL.lastIndexOf("::"),aK=aL.substring(0,aO),aM=aL.substring(aO+2),aN="UPDATE "+il+" SET doc_id=?, rev=? WHERE doc_id_rev=?";aE.executeSql(aN,[aK,aM,aL],function(){aI()})}aI()}var aF="ALTER TABLE "+il+" ADD COLUMN doc_id";aE.executeSql(aF,[],function(aH){var aI="ALTER TABLE "+il+" ADD COLUMN rev";aH.executeSql(aI,[],function(aJ){aJ.executeSql(o,[],function(aK){var aL="SELECT hex(doc_id_rev) as hex FROM "+il;aK.executeSql(aL,[],function(aN,aP){for(var aO=[],aM=0;aM<aP.rows.length;aM++){aO.push(aP.rows.item(aM))}aD(aO)})})})})}function ac(aE,aG){function aD(aI){var aH="SELECT COUNT(*) AS cnt FROM "+hp;aI.executeSql(aH,[],function(aK,aO){function aL(){var aP=iL(ic+", "+hm+".id AS id",[hm,il],jx,null,hm+".id ");aP+=" LIMIT "+aN+" OFFSET "+aM,aM+=aN,aK.executeSql(aP,[],function(ba,aT){function aY(bc,bd){var bf=aQ[bc]=aQ[bc]||[];-1===bf.indexOf(bd)&&bf.push(bd)}if(!aT.rows.length){return aG(ba)}for(var aQ={},aW=0;aW<aT.rows.length;aW++){for(var aU=aT.rows.item(aW),aV=hT(aU.data,aU.id,aU.rev),aZ=Object.keys(aV._attachments||{}),aX=0;aX<aZ.length;aX++){var aS=aV._attachments[aZ[aX]];aY(aS.digest,aU.seq)}}var bb=[];if(Object.keys(aQ).forEach(function(bc){var bd=aQ[bc];bd.forEach(function(bf){bb.push([bc,bf])})}),!bb.length){return aL()}var aR=0;bb.forEach(function(bd){var bc="INSERT INTO "+i0+" (digest, seq) VALUES (?,?)";ba.executeSql(bc,bd,function(){++aR===bb.length&&aL()})})})}var aJ=aO.rows.item(0).cnt;if(!aJ){return aG(aK)}var aM=0,aN=10;aL()})}var aF="CREATE TABLE IF NOT EXISTS "+i0+" (digest, seq INTEGER)";aE.executeSql(aF,[],function(aH){aH.executeSql(h6,[],function(aI){aI.executeSql(jj,[],aD)})})}function aa(aE,aF){var aD="ALTER TABLE "+hp+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";aE.executeSql(aD,[],aF)}function ak(aE,aF){var aD="ALTER TABLE "+hm+" ADD COLUMN max_seq INTEGER";aE.executeSql(aD,[],function(aG){var aH="UPDATE "+hm+" SET max_seq=(SELECT MAX(seq) FROM "+il+" WHERE doc_id=id)";aG.executeSql(aH,[],function(aJ){var aI="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+hm+" (max_seq)";aJ.executeSql(aI,[],aF)})})}function aj(aD,aE){aD.executeSql('SELECT HEX("a") AS hex',[],function(aF,aH){var aG=aH.rows.item(0).hex;av=2===aG.length?"UTF-8":"UTF-16",aE()})}function ag(){for(;t.length>0;){var aD=t.pop();aD(null,af)}}function am(aI,aM){if(0===aM){var aD="CREATE TABLE IF NOT EXISTS "+T+" (dbid, db_version INTEGER)",aG="CREATE TABLE IF NOT EXISTS "+hp+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",aJ="CREATE TABLE IF NOT EXISTS "+i0+" (digest, seq INTEGER)",aL="CREATE TABLE IF NOT EXISTS "+hm+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",aK="CREATE TABLE IF NOT EXISTS "+il+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",aE="CREATE TABLE IF NOT EXISTS "+gq+" (id UNIQUE, rev, json)";aI.executeSql(aG),aI.executeSql(aE),aI.executeSql(aJ,[],function(){aI.executeSql(jj),aI.executeSql(h6)}),aI.executeSql(aL,[],function(){aI.executeSql(f),aI.executeSql(aK,[],function(){aI.executeSql(ie),aI.executeSql(o),aI.executeSql(aD,[],function(){var aP="INSERT INTO "+T+" (db_version, dbid) VALUES (?,?)";af=iT();var aQ=[ff,af];aI.executeSql(aP,aQ,function(){ag()})})})})}else{var aO=function(){var aQ=ff>aM;aQ&&aI.executeSql("UPDATE "+T+" SET db_version = "+ff);var aP="SELECT dbid FROM "+T;aI.executeSql(aP,[],function(aR,aS){af=aS.rows.item(0).dbid,ag()})},aF=[aC,aq,ay,ac,aa,ak,aO],aH=aM,aN=function(aP){aF[aH-1](aP,aN),aH++};aN(aI)}}function az(){aA.transaction(function(aD){aj(aD,function(){ap(aD)})},iR(au),ab)}function ap(aD){var aE="SELECT sql FROM sqlite_master WHERE tbl_name = "+T;aD.executeSql(aE,[],function(aF,aG){aG.rows.length?/db_version/.test(aG.rows.item(0).sql)?aF.executeSql("SELECT db_version FROM "+T,[],function(aI,aJ){var aH=aJ.rows.item(0).db_version;am(aI,aH)}):aF.executeSql("ALTER TABLE "+T+" ADD COLUMN db_version INTEGER",[],function(){am(aF,1)}):am(aF,0)})}function aw(aE,aF){if(-1!==ah._docCount){return aF(ah._docCount)}var aD=iL("COUNT("+hm+".id) AS 'num'",[hm,il],jx,il+".deleted=0");aE.executeSql(aD,[],function(aG,aH){ah._docCount=aH.rows.item(0).num,aF(ah._docCount)})}var av,ah=this,af=null,aB=hk(ad),t=[];ah._docCount=-1,ah._name=ad.name;var ax=iF.extend({},ad,{version:K,description:ad.name,size:aB}),al=hV(ax);if(al.error){return iR(au)(al.error)}var aA=al.db;"function"!=typeof aA.readTransaction&&(aA.readTransaction=aA.transaction),az(),ah.type=function(){return"websql"},ah._id=er(function(aD){aD(null,af)}),ah._info=function(aD){aA.readTransaction(function(aE){aw(aE,function(aF){var aG="SELECT MAX(seq) AS seq FROM "+il;aE.executeSql(aG,[],function(aJ,aI){var aH=aI.rows.item(0).seq||0;aD(null,{doc_count:aF,update_seq:aH,sqlite_plugin:aA._sqlitePlugin,websql_encoding:av})})})},iR(aD))},ah._bulkDocs=function(aF,aD,aE){ig(ad,aF,aD,ah,aA,gS,aE)},ah._get=function(aD,aM,aF){function aI(){aF(aK,{doc:aH,metadata:aE,ctx:aG})}var aH,aE,aK,aG=aM.ctx;if(!aG){return aA.readTransaction(function(aN){ah._get(aD,iF.extend({ctx:aN},aM),aF)})}var aJ,aL;aM.rev?(aJ=iL(ic,[hm,il],hm+".id="+il+".doc_id",[il+".doc_id=?",il+".rev=?"]),aL=[aD,aM.rev]):(aJ=iL(ic,[hm,il],jx,hm+".id=?"),aL=[aD]),aG.executeSql(aJ,aL,function(aP,aO){if(!aO.rows.length){return aK=hn(g3,"missing"),aI()}var aN=aO.rows.item(0);return aE=bn(aN.metadata),aN.deleted&&!aM.rev?(aK=hn(g3,"deleted"),aI()):(aH=hT(aN.data,aE.id,aN.rev),void aI())})},ah._allDocs=function(aQ,aG){var aF,aM=[],aK="startkey" in aQ?aQ.startkey:!1,aP="endkey" in aQ?aQ.endkey:!1,aI="key" in aQ?aQ.key:!1,aE="descending" in aQ?aQ.descending:!1,aH="limit" in aQ?aQ.limit:-1,aJ="skip" in aQ?aQ.skip:0,aN=aQ.inclusive_end!==!1,aD=[],aL=[];if(aI!==!1){aL.push(hm+".id = ?"),aD.push(aI)}else{if(aK!==!1||aP!==!1){if(aK!==!1&&(aL.push(hm+".id "+(aE?"<=":">=")+" ?"),aD.push(aK)),aP!==!1){var aO=aE?">":"<";aN&&(aO+="="),aL.push(hm+".id "+aO+" ?"),aD.push(aP)}aI!==!1&&(aL.push(hm+".id = ?"),aD.push(aI))}}"ok"!==aQ.deleted&&aL.push(il+".deleted = 0"),aA.readTransaction(function(aR){aw(aR,function(aS){if(aF=aS,0!==aH){var aT=iL(ic,[hm,il],jx,aL,hm+".id "+(aE?"DESC":"ASC"));aT+=" LIMIT "+aH+" OFFSET "+aJ,aR.executeSql(aT,aD,function(aU,ba){for(var bb=0,aX=ba.rows.length;aX>bb;bb++){var aV=ba.rows.item(bb),bc=bn(aV.metadata),aY=bc.id,aW=hT(aV.data,aY,aV.rev),aZ=aW._rev,bd={id:aY,key:aY,value:{rev:aZ}};if(aQ.include_docs&&(bd.doc=aW,bd.doc._rev=aZ,aQ.conflicts&&(bd.doc._conflicts=jE(bc)),id(bd.doc,aQ,ah,aU)),aV.deleted){if("ok"!==aQ.deleted){continue}bd.value.deleted=!0,bd.doc=null}aM.push(bd)}})}})},iR(aG),function(){aG(null,{total_rows:aF,offset:aQ.skip,rows:aM})})},ah._changes=function(aI){function aH(){var aN=hm+".json AS metadata, "+hm+".max_seq AS maxSeq, "+il+".json AS winningDoc, "+il+".rev AS winningRev ",aM=hm+" JOIN "+il,aO=hm+".id="+il+".doc_id AND "+hm+".winningseq="+il+".seq",aP=["maxSeq > ?"],aR=[aI.since];aI.doc_ids&&(aP.push(hm+".id IN "+gQ(aI.doc_ids.length)),aR=aR.concat(aI.doc_ids));var aL="maxSeq "+(aD?"DESC":"ASC"),aS=iL(aN,aM,aO,aP,aL),aT=iO(aI);aI.view||aI.filter||(aS+=" LIMIT "+aG);var aQ=aI.since||0;aA.readTransaction(function(aU){aU.executeSql(aS,aR,function(bb,ba){function bc(bg){return function(){aI.onChange(bg)}}for(var aW=0,aX=ba.rows.length;aX>aW;aW++){var aY=ba.rows.item(aW),aZ=bn(aY.metadata);aQ=aY.maxSeq;var bf=hT(aY.winningDoc,aZ.id,aY.winningRev),bd=aI.processChange(bf,aZ,aI);bd.seq=aY.maxSeq;var aV=aT(bd);if("object"==typeof aV){return aI.complete(aV)}if(aV&&(aE++,aJ&&aK.push(bd),aI.attachments&&aI.include_docs?id(bf,aI,ah,bb,bc(bd)):bc(bd)()),aE===aG){break}}})},iR(aI.complete),function(){aI.continuous||aI.complete(null,{results:aK,last_seq:aQ})})}if(aI=gl(aI),aI.continuous){var aF=ah._name+":"+iT();return gS.addListener(ah._name,aF,ah,aI),gS.notify(ah._name),{cancel:function(){gS.removeListener(ah._name,aF)}}}var aD=aI.descending;aI.since=aI.since&&!aD?aI.since:0;var aG="limit" in aI?aI.limit:-1;0===aG&&(aG=1);var aJ;aJ="return_docs" in aI?aI.return_docs:"returnDocs" in aI?aI.returnDocs:!0;var aK=[],aE=0;aH()},ah._close=function(aD){aD()},ah._getAttachment=function(aD,aM,aF,aI,aH){var aE,aK=aI.ctx,aG=aF.digest,aJ=aF.content_type,aL="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+hp+" WHERE digest=?";aK.executeSql(aL,[aG],function(aP,aQ){var aO=aQ.rows.item(0),aN=aO.escaped?gn(aO.body):hX(aO.body,av);aE=aI.binary?Y(aN,aJ):h3(aN),aH(null,aE)})},ah._getRevisionTree=function(aD,aE){aA.readTransaction(function(aF){var aG="SELECT json AS metadata FROM "+hm+" WHERE id = ?";aF.executeSql(aG,[aD],function(aI,aH){if(aH.rows.length){var aJ=bn(aH.rows.item(0).metadata);aE(null,aJ.rev_tree)}else{aE(hn(g3))}})})},ah._doCompaction=function(aE,aF,aD){return aF.length?void aA.transaction(function(aH){var aG="SELECT json AS metadata FROM "+hm+" WHERE id = ?";aH.executeSql(aG,[aE],function(aK,aI){var aL=bn(aI.rows.item(0).metadata);ga(aL.rev_tree,function(aQ,aO,aR,aP,aM){var aN=aO+"-"+aR;-1!==aF.indexOf(aN)&&(aM.status="missing")});var aJ="UPDATE "+hm+" SET json = ? WHERE id = ?";aK.executeSql(aJ,[R(aL),aE])}),jh(aF,aE,aH)},iR(aD),function(){aD()}):aD()},ah._getLocal=function(aD,aE){aA.readTransaction(function(aF){var aG="SELECT json, rev FROM "+gq+" WHERE id=?";aF.executeSql(aG,[aD],function(aJ,aH){if(aH.rows.length){var aK=aH.rows.item(0),aI=hT(aK.json,aD,aK.rev);aE(null,aI)}else{aE(hn(g3))}})})},ah._putLocal=function(aJ,aF,aL){function aE(aO){var aM,aN;aK?(aM="UPDATE "+gq+" SET rev=?, json=? WHERE id=? AND rev=?",aN=[aD,aG,aH,aK]):(aM="INSERT INTO "+gq+" (id, rev, json) VALUES (?,?,?)",aN=[aH,aD,aG]),aO.executeSql(aM,aN,function(aP,aQ){aQ.rowsAffected?(aI={ok:!0,id:aH,rev:aD},aF.ctx&&aL(null,aI)):aL(hn(gN))},function(){return aL(hn(gN)),!1})}"function"==typeof aF&&(aL=aF,aF={}),delete aJ._revisions;var aD,aK=aJ._rev,aH=aJ._id;aD=aK?aJ._rev="0-"+(parseInt(aK.split("-")[1],10)+1):aJ._rev="0-1";var aI,aG=jf(aJ);aF.ctx?aE(aF.ctx):aA.transaction(aE,iR(aL),function(){aI&&aL(null,aI)})},ah._removeLocal=function(aE,aG,aH){function aF(aI){var aJ="DELETE FROM "+gq+" WHERE id=? AND rev=?",aK=[aE._id,aE._rev];aI.executeSql(aJ,aK,function(aL,aM){return aM.rowsAffected?(aD={ok:!0,id:aE._id,rev:"0-0"},void (aG.ctx&&aH(null,aD))):aH(hn(g3))})}"function"==typeof aG&&(aH=aG,aG={});var aD;aG.ctx?aF(aG.ctx):aA.transaction(aF,iR(aH),function(){aD&&aH(null,aD)})},ah._destroy=function(aD,aE){gS.removeAllListeners(ah._name),aA.transaction(function(aF){var aG=[hm,il,hp,T,gq,i0];aG.forEach(function(aH){aF.executeSql("DROP TABLE IF EXISTS "+aH,[])})},iR(aE),function(){gf()&&(delete window.localStorage["_pouch__websqldb_"+ah._name],delete window.localStorage[ah._name]),aE(null,{ok:!0})})}}function j(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return !1}}function gV(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent)){return !0}var aa=gf(),ab="_pouch__websqldb_valid_"+navigator.userAgent;if(aa&&localStorage[ab]){return"1"===localStorage[ab]}var t=j();return aa&&(localStorage[ab]=t?"1":"0"),t}function E(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:gV()}function jw(t){return function(ad,aa,ac,ab){if("undefined"!=typeof sqlitePlugin){var af=iF.extend({},t,{name:ad,version:aa,description:ac,size:ab});return sqlitePlugin.openDatabase(af)}return openDatabase(ad,aa,ac,ab)}}function V(ac,aa){var ab=jw(ac),t=iF.extend({websql:ab},ac);iW.call(this,t,aa)}function i6(t){t.adapter("websql",V,!0)}function v(){for(var ac={},aa=new ij(function(af,ad){ac.resolve=af,ac.reject=ad}),ab=new Array(arguments.length),t=0;t<ab.length;t++){ab[t]=arguments[t]}return ac.promise=aa,ij.resolve().then(function(){return fetch.apply(null,ab)}).then(function(ad){ac.resolve(ad)})["catch"](function(ad){ac.reject(ad)}),ac}function gF(aa,ac){var ag,ab,t,ad=new Headers,af={method:aa.method,credentials:"include",headers:ad};return aa.json&&(ad.set("Accept","application/json"),ad.set("Content-Type",aa.headers["Content-Type"]||"application/json")),aa.body&&aa.body instanceof Blob?hH(aa.body,function(ah){af.body=ah}):aa.body&&aa.processData&&"string"!=typeof aa.body?af.body=JSON.stringify(aa.body):"body" in aa?af.body=aa.body:af.body=null,Object.keys(aa.headers).forEach(function(ah){aa.headers.hasOwnProperty(ah)&&ad.set(ah,aa.headers[ah])}),ag=v(aa.url,af),aa.timeout>0&&(ab=setTimeout(function(){ag.reject(new Error("Load timeout for resource: "+aa.url))},aa.timeout)),ag.promise.then(function(ah){return t={statusCode:ah.status},aa.timeout>0&&clearTimeout(ab),t.statusCode>=200&&t.statusCode<300?aa.binary?ah.blob():ah.text():ah.json()}).then(function(ah){t.statusCode>=200&&t.statusCode<300?ac(null,t,ah):ac(ah,t)})["catch"](function(ah){ac(ah,t)}),{abort:ag.reject}}function jo(ah,af){var aa,ab,aj=!1,ag=function(){aa.abort()},ad=function(){aj=!0,aa.abort()};aa=ah.xhr?new ah.xhr:new XMLHttpRequest;try{aa.open(ah.method,ah.url)}catch(ac){af(ac,{statusCode:413})}aa.withCredentials="withCredentials" in ah?ah.withCredentials:!0,"GET"===ah.method?delete ah.headers["Content-Type"]:ah.json&&(ah.headers.Accept="application/json",ah.headers["Content-Type"]=ah.headers["Content-Type"]||"application/json",ah.body&&ah.processData&&"string"!=typeof ah.body&&(ah.body=JSON.stringify(ah.body))),ah.binary&&(aa.responseType="arraybuffer"),"body" in ah||(ah.body=null);for(var t in ah.headers){ah.headers.hasOwnProperty(t)&&aa.setRequestHeader(t,ah.headers[t])}return ah.timeout>0&&(ab=setTimeout(ad,ah.timeout),aa.onprogress=function(){clearTimeout(ab),4!==aa.readyState&&(ab=setTimeout(ad,ah.timeout))},"undefined"!=typeof aa.upload&&(aa.upload.onprogress=aa.onprogress)),aa.onreadystatechange=function(){if(4===aa.readyState){var ak={statusCode:aa.status};if(aa.status>=200&&aa.status<300){var am;am=ah.binary?Z([aa.response||""],{type:aa.getResponseHeader("Content-Type")}):aa.responseText,af(null,ak,am)}else{var ap={};if(aj){ap=new Error("ETIMEDOUT"),ak.statusCode=400}else{try{ap=JSON.parse(aa.response)}catch(al){}}af(ap,ak)}}},ah.body&&ah.body instanceof Blob?hH(ah.body,function(ak){aa.send(ak)}):aa.send(ah.body),{abort:ag}}function l(){try{return new XMLHttpRequest,!0}catch(t){return !1}}function L(t,aa){return hu||t.xhr?jo(t,aa):gF(t,aa)}function hZ(){return""}function fg(ab,ad){function t(aj,af,ah){if(!ab.binary&&ab.json&&"string"==typeof aj){try{aj=JSON.parse(aj)}catch(ag){return ah(ag)}}Array.isArray(aj)&&(aj=aj.map(function(ak){return ak.error||ak.missing?jt(ak):ak})),ab.binary&&jp(aj,af),ah(null,aj,af)}function ac(ak,af){var ah,al;if(ak.code&&ak.status){var aj=new Error(ak.message||ak.code);return aj.status=ak.status,af(aj)}if(ak.message&&"ETIMEDOUT"===ak.message){return af(ak)}try{ah=JSON.parse(ak.responseText),al=jt(ah)}catch(ag){al=jt(ak)}af(al)}ab=gl(ab);var aa={method:"GET",headers:{},json:!0,processData:!0,timeout:10000,cache:!1};return ab=iF.extend(aa,ab),ab.json&&(ab.binary||(ab.headers.Accept="application/json"),ab.headers["Content-Type"]=ab.headers["Content-Type"]||"application/json"),ab.binary&&(ab.encoding=null,ab.json=!1),ab.processData||(ab.json=!1),L(ab,function(ag,ak,am){if(ag){return ag.status=ak?ak.statusCode:400,ac(ag,ad)}var aj,al=ak.headers&&ak.headers["content-type"],af=am||hZ();if(!ab.binary&&(ab.json||!ab.processData)&&"object"!=typeof af&&(/json/.test(al)||/^[\s]*\{/.test(af)&&/\}[\s]*$/.test(af))){try{af=JSON.parse(af.toString())}catch(ah){}}ak.statusCode>=200&&ak.statusCode<300?t(af,ak,ad):(aj=jt(af),aj.status=ak.statusCode,ad(aj))})}function fw(af,ac){var ah=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ak=-1!==ah.indexOf("safari")&&-1===ah.indexOf("chrome"),aj=-1!==ah.indexOf("msie"),ag=-1!==ah.indexOf("edge"),ad=ak||(aj||ag)&&"GET"===af.method,aa="cache" in af?af.cache:!0,t=/^blob:/.test(af.url);if(!t&&(ad||!aa)){var ab=-1!==af.url.indexOf("?");af.url+=(ab?"&":"?")+"_nonce="+Date.now()}return fg(af,ac)}function ey(t){var aa=t.doc&&t.doc._attachments;aa&&Object.keys(aa).forEach(function(ac){var ab=aa[ac];ab.data=h0(ab.data,ab.content_type)})}function ct(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function a0(t){return t._attachments&&Object.keys(t._attachments)?ij.all(Object.keys(t._attachments).map(function(ab){var aa=t._attachments[ab];return aa.data&&"string"!=typeof aa.data?new ij(function(ac){ib(aa.data,ac)}).then(function(ac){aa.data=ac}):void 0})):ij.resolve()}function hd(aa){var ab=y(aa);(ab.user||ab.password)&&(ab.auth={username:ab.user,password:ab.password});var t=ab.path.replace(/(^\/|\/$)/g,"").split("/");return ab.db=t.pop(),-1===ab.db.indexOf("%")&&(ab.db=encodeURIComponent(ab.db)),ab.path=t.join("/"),ab}function gY(t,aa){return gK(t,t.db+"/"+aa)}function gK(aa,ab){var t=aa.path?"/":"";return aa.protocol+"://"+aa.host+(aa.port?":"+aa.port:"")+"/"+aa.path+t+ab}function iN(t){return"?"+Object.keys(t).map(function(aa){return aa+"="+encodeURIComponent(t[aa])}).join("&")}function fq(aj,ac){function ab(ax,aA,az){var ay=ax.ajax||{},aw=iF.extend(gl(ag),ay,aA);return iK(aw.method+" "+aw.url),ap._ajax(aw,az)}function ah(aw,ax){return new ij(function(az,ay){ab(aw,ax,function(aA,aB){return aA?ay(aA):void az(aB)})})}function aq(aw,ax){return gz(aw,je(function(ay){av().then(function(){return ax.apply(this,ay)})["catch"](function(az){var aA=ay.pop();aA(az)})}))}function av(){if(aj.skipSetup||aj.skip_setup){return ij.resolve()}if(au){return au}var aw={method:"GET",url:t};return au=ah({},aw)["catch"](function(ax){return ax&&ax.status&&404===ax.status?(jd(404,"PouchDB is just detecting if the remote exists."),ah({},{method:"PUT",url:t})):ij.reject(ax)})["catch"](function(ax){return ax&&ax.status&&412===ax.status?!0:ij.reject(ax)}),au["catch"](function(){au=null}),au}function aa(aw){return aw.split("/").map(encodeURIComponent).join("/")}var ap=this,ad=hd;aj.getHost&&(ad=aj.getHost);var al=ad(aj.name,aj),t=gY(al,"");aj=gl(aj);var ag=aj.ajax||{};if(ap.getUrl=function(){return t},ap.getHeaders=function(){return ag.headers||{}},aj.auth||al.auth){var af=aj.auth||al.auth,ak=af.username+":"+af.password,am=h3(unescape(encodeURIComponent(ak)));ag.headers=ag.headers||{},ag.headers.Authorization="Basic "+am}ap._ajax=fw;var au;setTimeout(function(){ac(null,ap)}),ap.type=function(){return"http"},ap.id=aq("id",function(aw){ab({},{method:"GET",url:gK(al,"")},function(az,ax){var ay=ax&&ax.uuid?ax.uuid+al.db:gY(al,"");aw(null,ay)})}),ap.request=aq("request",function(aw,ax){aw.url=gY(al,aw.url),ab({},aw,ax)}),ap.compact=aq("compact",function(aw,ax){"function"==typeof aw&&(ax=aw,aw={}),aw=gl(aw),ab(aw,{url:gY(al,"_compact"),method:"POST"},function(){function ay(){ap.info(function(az,aA){aA&&!aA.compact_running?ax(null,{ok:!0}):setTimeout(ay,aw.interval||200)})}ay()})}),ap.bulkGet=gz("bulkGet",function(aC,aA){function ax(aD){var aE={};aC.revs&&(aE.revs=!0),aC.attachments&&(aE.attachments=!0),ab({},{url:gY(al,"_bulk_get"+iN(aE)),method:"POST",body:{docs:aC.docs}},aD)}function aB(){function aF(aK){return function(aM,aL){aJ[aK]=aL.results,++aE===aH&&aA(null,{results:ci(aJ)})}}for(var aI=gZ,aH=Math.ceil(aC.docs.length/aI),aE=0,aJ=new Array(aH),aD=0;aH>aD;aD++){var aG=fc(aC,["revs","attachments"]);aG.ajax=ag,aG.docs=aC.docs.slice(aD*aI,Math.min(aC.docs.length,(aD+1)*aI)),co(ay,aG,aF(aD))}}var ay=this,aw=gK(al,""),az=fl[aw];"boolean"!=typeof az?ax(function(aF,aE){if(aF){var aD=Math.floor(aF.status/100);4===aD||5===aD?(fl[aw]=!1,jd(aF.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),aB()):aA(aF)}else{fl[aw]=!0,aA(null,aE)}}):az?ax(aA):aB()}),ap._info=function(aw){av().then(function(){ab({},{method:"GET",url:gY(al,"")},function(ay,ax){return ay?aw(ay):(ax.host=gY(al,""),void aw(null,ax))})})["catch"](aw)},ap.get=aq("get",function(aA,aC,ax){function aB(aE){var aD=aE._attachments,aF=aD&&Object.keys(aD);return aD&&aF.length?ij.all(aF.map(function(aG){var aI=aD[aG],aH=ct(aE._id)+"/"+aa(aG)+"?rev="+aE._rev;return ah(aC,{method:"GET",url:gY(al,aH),binary:!0}).then(function(aJ){return aC.binary?aJ:new ij(function(aK){ib(aJ,aK)})}).then(function(aJ){delete aI.stub,delete aI.length,aI.data=aJ})})):void 0}function ay(aD){return Array.isArray(aD)?ij.all(aD.map(function(aE){return aE.ok?aB(aE.ok):void 0})):aB(aD)}"function"==typeof aC&&(ax=aC,aC={}),aC=gl(aC);var az={};aC.revs&&(az.revs=!0),aC.revs_info&&(az.revs_info=!0),aC.open_revs&&("all"!==aC.open_revs&&(aC.open_revs=JSON.stringify(aC.open_revs)),az.open_revs=aC.open_revs),aC.rev&&(az.rev=aC.rev),aC.conflicts&&(az.conflicts=aC.conflicts),aA=ct(aA);var aw={method:"GET",url:gY(al,aA+iN(az))};ah(aC,aw).then(function(aD){return ij.resolve().then(function(){return aC.attachments?ay(aD):void 0}).then(function(){ax(null,aD)})})["catch"](ax)}),ap.remove=aq("remove",function(ax,aB,az,aw){var ay;"string"==typeof aB?(ay={_id:ax,_rev:aB},"function"==typeof az&&(aw=az,az={})):(ay=ax,"function"==typeof aB?(aw=aB,az={}):(aw=az,az=aB));var aA=ay._rev||az.rev;ab(az,{method:"DELETE",url:gY(al,ct(ay._id))+"?rev="+aA},aw)}),ap.getAttachment=aq("getAttachment",function(ax,az,aB,ay){"function"==typeof aB&&(ay=aB,aB={});var aA=aB.rev?"?rev="+aB.rev:"",aw=gY(al,ct(ax))+"/"+aa(az)+aA;ab(aB,{method:"GET",url:aw,binary:!0},ay)}),ap.removeAttachment=aq("removeAttachment",function(ax,aA,ay,az){var aw=gY(al,ct(ax)+"/"+aa(aA))+"?rev="+ay;ab({},{method:"DELETE",url:aw},az)}),ap.putAttachment=aq("putAttachment",function(aB,ax,aG,aF,aD,aw){"function"==typeof aD&&(aw=aD,aD=aF,aF=aG,aG=null);var ay=ct(aB)+"/"+aa(ax),az=gY(al,ay);if(aG&&(az+="?rev="+aG),"string"==typeof aF){var aE;try{aE=gT(aF)}catch(aA){return aw(hn(ik,"Attachment is not a valid base64 string"))}aF=aE?Y(aE,aD):""}var aC={headers:{"Content-Type":aD},method:"PUT",url:az,processData:!1,body:aF,timeout:ag.timeout||60000};ab({},aC,aw)}),ap._bulkDocs=function(aw,ay,ax){aw.new_edits=ay.new_edits,av().then(function(){return ij.all(aw.docs.map(a0))}).then(function(){ab(ay,{method:"POST",url:gY(al,"_bulk_docs"),body:aw},function(aA,az){return aA?ax(aA):(az.forEach(function(aB){aB.ok=!0}),void ax(null,az))})})["catch"](ax)},ap.allDocs=aq("allDocs",function(aA,aC){"function"==typeof aA&&(aC=aA,aA={}),aA=gl(aA);var ax,aB={},ay="GET";aA.conflicts&&(aB.conflicts=!0),aA.descending&&(aB.descending=!0),aA.include_docs&&(aB.include_docs=!0),aA.attachments&&(aB.attachments=!0),aA.key&&(aB.key=JSON.stringify(aA.key)),aA.start_key&&(aA.startkey=aA.start_key),aA.startkey&&(aB.startkey=JSON.stringify(aA.startkey)),aA.end_key&&(aA.endkey=aA.end_key),aA.endkey&&(aB.endkey=JSON.stringify(aA.endkey)),"undefined"!=typeof aA.inclusive_end&&(aB.inclusive_end=!!aA.inclusive_end),"undefined"!=typeof aA.limit&&(aB.limit=aA.limit),"undefined"!=typeof aA.skip&&(aB.skip=aA.skip);var aw=iN(aB);if("undefined"!=typeof aA.keys){var az="keys="+encodeURIComponent(JSON.stringify(aA.keys));az.length+aw.length+1<=p?aw+="&"+az:(ay="POST",ax={keys:aA.keys})}ah(aA,{method:ay,url:gY(al,"_all_docs"+aw),body:ax}).then(function(aD){aA.include_docs&&aA.attachments&&aA.binary&&aD.rows.forEach(ey),aC(null,aD)})["catch"](aC)}),ap._changes=function(aH){var az="batch_size" in aH?aH.batch_size:ir;aH=gl(aH),aH.timeout="timeout" in aH?aH.timeout:"timeout" in ag?ag.timeout:30000;var aB,aw=aH.timeout?{timeout:aH.timeout-5000}:{},aF="undefined"!=typeof aH.limit?aH.limit:!1;aB="return_docs" in aH?aH.return_docs:"returnDocs" in aH?aH.returnDocs:!0;var ay=aF;if(aH.style&&(aw.style=aH.style),(aH.include_docs||aH.filter&&"function"==typeof aH.filter)&&(aw.include_docs=!0),aH.attachments&&(aw.attachments=!0),aH.continuous&&(aw.feed="longpoll"),aH.conflicts&&(aw.conflicts=!0),aH.descending&&(aw.descending=!0),"heartbeat" in aH?aH.heartbeat&&(aw.heartbeat=aH.heartbeat):aw.heartbeat=10000,aH.filter&&"string"==typeof aH.filter&&(aw.filter=aH.filter),aH.view&&"string"==typeof aH.view&&(aw.filter="_view",aw.view=aH.view),aH.query_params&&"object"==typeof aH.query_params){for(var aJ in aH.query_params){aH.query_params.hasOwnProperty(aJ)&&(aw[aJ]=aH.query_params[aJ])}}var aD,aI="GET";if(aH.doc_ids){aw.filter="_doc_ids";var aK=JSON.stringify(aH.doc_ids);aK.length<p?aw.doc_ids=aK:(aI="POST",aD={doc_ids:aH.doc_ids})}var ax,aA,aC=function(aM,aN){if(!aH.aborted){aw.since=aM,"object"==typeof aw.since&&(aw.since=JSON.stringify(aw.since)),aH.descending?aF&&(aw.limit=ay):aw.limit=!aF||ay>az?az:ay;var aL={method:aI,url:gY(al,"_changes"+iN(aw)),timeout:aH.timeout,body:aD};aA=aM,aH.aborted||av().then(function(){ax=ab(aH,aL,aN)})["catch"](aN)}},aE={results:[]},aG=function(aN,aL){if(!aH.aborted){var aM=0;if(aL&&aL.results){aM=aL.results.length,aE.last_seq=aL.last_seq;var aP={};aP.query=aH.query_params,aL.results=aL.results.filter(function(aR){ay--;var aQ=iO(aH)(aR);return aQ&&(aH.include_docs&&aH.attachments&&aH.binary&&ey(aR),aB&&aE.results.push(aR),aH.onChange(aR)),aQ})}else{if(aN){return aH.aborted=!0,void aH.complete(aN)}}aL&&aL.last_seq&&(aA=aL.last_seq);var aO=aF&&0>=ay||aL&&az>aM||aH.descending;(!aH.continuous||aF&&0>=ay)&&aO?aH.complete(null,aE):setTimeout(function(){aC(aA,aG)},0)}};return aC(aH.since||0,aG),{cancel:function(){aH.aborted=!0,ax&&ax.abort()}}},ap.revsDiff=aq("revsDiff",function(aw,ay,ax){"function"==typeof ay&&(ax=ay,ay={}),ab(ay,{method:"POST",url:gY(al,"_revs_diff"),body:aw},ax)}),ap._close=function(aw){aw()},ap._destroy=function(aw,ax){ab(aw,{url:gY(al,""),method:"DELETE"},function(az,ay){return az&&az.status&&404!==az.status?ax(az):void ax(null,ay)})}}function an(t){t.adapter("http",fq,!1),t.adapter("https",fq,!1)}function ae(){this.promise=new ij(function(t){t()})}function ip(ad){var ab=ad.db,aa=ad.viewName,t=ad.map,ac=ad.reduce,ag=ad.temporary,ah=t.toString()+(ac&&ac.toString())+"undefined";if(!ag&&ab._cachedViews){var af=ab._cachedViews[ah];if(af){return ij.resolve(af)}}return ab.info().then(function(ak){function al(am){am.views=am.views||{};var aq=aa;-1===aq.indexOf("/")&&(aq=aa+"/"+aa);var ap=am.views[aq]=am.views[aq]||{};if(!ap[aj]){return ap[aj]=!0,am}}var aj=ak.db_name+"-mrview-"+(ag?"temp":a9(ah));return gh(ab,"_local/mrviews",al).then(function(){return ab.registerDependentDatabase(aj).then(function(ap){var am=ap.db;am.auto_compaction=!0;var aq={name:aj,db:am,sourceDB:ab,adapter:ab.adapter,mapFun:t,reduceFun:ac};return aq.db.get("_local/lastSeq")["catch"](function(au){if(404!==au.status){throw au}}).then(function(au){return aq.seq=au?au.seq:0,ag||(ab._cachedViews=ab._cachedViews||{},ab._cachedViews[ah]=aq,aq.db.once("destroyed",function(){delete ab._cachedViews[ah]})),aq})})})})}function g7(ab,ad,t,ac,aa,af){return hK("return ("+ab.replace(/;\s*$/,"")+");",{emit:ad,sum:t,log:ac,isArray:aa,toJSON:af})}function fe(t){return -1===t.indexOf("/")?[t,t]:t.split("/")}function P(t){return 1===t.length&&/^1-/.test(t[0].rev)}function n(aa,ab){try{aa.emit("error",ab)}catch(t){go("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),go("error",ab)}}function hr(ac,aa,ab){try{return{output:aa.apply(null,ab)}}catch(t){return n(ac,t),{error:t}}}function h(aa,ab){var t=hc.collate(aa.key,ab.key);return 0!==t?t:hc.collate(aa.value,ab.value)}function iE(aa,ab,t){return t=t||0,"number"==typeof ab?aa.slice(t,ab+t):t>0?aa.slice(t):aa}function ha(aa){var ab=aa.value,t=ab&&"object"==typeof ab&&ab._id||aa.id;return t}function gJ(t){t.rows.forEach(function(aa){var ab=aa.doc&&aa.doc._attachments;ab&&Object.keys(ab).forEach(function(ad){var ac=ab[ad];ab[ad].data=h0(ac.data,ac.content_type)})})}function W(t){return function(aa){return t.include_docs&&t.attachments&&t.binary&&gJ(aa),aa}}function M(t){var aa="builtin "+t+" function requires map values to be numbers or number arrays";return new G(aa)}function ao(ad){for(var ab=0,aa=0,t=ad.length;t>aa;aa++){var ac=ad[aa];if("number"!=typeof ac){if(!Array.isArray(ac)){throw M("_sum")}ab="number"==typeof ab?[ab]:ab;for(var ag=0,ah=ac.length;ah>ag;ag++){var af=ac[ag];if("number"!=typeof af){throw M("_sum")}"undefined"==typeof ab[ag]?ab.push(af):ab[ag]+=af}}else{"number"==typeof ab?ab+=ac:ab[0]+=ac}}return ab}function F(ab,ad,t,ac){var aa=ad[ab];"undefined"!=typeof aa&&(ac&&(aa=encodeURIComponent(JSON.stringify(aa))),t.push(ab+"="+aa))}function k(t){if("undefined"!=typeof t){var aa=Number(t);return isNaN(aa)||aa!==parseInt(t,10)?t:aa}}function a5(t){return t.group_level=k(t.group_level),t.limit=k(t.limit),t.skip=k(t.skip),t}function g8(t){if(t){if("number"!=typeof t){return new a1('Invalid value for integer: "'+t+'"')}if(0>t){return new a1('Invalid value for positive integer: "'+t+'"')}}}function br(ac,aa){var ab=ac.descending?"endkey":"startkey",t=ac.descending?"startkey":"endkey";if("undefined"!=typeof ac[ab]&&"undefined"!=typeof ac[t]&&hc.collate(ac[ab],ac[t])>0){throw new a1("No rows can match your key range, reverse your start_key and end_key or set {descending : true}")}if(aa.reduce&&ac.reduce!==!1){if(ac.include_docs){throw new a1("{include_docs:true} is invalid for reduce")}if(ac.keys&&ac.keys.length>1&&!ac.group&&!ac.group_level){throw new a1("Multi-key fetches for reduce views must use {group: true}")}}["group_level","limit","skip"].forEach(function(af){var ad=g8(ac[af]);if(ad){throw ad}})}function s(ah,af,aa){var ab,aj=[],ag="GET";if(F("reduce",aa,aj),F("include_docs",aa,aj),F("attachments",aa,aj),F("limit",aa,aj),F("descending",aa,aj),F("group",aa,aj),F("group_level",aa,aj),F("skip",aa,aj),F("stale",aa,aj),F("conflicts",aa,aj),F("startkey",aa,aj,!0),F("start_key",aa,aj,!0),F("endkey",aa,aj,!0),F("end_key",aa,aj,!0),F("inclusive_end",aa,aj),F("key",aa,aj,!0),aj=aj.join("&"),aj=""===aj?"":"?"+aj,"undefined"!=typeof aa.keys){var ad=2000,ac="keys="+encodeURIComponent(JSON.stringify(aa.keys));ac.length+aj.length+1<=ad?aj+=("?"===aj[0]?"&":"?")+ac:(ag="POST","string"==typeof af?ab={keys:aa.keys}:af.keys=aa.keys)}if("string"==typeof af){var t=fe(af);return ah.request({method:ag,url:"_design/"+t[0]+"/_view/"+t[1]+aj,body:ab}).then(W(aa))}return ab=ab||{},Object.keys(af).forEach(function(ak){Array.isArray(af[ak])?ab[ak]=af[ak]:ab[ak]=af[ak].toString()}),ah.request({method:"POST",url:"_temp_view"+aj,body:ab}).then(W(aa))}function ai(aa,ab,t){return new ij(function(ad,ac){aa._query(ab,t,function(af,ag){return af?ac(af):void ad(ag)})})}function es(t){return new ij(function(ab,aa){t._viewCleanup(function(ac,ad){return ac?aa(ac):void ab(ad)})})}function fr(t){return function(aa){if(404===aa.status){return t}throw aa}}function fb(al,ag,aa){function ad(){return P(t)?ij.resolve(ah):ag.db.get(ak)["catch"](fr(ah))}function af(am){return am.keys.length?ag.db.allDocs({keys:am.keys,include_docs:!0}):ij.resolve({rows:[]})}function ac(am,ay){for(var au=[],aw={},av=0,aq=ay.rows.length;aq>av;av++){var aA=ay.rows[av],ax=aA.doc;if(ax&&(au.push(ax),aw[ax._id]=!0,ax._deleted=!ab[ax._id],!ax._deleted)){var az=ab[ax._id];"value" in az&&(ax.value=az.value)}}var ap=Object.keys(ab);return ap.forEach(function(aD){if(!aw[aD]){var aB={_id:aD},aC=ab[aD];"value" in aC&&(aB.value=aC.value),au.push(aB)}}),am.keys=hP(ap.concat(am.keys)),au.push(am),au}var ak="_local/doc_"+al,ah={_id:ak,keys:[]},aj=aa[al],ab=aj.indexableKeysToKeyValues,t=aj.changes;return ad().then(function(am){return af(am).then(function(ap){return ac(am,ap)})})}function i7(ac,aa,ab){var t="_local/lastSeq";return ac.db.get(t)["catch"](fr({_id:t,seq:0})).then(function(af){var ad=Object.keys(aa);return ij.all(ad.map(function(ag){return fb(ag,ac,aa)})).then(function(ag){var ah=ci(ag);return af.seq=ab,ah.push(af),ac.db.bulkDocs({docs:ah})})})}function A(aa){var ab="string"==typeof aa?aa:aa.name,t=jz[ab];return t||(t=jz[ab]=new ae),t}function Q(t){return hh(A(t),function(){return u(t)})()}function u(ah){function af(am,ak){var al={id:aj._id,key:hc.normalizeKey(am)};"undefined"!=typeof ak&&null!==ak&&(al.value=hc.normalizeKey(ak)),ab.push(al)}function aa(ak,al){return function(){return i7(ah,ak,al)}}var ab,aj,ag;if("function"==typeof ah.mapFun&&2===ah.mapFun.length){var ad=ah.mapFun;ag=function(ak){return ad(ak,af)}}else{ag=g7(ah.mapFun.toString(),af,ao,iY,Array.isArray,JSON.parse)}var ac=ah.seq||0,t=new ae;return new ij(function(ap,ak){function al(){t.finish().then(function(){ah.seq=ac,ap()})}function am(){function aq(au){ak(au)}ah.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:ac,limit:h9}).on("complete",function(aA){var aF=aA.results;if(!aF.length){return al()}for(var aC={},av=0,ax=aF.length;ax>av;av++){var aD=aF[av];if("_"!==aD.doc._id[0]){ab=[],aj=aD.doc,aj._deleted||hr(ah.sourceDB,ag,[aj]),ab.sort(h);for(var au,ay={},aE=0,az=ab.length;az>aE;aE++){var aw=ab[aE],aG=[aw.key,aw.id];0===hc.collate(aw.key,au)&&aG.push(aE);var aB=hc.toIndexableString(aG);ay[aB]=aw,au=aw.key}aC[aD.doc._id]={indexableKeysToKeyValues:ay,changes:aD.changes}}ac=aD.seq}return t.add(aa(aC,ac)),aF.length<h9?al():am()}).on("error",aq)}am()})}function iQ(al,ag,aa){0===aa.group_level&&delete aa.group_level;var ad,af=aa.group||aa.group_level;ad=dr[al.reduceFun]?dr[al.reduceFun]:g7(al.reduceFun.toString(),null,ao,iY,Array.isArray,JSON.parse);var ac=[],ak=isNaN(aa.group_level)?Number.POSITIVE_INFINITY:aa.group_level;ag.forEach(function(aq){var am=ac[ac.length-1],ap=af?aq.key:null;return af&&Array.isArray(ap)&&(ap=ap.slice(0,ak)),am&&0===hc.collate(am.groupKey,ap)?(am.keys.push([aq.key,aq.id]),void am.values.push(aq.value)):void ac.push({keys:[[aq.key,aq.id]],values:[aq.value],groupKey:ap})}),ag=[];for(var ah=0,aj=ac.length;aj>ah;ah++){var ab=ac[ah],t=hr(al.sourceDB,ad,[ab.keys,ab.values,!1]);if(t.error&&t.error instanceof G){throw t.error}ag.push({value:t.error?null:t.output,key:ab.groupKey})}return{rows:iE(ag,aa.limit,aa.skip)}}function gG(t,aa){return hh(A(t),function(){return iZ(t,aa)})()}function iZ(t,aj){function af(aq){return aq.include_docs=!0,t.db.allDocs(aq).then(function(au){return ag=au.total_rows,au.rows.map(function(av){if("value" in av.doc&&"object"==typeof av.doc.value&&null!==av.doc.value){var ax=Object.keys(av.doc.value).sort(),ay=["id","key","value"];if(!(ay>ax||ax>ay)){return av.doc.value}}var aw=hc.parseIndexableString(av.doc._id);return{key:aw[0],id:aw[1],value:"value" in av.doc?av.doc.value:null}})})}function ah(av){var aq;if(aq=ac?iQ(t,av,aj):{total_rows:ag,offset:al,rows:av},aj.include_docs){var au=hP(av.map(ha));return t.sourceDB.allDocs({keys:au,include_docs:!0,conflicts:aj.conflicts,attachments:aj.attachments,binary:aj.binary}).then(function(aw){var ax={};return aw.rows.forEach(function(ay){ay.doc&&(ax["$"+ay.id]=ay.doc)}),av.forEach(function(ay){var aA=ha(ay),az=ax["$"+aA];az&&(ay.doc=az)}),aq})}return aq}var ag,ac=t.reduceFun&&aj.reduce!==!1,al=aj.skip||0;if("undefined"==typeof aj.keys||aj.keys.length||(aj.limit=0,delete aj.keys),"undefined"!=typeof aj.keys){var ab=aj.keys,ak=ab.map(function(aq){var au={startkey:hc.toIndexableString([aq]),endkey:hc.toIndexableString([aq,{}])};return af(au)});return ij.all(ak).then(ci).then(ah)}var am={descending:aj.descending};if(aj.start_key&&(aj.startkey=aj.start_key),aj.end_key&&(aj.endkey=aj.end_key),"undefined"!=typeof aj.startkey&&(am.startkey=aj.descending?hc.toIndexableString([aj.startkey,{}]):hc.toIndexableString([aj.startkey])),"undefined"!=typeof aj.endkey){var aa=aj.inclusive_end!==!1;aj.descending&&(aa=!aa),am.endkey=hc.toIndexableString(aa?[aj.endkey,{}]:[aj.endkey])}if("undefined"!=typeof aj.key){var ad=hc.toIndexableString([aj.key]),ap=hc.toIndexableString([aj.key,{}]);am.descending?(am.endkey=ad,am.startkey=ap):(am.startkey=ad,am.endkey=ap)}return ac||("number"==typeof aj.limit&&(am.limit=aj.limit),am.skip=al),af(am).then(ah)}function X(t){return t.request({method:"POST",url:"_view_cleanup"})}function ho(t){return t.get("_local/mrviews").then(function(ac){var aa={};Object.keys(ac.views).forEach(function(ag){var ad=fe(ag),ah="_design/"+ad[0],af=ad[1];aa[ah]=aa[ah]||{},aa[ah][af]=!0});var ab={keys:Object.keys(aa),include_docs:!0};return t.allDocs(ab).then(function(ag){var af={};ag.rows.forEach(function(aj){var ak=aj.key.substring(8);Object.keys(aa[aj.key]).forEach(function(al){var ap=ak+"/"+al;ac.views[ap]||(ap=al);var aq=Object.keys(ac.views[ap]),am=aj.doc&&aj.doc.views&&aj.doc.views[al];aq.forEach(function(au){af[au]=af[au]||am})})});var ah=Object.keys(af).filter(function(aj){return !af[aj]}),ad=ah.map(function(aj){return hh(A(aj),function(){return new t.constructor(aj,t.__opts).destroy()})()});return ij.all(ad).then(function(){return{ok:!0}})})},fr({ok:!0}))}function de(ac,af,ad){if("http"===ac.type()){return s(ac,af,ad)}if("function"==typeof ac._query){return ai(ac,af,ad)}if("string"!=typeof af){br(ad,af);var aa={db:ac,viewName:"temp_view/temp_view",map:af.map,reduce:af.reduce,temporary:!0};return C.add(function(){return ip(aa).then(function(ak){function aj(){return ak.db.destroy()}return jr(Q(ak).then(function(){return gG(ak,ad)}),aj)})}),C.finish()}var ab=af,ah=fe(ab),t=ah[0],ag=ah[1];return ac.get("_design/"+t).then(function(al){var ak=al.views&&al.views[ag];if(!ak||"string"!=typeof ak.map){throw new iA("ddoc "+t+" has no view named "+ag)}br(ad,ak);var aj={db:ac,viewName:ab,map:ak.map,reduce:ak.reduce};return ip(aj).then(function(am){return"ok"===ad.stale||"update_after"===ad.stale?("update_after"===ad.stale&&fp.nextTick(function(){Q(am)}),gG(am,ad)):Q(am).then(function(){return gG(am,ad)})})})}function a1(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,a1)}catch(aa){}}function iA(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,iA)}catch(aa){}}function G(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,G)}catch(aa){}}function gw(t){return/^1-/.test(t)}function N(aa,ab,t){return !aa._attachments||!aa._attachments[t]||aa._attachments[t].digest!==ab._attachments[t].digest}function gb(aa,ab){var t=Object.keys(ab._attachments);return ij.all(t.map(function(ac){return aa.getAttachment(ab._id,ac,{rev:ab._rev})}))}function cr(ab,ad,t){var ac="http"===ad.type()&&"http"!==ab.type(),aa=Object.keys(t._attachments);return ac?ab.get(t._id).then(function(af){return ij.all(aa.map(function(ag){return N(af,t,ag)?ad.getAttachment(t._id,ag):ab.getAttachment(af._id,ag)}))})["catch"](function(af){if(404!==af.status){throw af}return gb(ad,t)}):gb(ad,t)}function gc(t){var aa=[];return Object.keys(t).forEach(function(ab){var ac=t[ab].missing;ac.forEach(function(ad){aa.push({id:ab,rev:ad})})}),{docs:aa,revs:!0}}function gR(aa,ah,ac,af){function ad(){var am=gc(ac);if(am.docs.length){return aa.bulkGet(am).then(function(ap){if(af.cancelled){throw new Error("cancelled")}return ij.all(ap.results.map(function(aq){return ij.all(aq.docs.map(function(au){var av=au.ok;return au.error&&(t=!1),av&&av._attachments?cr(ah,aa,av).then(function(aw){var ax=Object.keys(av._attachments);return aw.forEach(function(az,aA){var ay=av._attachments[ax[aA]];delete ay.stub,delete ay.length,ay.data=az}),av}):av}))})).then(function(aq){ab=ab.concat(ci(aq).filter(Boolean))})})}}function al(am){return am._attachments&&Object.keys(am._attachments).length>0}function ak(am){return aa.allDocs({keys:am,include_docs:!0}).then(function(ap){if(af.cancelled){throw new Error("cancelled")}ap.rows.forEach(function(aq){!aq.deleted&&aq.doc&&gw(aq.value.rev)&&!al(aq.doc)&&(ab.push(aq.doc),delete ac[aq.id])})})}function ag(){var am=Object.keys(ac).filter(function(aq){var ap=ac[aq].missing;return 1===ap.length&&gw(ap[0])});return am.length>0?ak(am):void 0}function aj(){return{ok:t,docs:ab}}ac=gl(ac);var ab=[],t=!0;return ij.resolve().then(ag).then(ad).then(aj)}function i(ab,ad,t,ac,aa){return ab.get(ad)["catch"](function(af){if(404===af.status){return"http"===ab.type()&&jd(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ac,_id:ad,history:[],replicator:gU,version:ce}}throw af}).then(function(af){return aa.cancelled?void 0:(af.history=(af.history||[]).filter(function(ag){return ag.session_id!==ac}),af.history.unshift({last_seq:t,session_id:ac}),af.history=af.history.slice(0,hj),af.version=ce,af.replicator=gU,af.session_id=ac,af.last_seq=t,ab.put(af)["catch"](function(ag){if(409===ag.status){return i(ab,ad,t,ac,aa)}throw ag}))})}function gD(ac,aa,ab,t){this.src=ac,this.target=aa,this.id=ab,this.returnValue=t}function gp(t,aa){return t.session_id===aa.session_id?{last_seq:t.last_seq,history:t.history}:x(t.history,aa.history)}function x(ad,ab){var aa=ad[0],t=ad.slice(1),ac=ab[0],ag=ab.slice(1);if(!aa||0===ab.length){return{last_seq:hb,history:[]}}var ah=aa.session_id;if(fY(ah,ab)){return{last_seq:aa.last_seq,history:ad}}var af=ac.session_id;return fY(af,t)?{last_seq:ac.last_seq,history:ag}:x(t,ag)}function fY(ac,aa){var ab=aa[0],t=aa.slice(1);return ac&&0!==aa.length?ac===ab.session_id?!0:fY(ac,t):!1}function gP(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function fj(ac,aa,ab,t){return ac.retry===!1?(aa.emit("error",ab),void aa.removeAllListeners()):("function"!=typeof ac.back_off_function&&(ac.back_off_function=iC),aa.emit("requestError",ab),"active"!==aa.state&&"pending"!==aa.state||(aa.emit("paused",ab),aa.state="stopped",aa.once("active",function(){ac.current_back_off=hC})),ac.current_back_off=ac.current_back_off||hC,ac.current_back_off=ac.back_off_function(ac.current_back_off),void setTimeout(t,ac.current_back_off))}function gm(t){return Object.keys(t).sort(hc.collate).reduce(function(ab,aa){return ab[aa]=t[aa],ab},{})}function h4(aa,ac,ag){var ab=ag.doc_ids?ag.doc_ids.sort(hc.collate):"",t=ag.filter?ag.filter.toString():"",ad="",af="";return ag.filter&&ag.query_params&&(ad=JSON.stringify(gm(ag.query_params))),ag.filter&&"_view"===ag.filter&&(af=ag.view.toString()),ij.all([aa.id(),ac.id()]).then(function(aj){var ah=aj[0]+aj[1]+t+af+ad+ab;return new ij(function(ak){i3(ah,ak)})}).then(function(ah){return ah=ah.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+ah})}function hI(aR,aI,aw,aB,ax){function al(){return ad?ij.resolve():h4(aR,aI,aw).then(function(aS){aK=aS,ad=new gD(aR,aI,aK,aB)})}function aC(){if(aE=[],0!==ab.docs.length){var aS=ab.docs;return aI.bulkDocs({docs:aS,new_edits:!1}).then(function(aV){if(aB.cancelled){throw ay(),new Error("cancelled")}var aT=[],aW={};aV.forEach(function(aY){aY.error&&(ax.doc_write_failures++,aT.push(aY),aW[aY.id]=aY)}),aa=aa.concat(aT),ax.docs_written+=ab.docs.length-aT.length;var aX=aT.filter(function(aY){return"unauthorized"!==aY.name&&"forbidden"!==aY.name});if(aS.forEach(function(aZ){var aY=aW[aZ._id];aY?aB.emit("denied",gl(aY)):aE.push(aZ)}),aX.length>0){var aU=new Error("bulkDocs error");throw aU.other_errors=aT,ak("target.bulkDocs failed to write docs",aU),new Error("bulkWrite partial failure")}},function(aT){throw ax.doc_write_failures+=aS.length,aT})}}function aH(){if(ab.error){throw new Error("There was a problem getting docs.")}ax.last_seq=am=ab.seq;var aS=gl(ax);return aE.length&&(aS.docs=aE,aB.emit("change",aS)),ah=!0,ad.writeCheckpoint(ab.seq,aQ).then(function(){if(ah=!1,aB.cancelled){throw ay(),new Error("cancelled")}ab=void 0,au()})["catch"](aJ)}function aO(){var aS={};return ab.changes.forEach(function(aT){"_user/"!==aT.id&&(aS[aT.id]=aT.changes.map(function(aU){return aU.rev}))}),aI.revsDiff(aS).then(function(aT){if(aB.cancelled){throw ay(),new Error("cancelled")}ab.diffs=aT})}function af(){return gR(aR,aI,ab.diffs,aB).then(function(aS){ab.error=!aS.ok,aS.docs.forEach(function(aT){delete ab.diffs[aT._id],ax.docs_read++,ab.docs.push(aT)})})}function aq(){if(!aB.cancelled&&!ab){if(0===ap.length){return void aM(!0)}ab=ap.shift(),aO().then(af).then(aC).then(aH).then(aq)["catch"](function(aS){ak("batch processing terminated with error",aS)})}}function aM(aS){return 0===az.changes.length?void (0!==ap.length||ab||((aF&&av.live||aD)&&(aB.state="pending",aB.emit("paused")),aD&&ay())):void ((aS||aD||az.changes.length>=aN)&&(ap.push(az),az={seq:0,changes:[],docs:[]},"pending"!==aB.state&&"stopped"!==aB.state||(aB.state="active",aB.emit("active")),aq()))}function ak(aS,aT){ag||(aT.message||(aT.message=aS),ax.ok=!1,ax.status="aborting",ax.errors.push(aT),aa=aa.concat(aT),ap=[],az={seq:0,changes:[],docs:[]},ay())}function ay(){if(!(ag||aB.cancelled&&(ax.status="cancelled",ah))){ax.status=ax.status||"complete",ax.end_time=new Date,ax.last_seq=am,ag=!0;var aS=aa.filter(function(aU){return"unauthorized"!==aU.name&&"forbidden"!==aU.name});if(aS.length>0){var aT=aa.pop();aa.length>0&&(aT.other_errors=aa),aT.result=ax,fj(aw,aB,aT,function(){hI(aR,aI,aw,aB)})}else{ax.errors=aa,aB.emit("complete",ax),aB.removeAllListeners()}}}function aP(aS){if(aB.cancelled){return ay()}var aT=iO(aw)(aS);aT&&(az.seq=aS.seq,az.changes.push(aS),aM(0===ap.length&&av.live))}function t(aS){if(aG=!1,aB.cancelled){return ay()}if(aS.results.length>0){av.since=aS.last_seq,au(),aM(!0)}else{var aT=function(){aF?(av.live=!0,au()):aD=!0,aM(!0)};ab||0!==aS.results.length?aT():(ah=!0,ad.writeCheckpoint(aS.last_seq,aQ).then(function(){ah=!1,ax.last_seq=am=aS.last_seq,aT()})["catch"](aJ))}}function aA(aS){return aG=!1,aB.cancelled?ay():void ak("changes rejected",aS)}function au(){function aT(){aU.cancel()}function aS(){aB.removeListener("cancel",aT)}if(!aG&&!aD&&ap.length<aL){aG=!0,aB._changes&&(aB.removeListener("cancel",aB._abortChanges),aB._changes.cancel()),aB.once("cancel",aT);var aU=aR.changes(av).on("change",aP);aU.then(aS,aS),aU.then(t)["catch"](aA),aw.retry&&(aB._changes=aU,aB._abortChanges=aT)}}function aj(){al().then(function(){return aB.cancelled?void ay():ad.getCheckpoint().then(function(aS){am=aS,av={since:am,limit:aN,batch_size:aN,style:"all_docs",doc_ids:ac,return_docs:!0},aw.filter&&("string"!=typeof aw.filter?av.include_docs=!0:av.filter=aw.filter),"heartbeat" in aw&&(av.heartbeat=aw.heartbeat),"timeout" in aw&&(av.timeout=aw.timeout),aw.query_params&&(av.query_params=aw.query_params),aw.view&&(av.view=aw.view),au()})})["catch"](function(aS){ak("getCheckpoint rejected with ",aS)})}function aJ(aS){throw ah=!1,ak("writeCheckpoint completed with error",aS),aS}var ab,aK,ad,ap=[],az={seq:0,changes:[],docs:[]},ah=!1,aD=!1,ag=!1,am=0,aF=aw.continuous||aw.live||!1,aN=aw.batch_size||100,aL=aw.batches_limit||10,aG=!1,ac=aw.doc_ids,aa=[],aE=[],aQ=iT();ax=ax||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var av={};return aB.ready(aR,aI),aB.cancelled?void ay():(aB._addedListeners||(aB.once("cancel",ay),"function"==typeof aw.complete&&(aB.once("error",aw.complete),aB.once("complete",function(aS){aw.complete(null,aS)})),aB._addedListeners=!0),void ("undefined"==typeof aw.since?aj():al().then(function(){return ah=!0,ad.writeCheckpoint(aw.since,aQ)}).then(function(){return ah=!1,aB.cancelled?void ay():(am=aw.since,void aj())})["catch"](aJ)))}function hx(){hS.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,aa=new ij(function(ac,ab){t.once("complete",ac),t.once("error",ab)});t.then=function(ac,ab){return aa.then(ac,ab)},t["catch"]=function(ab){return aa["catch"](ab)},t["catch"](function(){})}function h5(aa,ab){var t=ab.PouchConstructor;return"string"==typeof aa?new t(aa,ab):aa}function fs(aa,ac,ag,ab){if("function"==typeof ag&&(ab=ag,ag={}),"undefined"==typeof ag&&(ag={}),ag.doc_ids&&!Array.isArray(ag.doc_ids)){throw hn(fn,"`doc_ids` filter parameter is not a list.")}ag.complete=ab,ag=gl(ag),ag.continuous=ag.continuous||ag.live,ag.retry="retry" in ag?ag.retry:!1,ag.PouchConstructor=ag.PouchConstructor||this;var t=new hx(ag),ad=h5(aa,ag),af=h5(ac,ag);return hI(ad,af,ag,t),t}function ju(ac,aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"undefined"==typeof ab&&(ab={}),ab=gl(ab),ab.PouchConstructor=ab.PouchConstructor||this,ac=h5(ac,ab),aa=h5(aa,ab),new gg(ac,aa,ab,t)}function gg(af,ap,am,ac){function aq(ay){ah.emit("change",{direction:"pull",change:ay})}function aj(ay){ah.emit("change",{direction:"push",change:ay})}function t(ay){ah.emit("denied",{direction:"push",doc:ay})}function al(ay){ah.emit("denied",{direction:"pull",doc:ay})}function av(){ah.pushPaused=!0,ah.pullPaused&&ah.emit("paused")}function ab(){ah.pullPaused=!0,ah.pushPaused&&ah.emit("paused")}function ag(){ah.pushPaused=!1,ah.pullPaused&&ah.emit("active",{direction:"push"})}function ak(){ah.pullPaused=!1,ah.pushPaused&&ah.emit("active",{direction:"pull"})}function ad(ay){return function(aC,aE){var aD="change"===aC&&(aE===aq||aE===aj),aA="denied"===aC&&(aE===al||aE===t),az="paused"===aC&&(aE===ab||aE===av),aB="active"===aC&&(aE===ak||aE===ag);(aD||aA||az||aB)&&(aC in ax||(ax[aC]={}),ax[aC][ay]=!0,2===Object.keys(ax[aC]).length&&ah.removeAllListeners(aC))}}var ah=this;this.canceled=!1;var aa=am.push?iF.extend({},am,am.push):am,aw=am.pull?iF.extend({},am,am.pull):am;this.push=fs(af,ap,aa),this.pull=fs(ap,af,aw),this.pushPaused=!0,this.pullPaused=!0;var ax={};am.live&&(this.push.on("complete",ah.pull.cancel.bind(ah.pull)),this.pull.on("complete",ah.push.cancel.bind(ah.push))),this.on("newListener",function(ay){"change"===ay?(ah.pull.on("change",aq),ah.push.on("change",aj)):"denied"===ay?(ah.pull.on("denied",al),ah.push.on("denied",t)):"active"===ay?(ah.pull.on("active",ak),ah.push.on("active",ag)):"paused"===ay&&(ah.pull.on("paused",ab),ah.push.on("paused",av))}),this.on("removeListener",function(ay){"change"===ay?(ah.pull.removeListener("change",aq),ah.push.removeListener("change",aj)):"denied"===ay?(ah.pull.removeListener("denied",al),ah.push.removeListener("denied",t)):"active"===ay?(ah.pull.removeListener("active",ak),ah.push.removeListener("active",ag)):"paused"===ay&&(ah.pull.removeListener("paused",ab),ah.push.removeListener("paused",av))}),this.pull.on("removeListener",ad("pull")),this.push.on("removeListener",ad("push"));var au=ij.all([this.push,this.pull]).then(function(ay){var az={push:ay[0],pull:ay[1]};return ah.emit("complete",az),ac&&ac(null,az),ah.removeAllListeners(),az},function(ay){if(ah.cancel(),ac?ac(ay):ah.emit("error",ay),ah.removeAllListeners(),ac){throw ay}});this.then=function(ay,az){return au.then(ay,az)},this["catch"]=function(ay){return au["catch"](ay)}}function i5(t){t.replicate=fs,t.sync=ju}var ei,iF=b(9),jC=fy(b(5)),g1=fy(b(8)),he=fy(b(10)),iq=b(14),je=fy(b(4)),hS=b(1),hK=fy(b(15)),hg=fy(b(16)),gi=fy(b(17)),hc=b(12),ij="function"==typeof Promise?Promise:he,ez=Function.prototype.toString,hw=ez.call(Object),h7=jC("pouchdb:api"),jm=6;if(fd()){ei=!1}else{try{localStorage.setItem("_pouch_check_localstorage",1),ei=!!localStorage.getItem("_pouch_check_localstorage")}catch(hy){ei=!1}}g1(gC,hS.EventEmitter),gC.prototype.addListener=function(aa,ac,ag,ab){function t(){function aj(){af=!1}if(ad._listeners[ac]){if(af){return void (af="waiting")}af=!0;var ah=fc(ab,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);ag.changes(ah).on("change",function(ak){ak.seq>ab.since&&!ab.cancelled&&(ab.since=ak.seq,ab.onChange(ak))}).on("complete",function(){"waiting"===af&&setTimeout(function(){t()},0),af=!1}).on("error",aj)}}if(!this._listeners[ac]){var ad=this,af=!1;this._listeners[ac]=t,this.on(aa,t)}},gC.prototype.removeListener=function(t,aa){aa in this._listeners&&hS.EventEmitter.prototype.removeListener.call(this,t,this._listeners[aa])},gC.prototype.notifyLocalWindows=function(t){fd()?chrome.storage.local.set({dbName:t}):gf()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},gC.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},g1(a7,Error),a7.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var i8=new a7({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),hO=new a7({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),g3=new a7({status:404,error:"not_found",reason:"missing"}),gN=new a7({status:409,error:"conflict",reason:"Document update conflict"}),hi=new a7({status:400,error:"invalid_id",reason:"_id field must contain a string"}),fV=new a7({status:412,error:"missing_id",reason:"_id is required for puts"}),at=new a7({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),io=new a7({status:412,error:"precondition_failed",reason:"Database not open"}),q=new a7({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),ik=new a7({status:500,error:"badarg",reason:"Some query argument is invalid"}),hl=new a7({status:400,error:"invalid_request",reason:"Request was invalid"}),gB=new a7({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),m=new a7({status:500,error:"doc_validation",reason:"Bad special document member"}),fn=new a7({status:400,error:"bad_request",reason:"Something wrong with the request"}),gW=new a7({status:400,error:"bad_request",reason:"Document must be a JSON object"}),D=new a7({status:404,error:"not_found",reason:"Database not found"}),gx=new a7({status:500,error:"indexed_db_went_bad",reason:"unknown"}),iV=new a7({status:500,error:"web_sql_went_bad",reason:"unknown"}),hM=new a7({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),ew=new a7({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),fm=new a7({status:400,error:"bad_request",reason:"Invalid rev format"}),i4=new a7({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),hG=new a7({status:412,error:"missing_stub"}),bt=new a7({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),gt=[i8,hO,g3,gN,hi,fV,at,io,q,ik,hl,gB,m,fn,gW,D,iV,hM,ew,fm,i4,hG,gx,bt],gu=function(ac,aa,ab){var t=gt.filter(function(ad){return ad[ac]===aa});return ab&&t.filter(function(ad){return ad.message===ab})[0]||t[0]},iB=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],gL="queryKey",be=/(?:^|&)([^&=]*)=?([^&]*)/g,fz=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,dn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");g1(g6,hS.EventEmitter),g6.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},g6.prototype.doChanges=function(ab){var ad=this,t=ab.complete;if(ab=gl(ab),"live" in ab&&!("continuous" in ab)&&(ab.continuous=ab.live),ab.processChange=eo,"latest"===ab.since&&(ab.since="now"),ab.since||(ab.since=0),"now"===ab.since){return void this.db.info().then(function(af){return ad.isCancelled?void t(null,{status:"cancelled"}):(ab.since=af.update_seq,void ad.doChanges(ab))},t)}if(ab.continuous&&"now"!==ab.since&&this.db.info().then(function(af){ad.startSeq=af.update_seq},function(af){if("idbNull"!==af.id){throw af}}),ab.view&&!ab.filter&&(ab.filter="_view"),ab.filter&&"string"==typeof ab.filter&&("_view"===ab.filter?ab.view=hs(ab.view):ab.filter=hs(ab.filter),"http"!==this.db.type()&&!ab.doc_ids)){return this.filterChanges(ab)}"descending" in ab||(ab.descending=!1),ab.limit=0===ab.limit?1:ab.limit,ab.complete=t;var ac=this.db._changes(ab);if(ac&&"function"==typeof ac.cancel){var aa=ad.cancel;ad.cancel=je(function(af){ac.cancel(),aa.apply(this,af)})}},g6.prototype.filterChanges=function(ab){var ad=this,t=ab.complete;if("_view"===ab.filter){if(!ab.view||"string"!=typeof ab.view){var ac=hn(fn,"`view` filter parameter not found or invalid.");return t(ac)}var aa=fh(ab.view);this.db.get("_design/"+aa[0],function(ag,ah){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(ag){return t(jt(ag))}var aj=ah&&ah.views&&ah.views[aa[1]]&&ah.views[aa[1]].map;return aj?(ab.filter=h1(aj),void ad.doChanges(ab)):t(hn(g3,ah.views?"missing json key: "+aa[1]:"missing json key: views"))})}else{var af=fh(ab.filter);if(!af){return ad.doChanges(ab)}this.db.get("_design/"+af[0],function(aj,ah){if(ad.isCancelled){return t(null,{status:"cancelled"})}if(aj){return t(jt(aj))}var ag=ah&&ah.filters&&ah.filters[af[1]];return ag?(ab.filter=hR(ag),void ad.doChanges(ab)):t(hn(g3,ah&&ah.filters?"missing json key: "+af[1]:"missing json key: filters"))})}},g1(iS,hS.EventEmitter),iS.prototype.post=gz("post",function(aa,ab,t){return"function"==typeof ab&&(t=ab,ab={}),"object"!=typeof aa||Array.isArray(aa)?t(hn(gW)):void this.bulkDocs({docs:[aa]},ab,im(t))}),iS.prototype.put=gz("put",je(function(ah){function af(){ad||(go("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),ad=!0)}var aa,ab,aj,ag,ad=!1,ac=ah.shift(),t="_id" in ac;if("object"!=typeof ac||Array.isArray(ac)){return(ag=ah.pop())(hn(gW))}for(;;){if(aa=ah.shift(),ab=typeof aa,"string"!==ab||t?"string"!==ab||!t||"_rev" in ac?"object"===ab?aj=aa:"function"===ab&&(ag=aa):(af(),ac._rev=aa):(af(),ac._id=aa,t=!0),!ah.length){break}}return aj=aj||{},gX(ac._id),a3(ac._id)&&"function"==typeof this._putLocal?ac._deleted?this._removeLocal(ac,ag):this._putLocal(ac,ag):void this.bulkDocs({docs:[ac]},aj,im(ag))})),iS.prototype.putAttachment=gz("putAttachment",function(aa,ac,ag,ab,t){function ad(ah){var aj="_rev" in ah?parseInt(ah._rev,10):0;return ah._attachments=ah._attachments||{},ah._attachments[ac]={content_type:t,data:ab,revpos:++aj},af.put(ah)}var af=this;return"function"==typeof t&&(t=ab,ab=ag,ag=null),"undefined"==typeof t&&(t=ab,ab=ag,ag=null),af.get(aa).then(function(ah){if(ah._rev!==ag){throw hn(gN)}return ad(ah)},function(ah){if(ah.reason===g3.message){return ad({_id:aa})}throw ah})}),iS.prototype.removeAttachment=gz("removeAttachment",function(ab,ad,t,ac){var aa=this;aa.get(ab,function(af,ag){return af?void ac(af):ag._rev!==t?void ac(hn(gN)):ag._attachments?(delete ag._attachments[ad],0===Object.keys(ag._attachments).length&&delete ag._attachments,void aa.put(ag,ac)):ac()})}),iS.prototype.remove=gz("remove",function(ab,ad,t,ac){var aa;"string"==typeof ad?(aa={_id:ab,_rev:ad},"function"==typeof t&&(ac=t,t={})):(aa=ab,"function"==typeof ad?(ac=ad,t={}):(ac=t,t=ad)),t=t||{},t.was_delete=!0;var af={_id:aa._id,_rev:aa._rev||t.rev};return af._deleted=!0,a3(af._id)&&"function"==typeof this._removeLocal?this._removeLocal(aa,ac):void this.bulkDocs({docs:[af]},t,im(ac))}),iS.prototype.revsDiff=gz("revsDiff",function(ad,ab,aa){function t(ak,aj){af.has(ak)||af.set(ak,{missing:[]}),af.get(ak).missing.push(aj)}function ac(aj,ak){var al=ad[aj].slice(0);ga(ak,function(am,ap,aq,aw,av){var ax=ap+"-"+aq,au=al.indexOf(ax);-1!==au&&(al.splice(au,1),"available"!==av.status&&t(aj,ax))}),al.forEach(function(am){t(aj,am)})}"function"==typeof ab&&(aa=ab,ab={});var ag=Object.keys(ad);if(!ag.length){return aa(null,{})}var ah=0,af=new iq.Map;ag.map(function(aj){this._getRevisionTree(aj,function(al,am){if(al&&404===al.status&&"missing"===al.message){af.set(aj,{missing:ad[aj]})}else{if(al){return aa(al)}ac(aj,am)}if(++ah===ag.length){var ak={};return af.forEach(function(ap,aq){ak[aq]=ap}),aa(null,ak)}})},this)}),iS.prototype.bulkGet=gz("bulkGet",function(t,aa){co(this,t,aa)}),iS.prototype.compactDocument=gz("compactDocument",function(ac,aa,ab){var t=this;this._getRevisionTree(ac,function(ah,ad){if(ah){return ab(ah)}var ag=iz(ad),aj=[],af=[];Object.keys(ag).forEach(function(ak){ag[ak]>aa&&aj.push(ak)}),ga(ad,function(am,aq,ak,ap,al){var au=aq+"-"+ak;"available"===al.status&&-1!==aj.indexOf(au)&&af.push(au)}),t._doCompaction(ac,af,ab)})}),iS.prototype.compact=gz("compact",function(aa,ab){"function"==typeof aa&&(ab=aa,aa={});var t=this;aa=aa||{},t._compactionQueue=t._compactionQueue||[],t._compactionQueue.push({opts:aa,callback:ab}),1===t._compactionQueue.length&&ar(t)}),iS.prototype._compact=function(aa,ac){function ag(ah){af.push(t.compactDocument(ah.id,0))}function ab(ah){var aj=ah.last_seq;ij.all(af).then(function(){return gh(t,"_local/compaction",function(ak){return !ak.last_seq||ak.last_seq<aj?(ak.last_seq=aj,ak):!1})}).then(function(){ac(null,{ok:!0})})["catch"](ac)}var t=this,ad={return_docs:!1,last_seq:aa.last_seq||0},af=[];t.changes(ad).on("change",ag).on("complete",ab).on("error",ac)},iS.prototype.get=gz("get",function(ad,ab,aa){function t(){var ak=[],aj=ac.length;return aj?void ac.forEach(function(al){ag.get(ad,{rev:al,revs:ab.revs,attachments:ab.attachments},function(am,ap){am?ak.push({missing:al}):ak.push({ok:ap}),aj--,aj||aa(null,ak)})}):aa(null,ak)}if("function"==typeof ab&&(aa=ab,ab={}),"string"!=typeof ad){return aa(hn(hi))}if(a3(ad)&&"function"==typeof this._getLocal){return this._getLocal(ad,aa)}var ac=[],ag=this;if(!ab.open_revs){return this._get(ad,ab,function(aq,ap){if(aq){return aa(aq)}var aw=ap.doc,am=ap.metadata,aB=ap.ctx;if(ab.conflicts){var az=jE(am);az.length&&(aw._conflicts=az)}if(gO(am,aw._rev)&&(aw._deleted=!0),ab.revs||ab.revs_info){var aj=w(am.rev_tree),au=gA(aj,function(aC){return -1!==aC.ids.map(function(aD){return aD.id}).indexOf(aw._rev.split("-")[1])}),ax=au.ids.map(function(aC){return aC.id}).indexOf(aw._rev.split("-")[1])+1,al=au.ids.length-ax;if(au.ids.splice(ax,al),au.ids.reverse(),ab.revs&&(aw._revisions={start:au.pos+au.ids.length-1,ids:au.ids.map(function(aC){return aC.id})}),ab.revs_info){var aA=au.pos+au.ids.length;aw._revs_info=au.ids.map(function(aC){return aA--,{rev:aA+"-"+aC.id,status:aC.opts.status}})}}if(ab.attachments&&aw._attachments){var ak=aw._attachments,ay=Object.keys(ak).length;if(0===ay){return aa(null,aw)}Object.keys(ak).forEach(function(aC){this._getAttachment(aw._id,aC,ak[aC],{rev:aw._rev,binary:ab.binary,ctx:aB},function(aE,aD){var aF=aw._attachments[aC];aF.data=aD,delete aF.stub,delete aF.length,--ay||aa(null,aw)})},ag)}else{if(aw._attachments){for(var av in aw._attachments){aw._attachments.hasOwnProperty(av)&&(aw._attachments[av].stub=!0)}}aa(null,aw)}})}if("all"===ab.open_revs){this._getRevisionTree(ad,function(ak,aj){return ak?aa(ak):(ac=ev(aj).map(function(al){return al.rev}),void t())})}else{if(!Array.isArray(ab.open_revs)){return aa(hn(q,"function_clause"))}ac=ab.open_revs;for(var ah=0;ah<ac.length;ah++){var af=ac[ah];if("string"!=typeof af||!/^\d+-/.test(af)){return aa(hn(fm))}}t()}}),iS.prototype.getAttachment=gz("getAttachment",function(ab,ad,t,ac){var aa=this;t instanceof Function&&(ac=t,t={}),this._get(ab,t,function(af,ag){return af?ac(af):ag.doc._attachments&&ag.doc._attachments[ad]?(t.ctx=ag.ctx,t.binary=!0,aa._getAttachment(ab,ad,ag.doc._attachments[ad],t,ac),void 0):ac(hn(g3))})}),iS.prototype.allDocs=gz("allDocs",function(aa,ab){if("function"==typeof aa&&(ab=aa,aa={}),aa.skip="undefined"!=typeof aa.skip?aa.skip:0,aa.start_key&&(aa.startkey=aa.start_key),aa.end_key&&(aa.endkey=aa.end_key),"keys" in aa){if(!Array.isArray(aa.keys)){return ab(new TypeError("options.keys must be an array"))}var t=["startkey","endkey","key"].filter(function(ac){return ac in aa})[0];if(t){return void ab(hn(gB,"Query parameter `"+t+"` is not compatible with multi-get"))}if("http"!==this.type()){return g(this,aa,ab)}}return this._allDocs(aa,ab)}),iS.prototype.changes=function(t,aa){return"function"==typeof t&&(aa=t,t={}),new g6(this,t,aa)},iS.prototype.close=gz("close",function(t){return this._closed=!0,this._close(t)}),iS.prototype.info=gz("info",function(t){var aa=this;this._info(function(ab,ac){return ab?t(ab):(ac.db_name=ac.db_name||aa._db_name,ac.auto_compaction=!(!aa.auto_compaction||"http"===aa.type()),ac.adapter=aa.type(),void t(null,ac))})}),iS.prototype.id=gz("id",function(t){return this._id(t)}),iS.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},iS.prototype.bulkDocs=gz("bulkDocs",function(ab,ad,t){if("function"==typeof ad&&(t=ad,ad={}),ad=ad||{},Array.isArray(ab)&&(ab={docs:ab}),!ab||!ab.docs||!Array.isArray(ab.docs)){return t(hn(hO))}for(var ac=0;ac<ab.docs.length;++ac){if("object"!=typeof ab.docs[ac]||Array.isArray(ab.docs[ac])){return t(hn(gW))}}var aa;return ab.docs.forEach(function(af){af._attachments&&Object.keys(af._attachments).forEach(function(ag){aa=aa||iu(ag)})}),aa?t(hn(fn,aa)):("new_edits" in ad||("new_edits" in ab?ad.new_edits=ab.new_edits:ad.new_edits=!0),ad.new_edits||"http"===this.type()||ab.docs.sort(fT),r(ab.docs),this._bulkDocs(ab,ad,function(af,ag){return af?t(af):(ad.new_edits||(ag=ag.filter(function(ah){return ah.error})),void t(null,ag))}))}),iS.prototype.registerDependentDatabase=gz("registerDependentDatabase",function(ac,aa){function ab(ad){return ad.dependentDbs=ad.dependentDbs||{},ad.dependentDbs[ac]?!1:(ad.dependentDbs[ac]=!0,ad)}var t=new this.constructor(ac,this.__opts);gh(this,"_local/_pouch_dependentDbs",ab).then(function(){aa(null,{db:t})})["catch"](aa)}),iS.prototype.destroy=gz("destroy",function(ab,ad){function t(){ac._destroy(ab,function(ag,af){return ag?ad(ag):(ac._destroyed=!0,ac.emit("destroyed"),void ad(null,af||{ok:!0}))})}"function"==typeof ab&&(ad=ab,ab={});var ac=this,aa="use_prefix" in ac?ac.use_prefix:!0;return"http"===ac.type()?t():void ac.get("_local/_pouch_dependentDbs",function(ah,ak){if(ah){return 404!==ah.status?ad(ah):t()}var ag=ak.dependentDbs,aj=ac.constructor,af=Object.keys(ag).map(function(al){var am=aa?al.replace(new RegExp("^"+aj.prefix),""):al;return new aj(am,ac.__opts).destroy()});ij.all(af).then(t,ad)})}),ih.prototype.execute=function(){var t;if(this.failed){for(;t=this.queue.shift();){t(this.failed)}}else{for(;t=this.queue.shift();){t()}}},ih.prototype.fail=function(t){this.failed=t,this.execute()},ih.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ih.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},g1(fa,iS),fa.debug=jC,fa.adapters={},fa.preferredAdapters=[],fa.prefix="_pouch_";var fX=new hS.EventEmitter;iy(fa),fa.parseAdapter=function(ad,ab){var aa,t,ac=ad.match(/([a-z\-]*):\/\/(.*)/);if(ac){if(ad=/http(s?)/.test(ac[1])?ac[1]+"://"+ac[2]:ac[2],aa=ac[1],!fa.adapters[aa].valid()){throw"Invalid adapter"}return{name:ad,adapter:ac[1]}}var ag="idb" in fa.adapters&&"websql" in fa.adapters&&gf()&&localStorage["_pouch__websqldb_"+fa.prefix+ad];if(ab.adapter){t=ab.adapter}else{if("undefined"!=typeof ab&&ab.db){t="leveldb"}else{for(var ah=0;ah<fa.preferredAdapters.length;++ah){if(t=fa.preferredAdapters[ah],t in fa.adapters){if(ag&&"idb"===t){go("log",'PouchDB is downgrading "'+ad+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}}}}aa=fa.adapters[t];var af=aa&&"use_prefix" in aa?aa.use_prefix:!0;return{name:af?fa.prefix+ad:ad,adapter:t}},fa.adapter=function(aa,ab,t){ab.valid()&&(fa.adapters[aa]=ab,t&&fa.preferredAdapters.push(aa))},fa.plugin=function(t){return"function"==typeof t?t(fa):Object.keys(t).forEach(function(aa){fa.prototype[aa]=t[aa]}),fa},fa.defaults=function(t){function aa(ab,ad,ac){return this instanceof aa?("function"!=typeof ad&&"undefined"!=typeof ad||(ac=ad,ad={}),ab&&"object"==typeof ab&&(ad=ab,ab=void 0),ad=iF.extend({},t,ad),void fa.call(this,ab,ad,ac)):new aa(ab,ad,ac)}return g1(aa,fa),aa.preferredAdapters=fa.preferredAdapters.slice(),Object.keys(fa).forEach(function(ab){ab in aa||(aa[ab]=fa[ab])}),aa};var et="5.4.4";fa.version=et;var fo,iX=hA(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hY=hA(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),gT=function(t){return atob(t)},h3=function(t){return btoa(t)},ht=gM.setImmediate||gM.setTimeout,iU=32768,h8=5,gv="document-store",g2="by-sequence",hQ="attach-store",hD="attach-seq-store",a6="meta-store",iG="local-store",jv="detect-blob-support",a2={running:!1,queue:[]},ft=new iq.Map,B=new gC,J=new iq.Map;I.valid=function(){var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return !t&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var ff=7,hm=jc("document-store"),il=jc("by-sequence"),hp=jc("attach-store"),gq=jc("local-store"),T=jc("metadata-store"),i0=jc("attach-seq-store"),hJ=new iq.Map,gS=new gC,K=1,ie="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+il+" (seq, deleted)",o="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+il+" (doc_id, rev)",f="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+hm+" (winningseq)",jj="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+i0+" (seq)",h6="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+i0+" (digest, seq)",jx=il+".seq = "+hm+".winningseq",ic=il+".seq AS seq, "+il+".deleted AS deleted, "+il+".json AS data, "+il+".rev AS rev, "+hm+".json AS metadata";V.valid=E,V.use_prefix=!0;var hu=l(),jp=function(){},ir=25,gZ=50,fl={},p=1800,iK=jC("pouchdb:http");fq.valid=function(){return !0},ae.prototype.add=function(t){return this.promise=this.promise["catch"](function(){}).then(function(){return t()}),this.promise},ae.prototype.finish=function(){return this.promise};var jb=function(t,aa){return aa&&t.then(function(ab){fp.nextTick(function(){aa(null,ab)})},function(ab){fp.nextTick(function(){aa(ab)})}),t},gH=function(t){return je(function(ac){var aa=ac.pop(),ab=t.apply(this,ac);return"function"==typeof aa&&jb(ab,aa),ab})},jr=function(t,aa){return t.then(function(ab){return aa().then(function(){return ab})},function(ab){return aa().then(function(){throw ab})})},hh=function(t,aa){return function(){var ab=arguments,ac=this;return t.add(function(){return aa.apply(ac,ab)})}},hP=function(ab){for(var ad={},t=0,ac=ab.length;ac>t;t++){ad["$"+ab[t]]=!0}var aa=Object.keys(ad),af=new Array(aa.length);for(t=0,ac=aa.length;ac>t;t++){af[t]=aa[t].substring(1)}return af},jz={},C=new ae,h9=50,iY=go.bind(null,"log"),dr={_sum:function(t,aa){return ao(aa)},_count:function(t,aa){return aa.length},_stats:function(aa,ab){function t(ad){for(var ag=0,ah=0,af=ad.length;af>ah;ah++){var ac=ad[ah];ag+=ac*ac}return ag}return{sum:ao(ab),min:Math.min.apply(null,ab),max:Math.max.apply(null,ab),count:ab.length,sumsqr:t(ab)}}},U=gH(function(){var t=this;return"http"===t.type()?X(t):"function"==typeof t._viewCleanup?es(t):ho(t)}),en=function(ab,ad,t){"function"==typeof ad&&(t=ad,ad={}),ad=ad?a5(ad):{},"function"==typeof ab&&(ab={map:ab});var ac=this,aa=ij.resolve().then(function(){return de(ac,ab,ad)});return jb(aa,t),aa};g1(a1,Error),g1(iA,Error),g1(G,Error);var ia={query:en,viewCleanup:U},ce=1,gU="pouchdb",hj=5,hb=0;gD.prototype.writeCheckpoint=function(aa,ab){var t=this;return this.updateTarget(aa,ab).then(function(){return t.updateSource(aa,ab)})},gD.prototype.updateTarget=function(t,aa){return i(this.target,this.id,t,aa,this.returnValue)},gD.prototype.updateSource=function(aa,ab){var t=this;return this.readOnlySource?ij.resolve(!0):i(this.src,this.id,aa,ab,this.returnValue)["catch"](function(ac){if(gP(ac)){return t.readOnlySource=!0,!0}throw ac})};var fk={undefined:function(t,aa){return 0===hc.collate(t.last_seq,aa.last_seq)?aa.last_seq:0},1:function(t,aa){return gp(aa,t).last_seq}};gD.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(aa){return t.readOnlySource?ij.resolve(aa.last_seq):t.src.get(t.id).then(function(ac){if(aa.version!==ac.version){return hb}var ab;return ab=aa.version?aa.version.toString():"undefined",ab in fk?fk[ab](aa,ac):hb},function(ab){if(404===ab.status&&aa.last_seq){return t.src.put({_id:t.id,last_seq:hb}).then(function(){return hb},function(ac){return gP(ac)?(t.readOnlySource=!0,aa.last_seq):hb})}throw ab})})["catch"](function(aa){if(404!==aa.status){throw aa}return hb})};var hC=0;g1(hx,hS.EventEmitter),hx.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},hx.prototype.ready=function(ab,ad){function t(){aa.cancel()}function ac(){ab.removeListener("destroyed",t),ad.removeListener("destroyed",t)}var aa=this;aa._readyCalled||(aa._readyCalled=!0,ab.once("destroyed",t),ad.once("destroyed",t),aa.once("complete",ac))},g1(gg,hS.EventEmitter),gg.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},fa.plugin(iw).plugin(i6).plugin(an).plugin(ia).plugin(i5),e.exports=fa}).call(this,b(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(b,h,a){function e(f){return function(){var l=arguments.length;if(l){for(var g=[],k=-1;++k<l;){g[k]=arguments[k]}return f.call(this,g)}return f.call(this,[])}}h.exports=e},{}],5:[function(n,b,p){function r(){return"WebkitAppearance" in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function q(){var k=arguments,h=this.useColors;if(k[0]=(h?"%c":"")+this.namespace+(h?" %c":" ")+k[0]+(h?"%c ":" ")+"+"+p.humanize(this.diff),!h){return k}var j="color: "+this.color;k=[k[0],j,"color: inherit"].concat(Array.prototype.slice.call(k,1));var g=0,f=0;return k[0].replace(/%[a-z%]/g,function(l){"%%"!==l&&(g++,"%c"===l&&(f=g))}),k.splice(f,0,j),k}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(g){try{null==g?p.storage.removeItem("debug"):p.storage.debug=g}catch(f){}}function a(){var g;try{g=p.storage.debug}catch(f){}return g}function e(){try{return window.localStorage}catch(f){}}p=b.exports=n(6),p.log=o,p.formatArgs=q,p.save=i,p.load=a,p.useColors=r,p.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:e(),p.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],p.formatters.j=function(f){return JSON.stringify(f)},p.enable(a())},{6:6}],6:[function(s,i,a){function e(){return a.colors[t++%a.colors.length]}function b(h){function k(){}function j(){var w=j,q=+new Date,v=q-(r||q);w.diff=v,w.prev=r,w.curr=q,r=q,null==w.useColors&&(w.useColors=a.useColors()),null==w.color&&w.useColors&&(w.color=e());var m=Array.prototype.slice.call(arguments);m[0]=a.coerce(m[0]),"string"!=typeof m[0]&&(m=["%o"].concat(m));var p=0;m[0]=m[0].replace(/%([a-z%])/g,function(y,A){if("%%"===y){return y}p++;var x=a.formatters[A];if("function"==typeof x){var z=m[p];y=x.call(w,z),m.splice(p,1),p--}return y}),"function"==typeof a.formatArgs&&(m=a.formatArgs.apply(w,m));var l=j.log||a.log||console.log.bind(console);l.apply(w,m)}k.enabled=!1,j.enabled=!0;var g=a.enabled(h)?j:k;return g.namespace=h,g}function u(j){a.save(j);for(var h=(j||"").split(/[\s,]+/),k=h.length,g=0;k>g;g++){h[g]&&(j=h[g].replace(/\*/g,".*?"),"-"===j[0]?a.skips.push(new RegExp("^"+j.substr(1)+"$")):a.names.push(new RegExp("^"+j+"$")))}}function o(){a.enable("")}function f(g){var j,h;for(j=0,h=a.skips.length;h>j;j++){if(a.skips[j].test(g)){return !1}}for(j=0,h=a.names.length;h>j;j++){if(a.names[j].test(g)){return !0}}return !1}function n(g){return g instanceof Error?g.stack||g.message:g}a=i.exports=b,a.coerce=n,a.disable=o,a.enable=u,a.enabled=f,a.humanize=s(11),a.names=[],a.skips=[],a.formatters={};var r,t=0},{11:11}],7:[function(b,e,a){(function(o){function x(){r=!0;for(var g,h,j=u.length;j;){for(h=u,u=[],g=-1;++g<j;){h[g]()}j=u.length}r=!1}function f(g){1!==u.push(g)||r||z()}var z,s=o.MutationObserver||o.WebKitMutationObserver;if(s){var n=0,i=new s(x),l=o.document.createTextNode("");i.observe(l,{characterData:!0}),z=function(){l.data=n=++n%2}}else{if(o.setImmediate||"undefined"==typeof o.MessageChannel){z="document" in o&&"onreadystatechange" in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){x(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(x,0)}}else{var y=new o.MessageChannel;y.port1.onmessage=x,z=function(){y.port2.postMessage(0)}}}var r,u=[];e.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(b,e,a){"function"==typeof Object.create?e.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(i,j){i.super_=j;var f=function(){};f.prototype=j.prototype,i.prototype=new f,i.prototype.constructor=i}},{}],9:[function(b,e,a){(function(){var i=Array.prototype.slice,j=Array.prototype.forEach,f=function(h){if("object"!=typeof h){throw h+" is not an object"}var g=i.call(arguments,1);return j.call(g,function(n){if(n){for(var m in n){"object"==typeof n[m]&&h[m]?f.call(h,h[m],n[m]):h[m]=n[m]}}}),h};this.extend=f}).call(this)},{}],10:[function(r,u,l){function t(){}function v(g){if("function"!=typeof g){throw new TypeError("resolver must be a function")}this.state=e,this.queue=[],this.outcome=void 0,g!==t&&y(this,g)}function p(j,k,g){this.promise=j,"function"==typeof k&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),"function"==typeof g&&(this.onRejected=g,this.callRejected=this.otherCallRejected)}function b(j,k,g){o(function(){var w;try{w=k(g)}catch(q){return K.reject(j,q)}w===j?K.reject(j,new TypeError("Cannot resolve promise with itself")):K.resolve(j,w)})}function m(g){var j=g&&g.then;return g&&"object"==typeof g&&"function"==typeof j?function(){j.apply(g,arguments)}:void 0}function y(q,j){function w(A){x||(x=!0,K.reject(q,A))}function g(A){x||(x=!0,K.resolve(q,A))}function k(){j(g,w)}var x=!1,z=n(k);"error"===z.status&&w(z.value)}function n(q,j){var k={};try{k.value=q(j),k.status="success"}catch(g){k.status="error",k.value=g}return k}function s(g){return g instanceof this?g:K.resolve(new this(t),g)}function i(g){var j=new this(t);return K.reject(j,g)}function h(z){function k(E,D){function C(F){q[D]=F,++x!==j||B||(B=!0,K.resolve(w,q))}g.resolve(E).then(C,function(F){B||(B=!0,K.reject(w,F))})}var g=this;if("[object Array]"!==Object.prototype.toString.call(z)){return this.reject(new TypeError("must be an array"))}var j=z.length,B=!1;if(!j){return this.resolve([])}for(var q=new Array(j),x=0,A=-1,w=new this(t);++A<j;){k(z[A],A)}return w}function f(q){function j(A){w.resolve(A).then(function(B){x||(x=!0,K.resolve(g,B))},function(B){x||(x=!0,K.reject(g,B))})}var w=this;if("[object Array]"!==Object.prototype.toString.call(q)){return this.reject(new TypeError("must be an array"))}var k=q.length,x=!1;if(!k){return this.resolve([])}for(var z=-1,g=new this(t);++z<k;){j(q[z])}return g}var o=r(7),K={},L=["REJECTED"],a=["FULFILLED"],e=["PENDING"];u.exports=v,v.prototype["catch"]=function(g){return this.then(null,g)},v.prototype.then=function(g,j){if("function"!=typeof g&&this.state===a||"function"!=typeof j&&this.state===L){return this}var k=new this.constructor(t);if(this.state!==e){var q=this.state===a?g:j;b(k,q,this.outcome)}else{this.queue.push(new p(k,g,j))}return k},p.prototype.callFulfilled=function(g){K.resolve(this.promise,g)},p.prototype.otherCallFulfilled=function(g){b(this.promise,this.onFulfilled,g)},p.prototype.callRejected=function(g){K.reject(this.promise,g)},p.prototype.otherCallRejected=function(g){b(this.promise,this.onRejected,g)},K.resolve=function(g,w){var k=n(m,w);if("error"===k.status){return K.reject(g,k.value)}var j=k.value;if(j){y(g,j)}else{g.state=a,g.outcome=w;for(var q=-1,x=g.queue.length;++q<x;){g.queue[q].callFulfilled(w)}}return g},K.reject=function(q,j){q.state=L,q.outcome=j;for(var k=-1,g=q.queue.length;++k<g;){q.queue[k].callRejected(j)}return q},v.resolve=s,v.reject=i,v.all=h,v.race=f},{7:7}],11:[function(b,s,l){function o(h){if(h=""+h,!(h.length>10000)){var k=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(k){var g=parseFloat(k[1]),j=(k[2]||"ms").toLowerCase();switch(j){case"years":case"year":case"yrs":case"yr":case"y":return g*i;case"days":case"day":case"d":return g*e;case"hours":case"hour":case"hrs":case"hr":case"h":return g*a;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g}}}}function n(g){return g>=e?Math.round(g/e)+"d":g>=a?Math.round(g/a)+"h":g>=t?Math.round(g/t)+"m":g>=r?Math.round(g/r)+"s":g+"ms"}function f(g){return u(g,e,"day")||u(g,a,"hour")||u(g,t,"minute")||u(g,r,"second")||g+" ms"}function u(h,j,g){return j>h?void 0:1.5*j>h?Math.floor(h/j)+" "+g:Math.ceil(h/j)+" "+g+"s"}var r=1000,t=60*r,a=60*t,e=24*a,i=365.25*e;s.exports=function(g,h){return h=h||{},"string"==typeof g?o(g):h["long"]?f(g):n(g)}},{}],12:[function(h,l,D){function s(w){if(null!==w){switch(typeof w){case"boolean":return w?1:0;case"number":return p(w);case"string":return w.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var v=Array.isArray(w),g=v?w:Object.keys(w),m=-1,q=g.length,j="";if(v){for(;++m<q;){j+=D.toIndexableString(g[m])}}else{for(;++m<q;){var k=g[m];j+=D.toIndexableString(k)+D.toIndexableString(w[k])}}return j}}return""}function o(g,w){var k,q=w,m="1"===g[w];if(m){k=0,w++}else{var j="0"===g[w];w++;var y="",v=g.substring(w,w+n),x=parseInt(v,10)+e;for(j&&(x=-x),w+=n;;){var z=g[w];if("\x00"===z){break}y+=z,w++}y=y.split("."),k=1===y.length?parseInt(y,10):parseFloat(y[0]+"."+y[1]),j&&(k-=10),0!==x&&(k=parseFloat(k+"e"+x))}return{num:k,length:w-q}}function r(g,m){var v=g.pop();if(m.length){var j=m[m.length-1];v===j.element&&(m.pop(),j=m[m.length-1]);var q=j.element,w=j.index;if(Array.isArray(q)){q.push(v)}else{if(w===g.length-2){var k=g.pop();q[k]=v}else{g.push(v)}}}}function b(j,m){for(var k=Math.min(j.length,m.length),g=0;k>g;g++){var q=D.collate(j[g],m[g]);if(0!==q){return q}}return j.length===m.length?0:j.length>m.length?1:-1}function t(g,j){return g===j?0:g>j?1:-1}function f(w,v){for(var g=Object.keys(w),m=Object.keys(v),q=Math.min(g.length,m.length),j=0;q>j;j++){var k=D.collate(g[j],m[j]);if(0!==k){return k}if(k=D.collate(w[g[j]],v[m[j]]),0!==k){return k}}return g.length===m.length?0:g.length>m.length?1:-1}function a(j){var k=["boolean","number","string","object"],g=k.indexOf(typeof j);return ~g?null===j?1:Array.isArray(j)?5:3>g?g+2:g+3:Array.isArray(j)?5:void 0}function p(q){if(0===q){return"1"}var j=q.toExponential().split(/e\+?/),w=parseInt(j[1],10),y=0>q,x=y?"0":"2",v=(y?-w:w)-e,m=i.padLeft(v.toString(),"0",n);x+=u+m;var g=Math.abs(parseFloat(j[0]));y&&(g=10-g);var k=g.toFixed(20);return k=k.replace(/\.?0+$/,""),x+=u+k}var e=-324,n=3,u="",i=h(13);D.collate=function(j,m){if(j===m){return 0}j=D.normalizeKey(j),m=D.normalizeKey(m);var k=a(j),g=a(m);if(k-g!==0){return k-g}if(null===j){return 0}switch(typeof j){case"number":return j-m;case"boolean":return j===m?0:m>j?-1:1;case"string":return t(j,m)}return Array.isArray(j)?b(j,m):f(j,m)},D.normalizeKey=function(g){switch(typeof g){case"undefined":return null;case"number":return g===1/0||g===-(1/0)||isNaN(g)?null:g;case"object":var k=g;if(Array.isArray(g)){var j=g.length;g=new Array(j);for(var v=0;j>v;v++){g[v]=D.normalizeKey(k[v])}}else{if(g instanceof Date){return g.toJSON()}if(null!==g){g={};for(var m in k){if(k.hasOwnProperty(m)){var q=k[m];"undefined"!=typeof q&&(g[m]=D.normalizeKey(q))}}}}}return g},D.toIndexableString=function(g){var j="\x00";return g=D.normalizeKey(g),a(g)+u+s(g)+j},D.parseIndexableString=function(g){for(var w=[],m=[],q=0;;){var y=g[q++];if("\x00"!==y){switch(y){case"1":w.push(null);break;case"2":w.push("1"===g[q]),q++;break;case"3":var v=o(g,q);w.push(v.num),q+=v.length;break;case"4":for(var x="";;){var z=g[q];if("\x00"===z){break}x+=z,q++}x=x.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),w.push(x);break;case"5":var j={element:[],index:w.length};w.push(j.element),m.push(j);break;case"6":var k={element:{},index:w.length};w.push(k.element),m.push(k);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+y)}}else{if(1===w.length){return w.pop()}r(w,m)}}}},{13:13}],13:[function(b,h,a){function e(m,f,g){for(var n="",l=g-m.length;n.length<l;){n+=f}return n}a.padLeft=function(k,l,f){var g=e(k,l,f);return g+k},a.padRight=function(k,l,f){var g=e(k,l,f);return k+g},a.stringLexCompare=function(n,r){var f,g=n.length,o=r.length;for(f=0;g>f;f++){if(f===o){return 1}var q=n.charAt(f),i=r.charAt(f);if(q!==i){return i>q?-1:1}}return o>g?-1:0},a.intToDecimalForm=function(g){var l=0>g,f="";do{var k=l?-Math.ceil(g%10):Math.floor(g%10);f=k+f,g=l?Math.ceil(g/10):Math.floor(g/10)}while(g);return l&&"0"!==f&&(f="-"+f),f}},{}],14:[function(e,j,a){function i(){this.store={}}function b(g){if(this.store=new i,g&&Array.isArray(g)){for(var h=0,f=g.length;f>h;h++){this.add(g[h])}}}a.Map=i,a.Set=b,i.prototype.mangle=function(f){if("string"!=typeof f){throw new TypeError("key must be a string but Got "+f)}return"$"+f},i.prototype.unmangle=function(f){return f.substring(1)},i.prototype.get=function(f){var g=this.mangle(f);return g in this.store?this.store[g]:void 0},i.prototype.set=function(g,h){var f=this.mangle(g);return this.store[f]=h,!0},i.prototype.has=function(f){var g=this.mangle(f);return g in this.store},i.prototype["delete"]=function(f){var g=this.mangle(f);return g in this.store?(delete this.store[g],!0):!1},i.prototype.forEach=function(p){for(var h=Object.keys(this.store),o=0,f=h.length;f>o;o++){var g=h[o],n=this.store[g];g=this.unmangle(g),p(n,g)}},b.prototype.add=function(f){return this.store.set(f,!0)},b.prototype.has=function(f){return this.store.has(f)},b.prototype["delete"]=function(f){return this.store["delete"](f)}},{}],15:[function(b,e,a){(function(){var h={}.hasOwnProperty,f=[].slice;e.exports=function(o,p){var q,g,n,r;g=[],r=[];for(q in p){h.call(p,q)&&(n=p[q],"this"!==q&&(g.push(q),r.push(n)))}return Function.apply(null,f.call(g).concat([o])).apply(p["this"],r)}}).call(this)},{}],16:[function(f,a,b){!function(i){if("object"==typeof b){a.exports=i()}else{if("function"==typeof c&&c.amd){c(i)}else{var e;try{e=window}catch(j){e=self}e.SparkMD5=i()}}}(function(n){function O(k,w,z,q,j,x){return w=i(i(w,k),i(q,x)),i(w<<j|w>>>32-j,z)}function r(j,q,k,A,w,z,x){return O(q&k|~q&A,j,q,w,z,x)}function m(j,q,k,A,w,z,x){return O(q&A|k&~A,j,q,w,z,x)}function v(j,q,k,A,w,z,x){return O(q^k^A,j,q,w,z,x)}function P(j,q,k,A,w,z,x){return O(k^(q|~A),j,q,w,z,x)}function g(k,w){var z=k[0],q=k[1],x=k[2],j=k[3];z=r(z,q,x,j,w[0],7,-680876936),j=r(j,z,q,x,w[1],12,-389564586),x=r(x,j,z,q,w[2],17,606105819),q=r(q,x,j,z,w[3],22,-1044525330),z=r(z,q,x,j,w[4],7,-176418897),j=r(j,z,q,x,w[5],12,1200080426),x=r(x,j,z,q,w[6],17,-1473231341),q=r(q,x,j,z,w[7],22,-45705983),z=r(z,q,x,j,w[8],7,1770035416),j=r(j,z,q,x,w[9],12,-1958414417),x=r(x,j,z,q,w[10],17,-42063),q=r(q,x,j,z,w[11],22,-1990404162),z=r(z,q,x,j,w[12],7,1804603682),j=r(j,z,q,x,w[13],12,-40341101),x=r(x,j,z,q,w[14],17,-1502002290),q=r(q,x,j,z,w[15],22,1236535329),z=m(z,q,x,j,w[1],5,-165796510),j=m(j,z,q,x,w[6],9,-1069501632),x=m(x,j,z,q,w[11],14,643717713),q=m(q,x,j,z,w[0],20,-373897302),z=m(z,q,x,j,w[5],5,-701558691),j=m(j,z,q,x,w[10],9,38016083),x=m(x,j,z,q,w[15],14,-660478335),q=m(q,x,j,z,w[4],20,-405537848),z=m(z,q,x,j,w[9],5,568446438),j=m(j,z,q,x,w[14],9,-1019803690),x=m(x,j,z,q,w[3],14,-187363961),q=m(q,x,j,z,w[8],20,1163531501),z=m(z,q,x,j,w[13],5,-1444681467),j=m(j,z,q,x,w[2],9,-51403784),x=m(x,j,z,q,w[7],14,1735328473),q=m(q,x,j,z,w[12],20,-1926607734),z=v(z,q,x,j,w[5],4,-378558),j=v(j,z,q,x,w[8],11,-2022574463),x=v(x,j,z,q,w[11],16,1839030562),q=v(q,x,j,z,w[14],23,-35309556),z=v(z,q,x,j,w[1],4,-1530992060),j=v(j,z,q,x,w[4],11,1272893353),x=v(x,j,z,q,w[7],16,-155497632),q=v(q,x,j,z,w[10],23,-1094730640),z=v(z,q,x,j,w[13],4,681279174),j=v(j,z,q,x,w[0],11,-358537222),x=v(x,j,z,q,w[3],16,-722521979),q=v(q,x,j,z,w[6],23,76029189),z=v(z,q,x,j,w[9],4,-640364487),j=v(j,z,q,x,w[12],11,-421815835),x=v(x,j,z,q,w[15],16,530742520),q=v(q,x,j,z,w[2],23,-995338651),z=P(z,q,x,j,w[0],6,-198630844),j=P(j,z,q,x,w[7],10,1126891415),x=P(x,j,z,q,w[14],15,-1416354905),q=P(q,x,j,z,w[5],21,-57434055),z=P(z,q,x,j,w[12],6,1700485571),j=P(j,z,q,x,w[3],10,-1894986606),x=P(x,j,z,q,w[10],15,-1051523),q=P(q,x,j,z,w[1],21,-2054922799),z=P(z,q,x,j,w[8],6,1873313359),j=P(j,z,q,x,w[15],10,-30611744),x=P(x,j,z,q,w[6],15,-1560198380),q=P(q,x,j,z,w[13],21,1309151649),z=P(z,q,x,j,w[4],6,-145523070),j=P(j,z,q,x,w[11],10,-1120210379),x=P(x,j,z,q,w[2],15,718787259),q=P(q,x,j,z,w[9],21,-343485551),k[0]=i(z,k[0]),k[1]=i(q,k[1]),k[2]=i(x,k[2]),k[3]=i(j,k[3])}function p(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k.charCodeAt(q)+(k.charCodeAt(q+1)<<8)+(k.charCodeAt(q+2)<<16)+(k.charCodeAt(q+3)<<24)}return j}function s(k){var q,j=[];for(q=0;64>q;q+=4){j[q>>2]=k[q]+(k[q+1]<<8)+(k[q+2]<<16)+(k[q+3]<<24)}return j}function Q(C){var x,A,B,w,k,q,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(x=64;z>=x;x+=64){g(j,p(C.substring(x-64,x)))}for(C=C.substring(x-64),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=0;A>x;x+=1){B[x>>2]|=C.charCodeAt(x)<<(x%4<<3)}if(B[x>>2]|=128<<(x%4<<3),x>55){for(g(j,B),x=0;16>x;x+=1){B[x]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),q=parseInt(w[1],16)||0,B[14]=k,B[15]=q,g(j,B),j}function u(C){var q,A,B,w,k,x,z=C.length,j=[1732584193,-271733879,-1732584194,271733878];for(q=64;z>=q;q+=64){g(j,s(C.subarray(q-64,q)))}for(C=z>q-64?C.subarray(q-64):new Uint8Array(0),A=C.length,B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=0;A>q;q+=1){B[q>>2]|=C[q]<<(q%4<<3)}if(B[q>>2]|=128<<(q%4<<3),q>55){for(g(j,B),q=0;16>q;q+=1){B[q]=0}}return w=8*z,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),x=parseInt(w[1],16)||0,B[14]=k,B[15]=x,g(j,B),j}function o(k){var q,j="";for(q=0;4>q;q+=1){j+=h[k>>8*q+4&15]+h[k>>8*q&15]}return j}function l(j){var k;for(k=0;k<j.length;k+=1){j[k]=o(j[k])}return j.join("")}function t(j){return/[\u0080-\uFFFF]/.test(j)&&(j=unescape(encodeURIComponent(j))),j}function R(k,w){var z,q=k.length,j=new ArrayBuffer(q),x=new Uint8Array(j);for(z=0;q>z;z+=1){x[z]=k.charCodeAt(z)}return w?x:j}function S(j){return String.fromCharCode.apply(null,new Uint8Array(j))}function T(k,w,j){var q=new Uint8Array(k.byteLength+w.byteLength);return q.set(new Uint8Array(k)),q.set(new Uint8Array(w),k.byteLength),j?q:q.buffer}function e(k){var w,j=[],q=k.length;for(w=0;q-1>w;w+=2){j.push(parseInt(k.substr(w,2),16))}return String.fromCharCode.apply(String,j)}function y(){this.reset()}var i=function(j,k){return j+k&4294967295},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==l(Q("hello"))&&(i=function(k,w){var j=(65535&k)+(65535&w),q=(k>>16)+(w>>16)+(j>>16);return q<<16|65535&j}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function j(k,q){return k=0|k||0,0>k?Math.max(k+q,0):Math.min(k,q)}ArrayBuffer.prototype.slice=function(B,w){var D,C,k,x,A=this.byteLength,z=j(B,A),q=A;return w!==n&&(q=j(w,A)),z>q?new ArrayBuffer(0):(D=q-z,C=new ArrayBuffer(D),k=new Uint8Array(C),x=new Uint8Array(this,z,D),k.set(x),C)}}(),y.prototype.append=function(j){return this.appendBinary(t(j)),this},y.prototype.appendBinary=function(k){this._buff+=k,this._length+=k.length;var q,j=this._buff.length;for(q=64;j>=q;q+=64){g(this._hash,p(this._buff.substring(q-64,q)))}return this._buff=this._buff.substring(q-64),this},y.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q.charCodeAt(w)<<(w%4<<3)}return this._finish(x,j),z=l(this._hash),k&&(z=e(z)),this.reset(),z},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},y.prototype.setState=function(j){return this._buff=j.buff,this._length=j.length,this._hash=j.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(k,w){var z,q,j,x=w;if(k[x>>2]|=128<<(x%4<<3),x>55){for(g(this._hash,k),x=0;16>x;x+=1){k[x]=0}}z=8*this._length,z=z.toString(16).match(/(.*?)(.{0,8})$/),q=parseInt(z[2],16),j=parseInt(z[1],16)||0,k[14]=q,k[15]=j,g(this._hash,k)},y.hash=function(j,k){return y.hashBinary(t(j),k)},y.hashBinary=function(k,w){var j=Q(k),q=l(j);return w?e(q):q},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(k){var w,j=T(this._buff.buffer,k,!0),q=j.length;for(this._length+=k.byteLength,w=64;q>=w;w+=64){g(this._hash,s(j.subarray(w-64,w)))}return this._buff=q>w-64?new Uint8Array(j.buffer.slice(w-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(k){var w,z,q=this._buff,j=q.length,x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(w=0;j>w;w+=1){x[w>>2]|=q[w]<<(w%4<<3)}return this._finish(x,j),z=l(this._hash),k&&(z=e(z)),this.reset(),z},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var j=y.prototype.getState.call(this);return j.buff=S(j.buff),j},y.ArrayBuffer.prototype.setState=function(j){return j.buff=R(j.buff,!0),y.prototype.setState.call(this,j)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(k,w){var j=u(new Uint8Array(k)),q=l(j);return w?e(q):q},y})},{}],17:[function(b,h,a){function e(n,r,f){var g=f[f.length-1];n===g.element&&(f.pop(),g=f[f.length-1]);var o=g.element,q=g.index;if(Array.isArray(o)){o.push(n)}else{if(q===r.length-2){var i=r.pop();o[i]=n}else{r.push(n)}}}a.stringify=function(s){var E=[];E.push({obj:s});for(var f,i,l,n,g,F,u,C,D,o,t,r="";f=E.pop();){if(i=f.obj,l=f.prefix||"",n=f.val||"",r+=l,n){r+=n}else{if("object"!=typeof i){r+="undefined"==typeof i?null:JSON.stringify(i)}else{if(null===i){r+="null"}else{if(Array.isArray(i)){for(E.push({val:"]"}),g=i.length-1;g>=0;g--){F=0===g?"":",",E.push({obj:i[g],prefix:F})}E.push({val:"["})}else{u=[];for(C in i){i.hasOwnProperty(C)&&u.push(C)}for(E.push({val:"}"}),g=u.length-1;g>=0;g--){D=u[g],o=i[D],t=g>0?",":"",t+=JSON.stringify(D)+":",E.push({obj:o,prefix:t})}E.push({val:"{"})}}}}}return r},a.parse=function(n){for(var u,t,D,A,l,B,g,C,f,o=[],s=[],i=0;;){if(u=n[i++],"}"!==u&&"]"!==u&&"undefined"!=typeof u){switch(u){case" ":case"	":case"\n":case":":case",":break;case"n":i+=3,e(null,o,s);break;case"t":i+=3,e(!0,o,s);break;case"f":i+=4,e(!1,o,s);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(t="",i--;;){if(D=n[i++],!/[\d\.\-e\+]/.test(D)){i--;break}t+=D}e(parseFloat(t),o,s);break;case'"':for(A="",l=void 0,B=0;;){if(g=n[i++],'"'===g&&("\\"!==l||B%2!==1)){break}A+=g,l=g,"\\"===l?B++:B=0}e(JSON.parse('"'+A+'"'),o,s);break;case"[":C={element:[],index:o.length},o.push(C.element),s.push(C);break;case"{":f={element:{},index:o.length},o.push(f.element),s.push(f);break;default:throw new Error("unexpectedly reached end of input: "+u)}}else{if(1===o.length){return o.pop()}e(o.pop(),o,s)}}}},{}]},{},[3])(3)});